!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(e._Highcharts,e._Highcharts.SeriesRegistry):"function"==typeof define&&define.amd?define("highcharts/indicators/volume-by-price",["highcharts/highcharts"],function(e){return t(e,e.SeriesRegistry)}):"object"==typeof exports?exports["highcharts/indicators/volume-by-price"]=t(e._Highcharts,e._Highcharts.SeriesRegistry):e.Highcharts=t(e.Highcharts,e.Highcharts.SeriesRegistry)}("undefined"==typeof window?this:window,(w,P)=>(()=>{"use strict";var o={512:e=>{e.exports=P},944:e=>{e.exports=w}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;t=s[e]={exports:{}};return o[e](t,t.exports,i),t.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var e={},t=(i.d(e,{default:()=>x}),i(944)),t=i.n(t),a=i(512),a=i.n(a),{pointClass:n}=a().seriesTypes["sma"]["prototype"];class r extends n{destroy(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),super.destroy.apply(this,arguments)}}n=r;const l=t()["animObject"];var p=t()["noop"];const{column:{prototype:D},sma:h}=a().seriesTypes,{addEvent:d,arrayMax:S,arrayMin:v,correctFloat:V,defined:f,error:u,extend:c,isArray:m,merge:g}=t(),b=Math.abs;class y extends h{init(o,e){const s=this,i=(delete e.data,super.init.apply(s,arguments),d(this.chart.constructor,"afterLinkSeries",function(){var e,t;s.options&&(t=s.options.params,e=s.linkedParent,t=o.get(t.volumeSeriesID),s.addCustomEvents(e,t)),i()},{order:1}));return s}addCustomEvents(e,t){const o=this,s=()=>{o.chart.redraw(),o.setData([]),o.zoneStarts=[],o.zoneLinesSVG&&(o.zoneLinesSVG=o.zoneLinesSVG.destroy())};return o.dataEventsToUnbind.push(d(e,"remove",function(){s()})),t&&o.dataEventsToUnbind.push(d(t,"remove",function(){s()})),o}animate(e){const o=this,t=o.chart.inverted,s=o.group,i={};!e&&s&&(e=t?o.yAxis.top:o.xAxis.left,t?(s["forceAnimate:translateY"]=!0,i.translateY=e):(s["forceAnimate:translateX"]=!0,i.translateX=e),s.animate(i,c(l(o.options.animation),{step:function(e,t){o.group.attr({scaleX:Math.max(.001,t.pos)})}})))}drawPoints(){var e=this;e.options.volumeDivision.enabled&&(e.posNegVolume(!0,!0),D.drawPoints.apply(e,arguments),e.posNegVolume(!1,!1)),D.drawPoints.apply(e,arguments)}posNegVolume(e,t){var o=this,s=t?["positive","negative"]:["negative","positive"],i=o.options.volumeDivision,a=o.points.length;let n=[],r=[],l=0,p,h,d,u;for(e?(o.posWidths=n,o.negWidths=r):(n=o.posWidths,r=o.negWidths);l<a;l++)(u=o.points[l])[s[0]+"Graphic"]=u.graphic,u.graphic=u[s[1]+"Graphic"],e&&(p=u.shapeArgs.width,(d=(h=o.priceZones[l]).wholeVolumeData)?(n.push(p/d*h.positiveVolumeData),r.push(p/d*h.negativeVolumeData)):(n.push(0),r.push(0))),u.color=t?i.styles.positiveColor:i.styles.negativeColor,u.shapeArgs.width=(t?o.posWidths:o.negWidths)[l],u.shapeArgs.x=t?u.shapeArgs.x:o.posWidths[l]}translate(){const o=this,e=o.options,t=o.chart,s=o.yAxis,i=s.min,a=o.options.zoneLines,n=o.priceZones;let r=0,l,p,h,d,u,c,m,g,v,f,y;D.translate.apply(o);const x=o.points;x.length&&(g=e.pointPadding<.5?e.pointPadding:.1,l=o.volumeDataArray,p=S(l),h=t.plotWidth/2,v=t.plotTop,d=b(s.toPixels(i)-s.toPixels(i+o.rangeStep)),c=b(s.toPixels(i)-s.toPixels(i+o.rangeStep)),g&&(u=b(d*(1-2*g)),r=b((d-u)/2),d=b(u)),x.forEach(function(e,t){f=e.barX=e.plotX=0,y=e.plotY=s.toPixels(n[t].start)-v-(s.reversed?d-c:d)-r,m=V(h*n[t].wholeVolumeData/p),e.pointWidth=m,e.shapeArgs=o.crispCol.apply(o,[0,y,m,d]),e.volumeNeg=n[t].negativeVolumeData,e.volumePos=n[t].positiveVolumeData,e.volumeAll=n[t].wholeVolumeData}),a.enabled&&o.drawZones(t,s,o.zoneStarts,a.styles))}getExtremes(){var e=this.options.compare,t=this.options.cumulative;let o;return this.options.compare?(this.options.compare=void 0,o=super.getExtremes(),this.options.compare=e):this.options.cumulative?(this.options.cumulative=!1,o=super.getExtremes(),this.options.cumulative=t):o=super.getExtremes(),o}getValues(e,t){const o=e.getColumn("x",!0),s=e.processedYData,i=this.chart,a=t.ranges,n=[],r=[],l=[],p=i.get(t.volumeSeriesID);if(e.chart){var h;if(!p||!p.getColumn("x",!0).length)return h=p&&!p.getColumn("x",!0).length?" does not contain any data.":" not found! Check `volumeSeriesID`.",void u("Series "+t.volumeSeriesID+h,!0,i);t=m(s[0]);if(!t||4===s[0].length){const d=this.priceZones=this.specifyZones(t,o,s,a,p);return d.forEach(function(e,t){n.push([e.x,e.end]),r.push(n[t][0]),l.push(n[t][1])}),{values:n,xData:r,yData:l}}u("Type of "+e.name+" series is different than line, OHLC or candlestick.",!0,i)}else u("Base series not found! In case it has been removed, add a new one.",!0,i)}specifyZones(e,t,o,s,i){const a=this,n=!!e&&function(e){var t=e.length;let o=e[0][3],s=o,i=1,a;for(;i<t;i++)(a=e[i][3])<o&&(o=a),a>s&&(s=a);return{min:o,max:s}}(o),r=a.zoneStarts=[],l=[];let p=n?n.min:v(o),h=n?n.max:S(o),d=0,u=1;const c=a.linkedParent;if(!a.options.compareToMain&&c.dataModify&&(p=c.dataModify.modifyValue(p),h=c.dataModify.modifyValue(h)),!f(p)||!f(h))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];var m=a.rangeStep=V(h-p)/s;for(r.push(p);d<s-1;d++)r.push(V(r[d]+m));r.push(h);for(var g=r.length;u<g;u++)l.push({index:u-1,x:t[0],start:r[u-1],end:r[u]});return a.volumePerZone(e,l,i,t,o)}volumePerZone(o,e,t,s,i){const a=this,n=t.getColumn("x",!0),r=t.getColumn("y",!0),l=e.length-1,p=i.length,h=r.length;let d,u,c,m,g;return b(p-h)&&(s[0]!==n[0]&&r.unshift(0),s[p-1]!==n[h-1]&&r.push(0)),a.volumeDataArray=[],e.forEach(function(e){for(e.wholeVolumeData=0,e.positiveVolumeData=0,e.negativeVolumeData=0,g=0;g<p;g++){u=!1,c=!1,m=o?i[g][3]:i[g],d=g?o?i[g-1][3]:i[g-1]:m;const t=a.linkedParent;!a.options.compareToMain&&t.dataModify&&(m=t.dataModify.modifyValue(m),d=t.dataModify.modifyValue(d)),m<=e.start&&0===e.index&&(u=!0),m>=e.end&&e.index===l&&(c=!0),(m>e.start||u)&&(m<e.end||c)&&(e.wholeVolumeData+=r[g],d>m?e.negativeVolumeData+=r[g]:e.positiveVolumeData+=r[g])}a.volumeDataArray.push(e.wholeVolumeData)}),e}drawZones(t,o,e,s){const i=t.renderer,a=t.plotWidth,n=t.plotTop;let r=this.zoneLinesSVG,l=[],p;e.forEach(function(e){p=o.toPixels(e)-n,l=l.concat(t.renderer.crispLine([["M",0,p],["L",a,p]],s.lineWidth))}),r?r.animate({d:l}):r=this.zoneLinesSVG=i.path(l).attr({"stroke-width":s.lineWidth,stroke:s.color,dashstyle:s.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)}}y.defaultOptions=g(h.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{align:"left",allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}}),c(y.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:n,markerAttribs:p,drawGraph:p,getColumnMetrics:D.getColumnMetrics,crispCol:D.crispCol}),a().registerSeriesType("vbp",y);const x=t();return e.default})());
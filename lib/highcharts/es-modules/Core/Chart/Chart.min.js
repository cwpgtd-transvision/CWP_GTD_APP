"use strict";import A from"../Animation/AnimationUtilities.js";const{animate,animObject,setAnimation}=A;import Axis from"../Axis/Axis.js";import D from"../Defaults.js";const defaultOptions=D["defaultOptions"];import Templating from"../Templating.js";const numberFormat=Templating["numberFormat"];import Foundation from"../Foundation.js";const registerEventOptions=Foundation["registerEventOptions"];import H from"../Globals.js";const{charts,doc,marginNames,svg,win}=H;import RendererRegistry from"../Renderer/RendererRegistry.js";import Series from"../Series/Series.js";import SeriesRegistry from"../Series/SeriesRegistry.js";const seriesTypes=SeriesRegistry["seriesTypes"];import SVGRenderer from"../Renderer/SVG/SVGRenderer.js";import Time from"../Time.js";import U from"../Utilities.js";import AST from"../Renderer/HTML/AST.js";import Tick from"../Axis/Tick.js";const{addEvent,attr,createElement,css,defined,diffObjects,discardElement,erase,error,extend,find,fireEvent,getAlignFactor,getStyle,isArray,isNumber,isObject,isString,merge,objectEach,pick,pInt,relativeLength,removeEvent,splat,syncTimeout,uniqueKey}=U;class Chart{static chart(e,t,i){return new Chart(e,t,i)}constructor(e,t,i){this.sharedClips={};const s=[...arguments];(isString(e)||e.nodeName)&&(this.renderTo=s.shift()),this.init(s[0],s[1])}setZoomOptions(){var e=this.options.chart,t=e.zooming;this.zooming={...t,type:pick(e.zoomType,t.type),key:pick(e.zoomKey,t.key),pinchType:pick(e.pinchType,t.pinchType),singleTouch:pick(e.zoomBySingleTouch,t.singleTouch,!1),resetButton:merge(t.resetButton,e.resetZoomButton)}}init(o,r){fireEvent(this,"init",{args:arguments},function(){const e=merge(defaultOptions,o),t=e.chart,i=this.renderTo||t.renderTo;this.userOptions=extend({},o),(this.renderTo=isString(i)?doc.getElementById(i):i)||error(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=r,this.isResizing=0,this.options=e,this.axes=[],this.series=[],this.locale=e.lang.locale??this.renderTo.closest("[lang]")?.lang,this.time=new Time(extend(e.time||{},{locale:this.locale}),e.lang),e.time=this.time.options,this.numberFormatter=(t.numberFormatter||numberFormat).bind(this),this.styledMode=t.styledMode,this.hasCartesianSeries=t.showAxes;var s=this;s.index=charts.length,charts.push(s),H.chartCount++,registerEventOptions(this,t),s.xAxis=[],s.yAxis=[],s.pointCount=s.colorCounter=s.symbolCounter=0,this.setZoomOptions(),fireEvent(s,"afterInit"),s.firstRender()})}initSeries(e){const t=this,i=t.options.chart,s=e.type||i.type,o=seriesTypes[s],r=(o||error(17,!0,t,{missingModuleFor:s}),new o);return"function"==typeof r.init&&r.init(t,e),r}setSortedData(){this.getSeriesOrderByLinks().forEach(function(e){e.points||e.data||!e.enabledDataSorting||e.setData(e.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(e,t){return e.linkedSeries.length||t.linkedSeries.length?t.linkedSeries.length-e.linkedSeries.length:0})}orderItems(e,i=0){const s=this[e],o=this.options[e]=splat(this.options[e]).slice(),r=this.userOptions[e]=this.userOptions[e]?splat(this.userOptions[e]).slice():[];if(this.hasRendered&&(o.splice(i),r.splice(i)),s)for(let e=i,t=s.length;e<t;++e){const n=s[e];n&&(n.index=e,n instanceof Series&&(n.name=n.getName()),n.options.isInternal||(o[e]=n.options,r[e]=n.userOptions))}}getClipBox(e,t){var i=this.inverted,{xAxis:s,yAxis:o}=e||{};let{x:r,y:n,width:a,height:h}=merge(this.clipBox);return e&&(s&&s.len!==this.plotSizeX&&(a=s.len),o&&o.len!==this.plotSizeY&&(h=o.len),i&&!e.invertible&&([a,h]=[h,a])),t&&(r+=(i?o:s)?.pos??this.plotLeft,n+=(i?s:o)?.pos??this.plotTop),{x:r,y:n,width:a,height:h}}isInsidePlot(e,t,i={}){const{inverted:s,plotBox:o,plotLeft:r,plotTop:n,scrollablePlotBox:a}=this,{scrollLeft:h=0,scrollTop:l=0}=i.visiblePlotOnly&&this.scrollablePlotArea?.scrollingContainer||{},d=i.series,c=i.visiblePlotOnly&&a||o,p=i.inverted?t:e,g=i.inverted?e:t,f={x:p,y:g,isInsidePlot:!0,options:i};return i.ignoreX||(e=d&&(s&&!this.polar?d.yAxis:d.xAxis)||{pos:r,len:1/0},(t=i.paneCoordinates?e.pos+p:r+p)>=Math.max(h+r,e.pos)&&t<=Math.min(h+r+c.width,e.pos+e.len)||(f.isInsidePlot=!1)),!i.ignoreY&&f.isInsidePlot&&(t=!s&&i.axis&&!i.axis.isXAxis&&i.axis||d&&(s?d.xAxis:d.yAxis)||{pos:n,len:1/0},(e=i.paneCoordinates?t.pos+g:n+g)>=Math.max(l+n,t.pos)&&e<=Math.min(l+n+c.height,t.pos+t.len)||(f.isInsidePlot=!1)),fireEvent(this,"afterIsInsidePlot",f),f.isInsidePlot}redraw(e){fireEvent(this,"beforeRedraw");const t=this,i=t.hasCartesianSeries?t.axes:t.colorAxis||[],s=t.series,o=t.pointer,r=t.legend,n=t.userOptions.legend,a=t.renderer,h=a.isHidden(),l=[];let d,c,p,g=t.isDirtyBox,f=t.isDirtyLegend,m;for(a.rootFontSize=a.boxWrapper.getStyle("font-size"),t.setResponsive&&t.setResponsive(!1),setAnimation(!!t.hasRendered&&e,t),h&&t.temporaryDisplay(),t.layOutTitles(!1),p=s.length;p--;)if(((m=s[p]).options.stacking||m.options.centerInCategory)&&(c=!0,m.isDirty)){d=!0;break}if(d)for(p=s.length;p--;)(m=s[p]).options.stacking&&(m.isDirty=!0);s.forEach(function(e){e.isDirty&&("point"===e.options.legendType?("function"==typeof e.updateTotals&&e.updateTotals(),f=!0):n&&(n.labelFormatter||n.labelFormat)&&(f=!0)),e.isDirtyData&&fireEvent(e,"updatedData")}),f&&r&&r.options.enabled&&(r.render(),t.isDirtyLegend=!1),c&&t.getStacks(),i.forEach(function(e){e.updateNames(),e.setScale()}),t.getMargins(),i.forEach(function(e){e.isDirty&&(g=!0)}),i.forEach(function(e){var t=e.min+","+e.max;e.extKey!==t&&(e.extKey=t,l.push(function(){fireEvent(e,"afterSetExtremes",extend(e.eventArgs,e.getExtremes())),delete e.eventArgs})),(g||c)&&e.redraw()}),g&&t.drawChartBox(),fireEvent(t,"predraw"),s.forEach(function(e){(g||e.isDirty)&&e.visible&&e.redraw(),e.isDirtyData=!1}),o&&o.reset(!0),a.draw(),fireEvent(t,"redraw"),fireEvent(t,"render"),h&&t.temporaryDisplay(!0),l.forEach(function(e){e.call()})}get(t){var i=this.series;function s(e){return e.id===t||e.options&&e.options.id===t}let o=find(this.axes,s)||find(this.series,s);for(let e=0;!o&&e<i.length;e++)o=find(i[e].points||[],s);return o}createAxes(){const e=this.userOptions;fireEvent(this,"createAxes");for(const t of["xAxis","yAxis"])for(const i of e[t]=splat(e[t]||{}))new Axis(this,i,t);fireEvent(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((t,e)=>(e.getPointsCollection().forEach(e=>{pick(e.selectedStaging,e.selected)&&t.push(e)}),t),[])}getSelectedSeries(){return this.series.filter(e=>e.selected)}setTitle(e,t,i){this.applyDescription("title",e),this.applyDescription("subtitle",t),this.applyDescription("caption",void 0),this.layOutTitles(i)}applyDescription(i,e){const s=this;var t=this.options[i]=merge(this.options[i],e);let o=this[i];o&&e&&(this[i]=o=o.destroy()),t&&!o&&((o=this.renderer.text(t.text,0,0,t.useHTML).attr({align:t.align,class:"highcharts-"+i,zIndex:t.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(e,t){s.applyDescription(i,e),s.layOutTitles(t)},this.styledMode||o.css(extend("title"===i?{fontSize:this.options.isStock?"1em":"1.2em"}:{},t.style)),o.textPxLength=o.getBBox().width,o.css({whiteSpace:t.style?.whiteSpace}),this[i]=o)}layOutTitles(e=!0){const u=[0,0,0],{options:t,renderer:x,spacingBox:y}=this;["title","subtitle","caption"].forEach(e=>{const t=this[e],i=this.options[e],s=merge(y),o=t?.textPxLength||0;if(t&&i){fireEvent(this,"layOutTitle",{alignTo:s,key:e,textPxLength:o});const r=x.fontMetrics(t),n=r.b,a=r.h,h=i.verticalAlign||"top",l="top"===h,d=l&&i.minScale||1,c="title"===e?l?-3:0:l?u[0]+2:0,p=Math.min(s.width/o,1),g=Math.max(d,p),f=merge({y:"bottom"===h?n:c+n},{align:"title"===e?p<d?"left":"center":this.title?.alignValue},i),m=(i.width||(d<p?this.chartWidth:s.width)/g)+"px";t.alignValue!==f.align&&(t.placed=!1);var e=Math.round(t.css({width:m}).getBBox(i.useHTML).height);f.height=e,t.align(f,!1,s).attr({align:f.align,scaleX:g,scaleY:g,"transform-origin":s.x+o*g*getAlignFactor(f.align)+" "+a}),i.floating||(e=e*(e<1.2*a?1:g),"top"===h?u[0]=Math.ceil(u[0]+e):"bottom"===h&&(u[2]=Math.ceil(u[2]+e)))}},this),u[0]&&"top"===(t.title?.verticalAlign||"top")&&(u[0]+=t.title?.margin||0),u[2]&&"bottom"===t.caption?.verticalAlign&&(u[2]+=t.caption?.margin||0);var i=!this.titleOffset||this.titleOffset.join(",")!==u.join(",");this.titleOffset=u,fireEvent(this,"afterLayOutTitles"),!this.isDirtyBox&&i&&(this.isDirtyBox=this.isDirtyLegend=i,this.hasRendered&&e&&this.isDirtyBox&&this.redraw())}getContainerBox(){const e=[].map.call(this.renderTo.children,e=>{var t;if(e!==this.container)return t=e.style.display,e.style.display="none",[e,t]}),t={width:getStyle(this.renderTo,"width",!0)||0,height:getStyle(this.renderTo,"height",!0)||0};return e.filter(Boolean).forEach(([e,t])=>{e.style.display=t}),t}getChartSize(){var e=this,t=e.options.chart,i=t.width,t=t.height,s=e.getContainerBox(),o=s.height<=1||!e.renderTo.parentElement?.style.height&&"100%"===e.renderTo.style.height;e.chartWidth=Math.max(0,i||s.width||600),e.chartHeight=Math.max(0,relativeLength(t,e.chartWidth)||(o?400:s.height)),e.containerBox=s}temporaryDisplay(e){let t=this.renderTo,i;if(e)for(;t?.style;)t.hcOrigStyle&&(css(t,t.hcOrigStyle),delete t.hcOrigStyle),t.hcOrigDetached&&(doc.body.removeChild(t),t.hcOrigDetached=!1),t=t.parentNode;else for(;t?.style&&(doc.body.contains(t)||t.parentNode||(t.hcOrigDetached=!0,doc.body.appendChild(t)),"none"!==getStyle(t,"display",!1)&&!t.hcOricDetached||(t.hcOrigStyle={display:t.style.display,height:t.style.height,overflow:t.style.overflow},i={display:"block",overflow:"hidden"},t!==this.renderTo&&(i.height=0),css(t,i),t.offsetWidth||t.style.setProperty("display","block","important")),(t=t.parentNode)!==doc.body););}setClassName(e){this.container.className="highcharts-container "+(e||"")}getContainer(){const e=this,t=e.options,i=t.chart,s="data-highcharts-chart",o=uniqueKey(),r=e.renderTo;let n;var a=pInt(attr(r,s)),a=(isNumber(a)&&charts[a]&&charts[a].hasRendered&&charts[a].destroy(),attr(r,s,e.index),r.innerHTML=AST.emptyHTML,i.skipClone||r.offsetWidth||e.temporaryDisplay(),e.getChartSize(),e.chartHeight);let h=e.chartWidth;css(r,{overflow:"hidden"}),e.styledMode||(n=extend({position:"relative",overflow:"hidden",width:h+"px",height:a+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},i.style||{}));var l=createElement("div",{id:o},n,r);e.container=l,e.getChartSize(),h!==e.chartWidth&&(h=e.chartWidth,e.styledMode||css(l,{width:pick(i.style?.width,h+"px")})),e.containerBox=e.getContainerBox(),e._cursor=l.style.cursor;const d=i.renderer||!svg?RendererRegistry.getRendererType(i.renderer):SVGRenderer;if(e.renderer=new d(l,h,a,void 0,i.forExport,t.exporting?.allowHTML,e.styledMode),setAnimation(void 0,e),e.setClassName(i.className),e.styledMode)for(const c in t.defs)this.renderer.definition(t.defs[c]);else e.renderer.setStyle(i.style);e.renderer.chartIndex=e.index,fireEvent(this,"afterGetContainer")}getMargins(e){var{spacing:t,margin:i,titleOffset:s}=this;this.resetMargins(),s[0]&&!defined(i[0])&&(this.plotTop=Math.max(this.plotTop,s[0]+t[0])),s[2]&&!defined(i[2])&&(this.marginBottom=Math.max(this.marginBottom,s[2]+t[2])),this.legend?.display&&this.legend.adjustMargins(i,t),fireEvent(this,"getMargins"),e||this.getAxisMargins()}getAxisMargins(){function e(e){e.forEach(function(e){e.visible&&e.getOffset()})}const i=this,s=i.axisOffset=[0,0,0,0],t=i.colorAxis,o=i.margin;i.hasCartesianSeries?e(i.axes):t?.length&&e(t),marginNames.forEach(function(e,t){defined(o[t])||(i[e]+=s[t])}),i.setChartSize()}getOptions(){return diffObjects(this.userOptions,defaultOptions)}reflow(e){const t=this,i=t.containerBox,s=t.getContainerBox();delete t.pointer?.chartPosition,!t.exporting?.isPrinting&&!t.isResizing&&i&&s.width&&(s.width===i.width&&s.height===i.height||(U.clearTimeout(t.reflowTimeout),t.reflowTimeout=syncTimeout(function(){t.container&&t.setSize(void 0,void 0,!1)},e?100:0)),t.containerBox=s)}setReflow(){const t=this;var e=e=>{t.options?.chart.reflow&&t.hasLoaded&&t.reflow(e)};"function"==typeof ResizeObserver?new ResizeObserver(e).observe(t.renderTo):(e=addEvent(win,"resize",e),addEvent(this,"destroy",e))}setSize(e,t,i){const s=this,o=s.renderer;s.isResizing+=1,setAnimation(i,s);var i=o.globalAnimation,{chartWidth:e,chartHeight:t,scrollablePixelsX:r=0,scrollablePixelsY:n=0}=(s.oldChartHeight=s.chartHeight,s.oldChartWidth=s.chartWidth,void 0!==e&&(s.options.chart.width=e),void 0!==t&&(s.options.chart.height=t),s.getChartSize(),s);!s.isDirtyBox&&e===s.oldChartWidth&&t===s.oldChartHeight||(s.styledMode||(i?animate:css)(s.container,{width:e+r+"px",height:t+n+"px"},i),s.setChartSize(!0),o.setSize(e,t,i),s.axes.forEach(function(e){e.isDirty=!0,e.setScale()}),s.isDirtyLegend=!0,s.isDirtyBox=!0,s.layOutTitles(),s.getMargins(),s.redraw(i),s.oldChartHeight=void 0,fireEvent(s,"resize"),setTimeout(()=>{s&&fireEvent(s,"endResize")},animObject(i).duration)),--s.isResizing}setChartSize(e){const t=this,{chartHeight:i,chartWidth:s,inverted:o,spacing:r,renderer:n}=t,a=t.clipOffset,h=Math[o?"floor":"round"];var l,d,c,p;t.plotLeft=l=Math.round(t.plotLeft),t.plotTop=d=Math.round(t.plotTop),t.plotWidth=c=Math.max(0,Math.round(s-l-(t.marginRight??0))),t.plotHeight=p=Math.max(0,Math.round(i-d-(t.marginBottom??0))),t.plotSizeX=o?p:c,t.plotSizeY=o?c:p,t.spacingBox=n.spacingBox={x:r[3],y:r[0],width:s-r[3]-r[1],height:i-r[0]-r[2]},t.plotBox=n.plotBox={x:l,y:d,width:c,height:p},a&&(t.clipBox={x:h(a[3]),y:h(a[0]),width:h(t.plotSizeX-a[1]-a[3]),height:h(t.plotSizeY-a[0]-a[2])}),e||(t.axes.forEach(function(e){e.setAxisSize(),e.setAxisTranslation()}),n.alignElements()),fireEvent(t,"afterSetChartSize",{skipAxes:e})}resetMargins(){fireEvent(this,"resetMargins");const o=this,r=o.options.chart,e=r.plotBorderWidth||0,t=Math.round(e)/2;["margin","spacing"].forEach(function(i){const e=r[i],s=isObject(e)?e:[e,e,e,e];["Top","Right","Bottom","Left"].forEach(function(e,t){o[i][t]=pick(r[i+e],s[t])})}),marginNames.forEach(function(e,t){o[e]=pick(o.margin[t],o.spacing[t])}),o.axisOffset=[0,0,0,0],o.clipOffset=[t,t,t,t],o.plotBorderWidth=e}drawChartBox(){const e=this,t=e.options.chart,i=e.renderer,s=e.chartWidth,o=e.chartHeight,r=e.styledMode,n=e.plotBGImage,a=t.backgroundColor,h=t.plotBackgroundColor,l=t.plotBackgroundImage,d=e.plotLeft,c=e.plotTop,p=e.plotWidth,g=e.plotHeight,f=e.plotBox,m=e.clipRect,u=e.clipBox;let x=e.chartBackground,y=e.plotBackground,v=e.plotBorder,S,b,w,E="animate";x||(e.chartBackground=x=i.rect().addClass("highcharts-background").add(),E="attr"),r?S=b=x.strokeWidth():(S=t.borderWidth||0,b=S+(t.shadow?8:0),w={fill:a||"none"},(S||x["stroke-width"])&&(w.stroke=t.borderColor,w["stroke-width"]=S),x.attr(w).shadow(t.shadow)),x[E]({x:b/2,y:b/2,width:s-b-S%2,height:o-b-S%2,r:t.borderRadius}),E="animate",y||(E="attr",e.plotBackground=y=i.rect().addClass("highcharts-plot-background").add()),y[E](f),r||(y.attr({fill:h||"none"}).shadow(t.plotShadow),l&&(n?(l!==n.attr("href")&&n.attr("href",l),n.animate(f)):e.plotBGImage=i.image(l,d,c,p,g).add())),m?m.animate({width:u.width,height:u.height}):e.clipRect=i.clipRect(u),E="animate",v||(E="attr",e.plotBorder=v=i.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),r||v.attr({stroke:t.plotBorderColor,"stroke-width":t.plotBorderWidth||0,fill:"none"}),v[E](v.crisp(f,-v.strokeWidth())),e.isDirtyBox=!1,fireEvent(this,"afterDrawChartBox")}propFromSeries(){const t=this,i=t.options.chart,s=t.options.series;let o,r,n;["inverted","angular","polar"].forEach(function(e){for(r=seriesTypes[i.type],n=i[e]||r&&r.prototype[e],o=s?.length;!n&&o--;)(r=seriesTypes[s[o].type])&&r.prototype[e]&&(n=!0);t[e]=n})}linkSeries(e){const s=this,t=s.series;t.forEach(function(e){e.linkedSeries.length=0}),t.forEach(function(t){var i=t.options["linkedTo"];if(isString(i)){let e;(e=":previous"===i?s.series[t.index-1]:s.get(i))&&e.linkedParent!==t&&(e.linkedSeries.push(t),(t.linkedParent=e).enabledDataSorting&&t.setDataSortingOptions(),t.visible=pick(t.options.visible,e.options.visible,t.visible))}}),fireEvent(this,"afterLinkSeries",{isUpdating:e})}renderSeries(){this.series.forEach(function(e){e.translate(),e.render()})}render(){const e=this,t=e.axes,i=e.colorAxis,s=e.renderer,o=e.options.chart.axisLayoutRuns||2,r=e=>{e.forEach(e=>{e.visible&&e.render()})};let n=0,a=!0,h,l=0;e.setTitle(),fireEvent(e,"beforeMargins"),e.getStacks?.(),e.getMargins(!0),e.setChartSize();for(const f of t){var d=f["options"],c=d["labels"];if(e.hasCartesianSeries&&f.horiz&&f.visible&&c.enabled&&f.series.length&&"colorAxis"!==f.coll&&!e.polar){n=d.tickLength,f.createGroups();const m=new Tick(f,0,"",!0),u=m.createLabel("x",c);if(m.destroy(),n=u&&pick(c.reserveSpace,!isNumber(d.crossing))?u.getBBox().height+c.distance+Math.max(d.offset||0,0):n){u?.destroy();break}}}for(e.plotHeight=Math.max(e.plotHeight-n,0);(a||h||1<o)&&l<o;){var p=e.plotWidth,g=e.plotHeight;for(const x of t)0===l?x.setScale():(x.horiz&&a||!x.horiz&&h)&&x.setTickInterval(!0);0===l?e.getAxisMargins():e.getMargins(),a=p/e.plotWidth>(l?1:1.1),h=g/e.plotHeight>(l?1:1.05),l++}e.drawChartBox(),e.hasCartesianSeries?r(t):i?.length&&r(i),e.seriesGroup||(e.seriesGroup=s.g("series-group").attr({zIndex:3}).shadow(e.options.chart.seriesGroupShadow).add()),e.dataLabelsGroup||(e.dataLabelsGroup=s.g("datalabels-group").attr({zIndex:6}).add()),e.renderSeries(),e.addCredits(),e.setResponsive&&e.setResponsive(),e.hasRendered=!0}addCredits(e){const t=this,i=merge(!0,this.options.credits,e);i.enabled&&!this.credits&&(this.credits=this.renderer.text(i.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){i.href&&(win.location.href=i.href)}).attr({align:i.position.align,zIndex:8}),t.styledMode||this.credits.css(i.style),this.credits.add().align(i.position),this.credits.update=function(e){t.credits=t.credits.destroy(),t.addCredits(e)})}destroy(){const i=this,e=i.axes,t=i.series,s=i.container,o=s?.parentNode;let r;for(fireEvent(i,"destroy"),i.renderer.forExport?erase(charts,i):charts[i.index]=void 0,H.chartCount--,i.renderTo.removeAttribute("data-highcharts-chart"),removeEvent(i),r=e.length;r--;)e[r]=e[r].destroy();for(this.scroller?.destroy?.(),r=t.length;r--;)t[r]=t[r].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(e=>{i[e]=i[e]?.destroy?.()}),s&&(s.innerHTML=AST.emptyHTML,removeEvent(s),o&&discardElement(s)),objectEach(i,function(e,t){delete i[t]})}firstRender(){const t=this,e=t.options,i=(t.getContainer(),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.createAxes(),isArray(e.series)?e.series:[]);e.series=[],i.forEach(function(e){t.initSeries(e)}),t.linkSeries(),t.setSortedData(),fireEvent(t,"beforeRender"),t.render(),t.pointer?.getChartPosition(),t.renderer.imgCount||t.hasLoaded||t.onload(),t.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(e){e&&void 0!==this.index&&e.apply(this,[this])},this),fireEvent(this,"load"),fireEvent(this,"render"),defined(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){const{options:e,title:t}=this;e&&!this.accessibility&&(this.renderer.boxWrapper.attr({role:"img","aria-label":(t?.element.textContent||"").replace(/</g,"&lt;")}),e.accessibility&&!1===e.accessibility.enabled||error('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(e,t,i){const s=this;let o;return e&&(t=pick(t,!0),fireEvent(s,"addSeries",{options:e},function(){o=s.initSeries(e),s.isDirtyLegend=!0,s.linkSeries(),o.enabledDataSorting&&o.setData(e.data,!1),fireEvent(s,"afterAddSeries",{series:o}),t&&s.redraw(i)})),o}addAxis(e,t,i,s){return this.createAxis(t?"xAxis":"yAxis",{axis:e,redraw:i,animation:s})}addColorAxis(e,t,i){return this.createAxis("colorAxis",{axis:e,redraw:t,animation:i})}createAxis(e,t){e=new Axis(this,t.axis,e);return pick(t.redraw,!0)&&this.redraw(t.animation),e}showLoading(e){function t(){r&&css(r,{left:i.plotLeft+"px",top:i.plotTop+"px",width:i.plotWidth+"px",height:i.plotHeight+"px"})}const i=this,s=i.options,o=s.loading;let r=i.loadingDiv,n=i.loadingSpan;r||(i.loadingDiv=r=createElement("div",{className:"highcharts-loading highcharts-loading-hidden"},null,i.container)),n||(i.loadingSpan=n=createElement("span",{className:"highcharts-loading-inner"},null,r),addEvent(i,"redraw",t)),r.className="highcharts-loading",AST.setElementHTML(n,pick(e,s.lang.loading,"")),i.styledMode||(css(r,extend(o.style,{zIndex:10})),css(n,o.labelStyle),i.loadingShown||(css(r,{opacity:0,display:""}),animate(r,{opacity:o.style.opacity||.5},{duration:o.showDuration||0}))),i.loadingShown=!0,t()}hideLoading(){const e=this.options,t=this.loadingDiv;t&&(t.className="highcharts-loading highcharts-loading-hidden",this.styledMode||animate(t,{opacity:0},{duration:e.loading.hideDuration||100,complete:function(){css(t,{display:"none"})}})),this.loadingShown=!1}update(i,e,r,t){const n=this,s={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},o=i.isResponsiveOptions,a=[];let h,l,d;fireEvent(n,"update",{options:i}),o||n.setResponsive(!1,!0),i=diffObjects(i,n.options),n.userOptions=merge(n.userOptions,i);var c=i.chart,p=(c&&(merge(!0,n.options.chart,c),this.setZoomOptions(),"className"in c&&n.setClassName(c.className),("inverted"in c||"polar"in c||"type"in c)&&(n.propFromSeries(),h=!0),"alignTicks"in c&&(h=!0),"events"in c&&registerEventOptions(this,c),objectEach(c,function(e,t){-1!==n.propsRequireUpdateSeries.indexOf("chart."+t)&&(l=!0),-1!==n.propsRequireDirtyBox.indexOf(t)&&(n.isDirtyBox=!0),-1!==n.propsRequireReflow.indexOf(t)&&(n.isDirtyBox=!0,o||(d=!0))}),!n.styledMode&&c.style&&n.renderer.setStyle(n.options.chart.style||{})),!n.styledMode&&i.colors&&(this.options.colors=i.colors),objectEach(i,function(e,t){n[t]&&"function"==typeof n[t].update?n[t].update(e,!1):"function"==typeof n[s[t]]?n[s[t]](e):"colors"!==t&&-1===n.collectionsWithUpdate.indexOf(t)&&merge(!0,n.options[t],i[t]),"chart"!==t&&-1!==n.propsRequireUpdateSeries.indexOf(t)&&(l=!0)}),this.collectionsWithUpdate.forEach(function(o){i[o]&&(splat(i[o]).forEach(function(e,t){var i=defined(e.id);let s;(s=!(s=i?n.get(e.id):s)&&n[o]&&(s=n[o][pick(e.index,t)])&&(i&&defined(s.options.id)||s.options.isInternal)?void 0:s)&&s.coll===o&&(s.update(e,!1),r&&(s.touched=!0)),!s&&r&&n.collectionsWithInit[o]&&(n.collectionsWithInit[o][0].apply(n,[e].concat(n.collectionsWithInit[o][1]||[]).concat([!1])).touched=!0)}),r&&n[o].forEach(function(e){e.touched||e.options.isInternal?delete e.touched:a.push(e)}))}),a.forEach(function(e){e.chart&&e.remove&&e.remove(!1)}),h&&n.axes.forEach(function(e){e.update({},!1)}),l&&n.getSeriesOrderByLinks().forEach(function(e){e.chart&&e.update({},!1)},this),c?.width),c=c&&(isString(c.height)?relativeLength(c.height,p||n.chartWidth):c.height);d||isNumber(p)&&p!==n.chartWidth||isNumber(c)&&c!==n.chartHeight?n.setSize(p,c,t):pick(e,!0)&&n.redraw(t),fireEvent(n,"afterUpdate",{options:i,redraw:e,animation:t})}setSubtitle(e,t){this.applyDescription("subtitle",e),this.layOutTitles(t)}setCaption(e,t){this.applyDescription("caption",e),this.layOutTitles(t)}showResetZoom(){const e=this,t=defaultOptions.lang,i=e.zooming.resetButton,s=i.theme,o="chart"===i.relativeTo||"spacingBox"===i.relativeTo?null:"plotBox";function r(){e.zoomOut()}fireEvent(this,"beforeShowResetZoom",null,function(){e.resetZoomButton=e.renderer.button(t.resetZoom,null,null,r,s).attr({align:i.position.align,title:t.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(i.position,!1,o)}),fireEvent(this,"afterShowResetZoom")}zoomOut(){fireEvent(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(e,t){const i=this,s="object"==typeof t?t:{enabled:t,type:"x"},o=s.type,r=o&&i[{x:"xAxis",xy:"axes",y:"yAxis"}[o]].filter(e=>e.options.panningEnabled&&!e.options.isInternal),n=i.options.chart;n?.panning&&(n.panning=s),fireEvent(this,"pan",{originalEvent:e},()=>{i.transform({axes:r,event:e,to:{x:e.chartX-(i.mouseDownX||0),y:e.chartY-(i.mouseDownY||0)},trigger:"pan"}),css(i.container,{cursor:"move"})})}transform(e){const{axes:t=this.axes,event:s,from:i={},reset:o,selection:r,to:n={},trigger:a}=e,{inverted:h,time:l}=this;this.hoverPoints?.forEach(e=>e.setState()),fireEvent(this,"transform",e);let d=e.hasZoomed||!1,c,p;for(const M of t){var{horiz:g,len:f,minPointOffset:m=0,options:u,reversed:x}=M,y=g?"width":"height",v=g?"x":"y",S=pick(n[y],M.len),y=pick(i[y],M.len),b=Math.abs(S)<10?1:S/y,y=(i[v]||0)+y/2-M.pos,v=y-((n[v]??M.pos)+S/2-M.pos)/b,S=x&&!h||!x&&h?-1:1,x=v;if(o||!(y<0||y>M.len)){y=!M.chart.polar&&!M.isOrdinal&&m*S||0,m=M.toValue(x,!0),S=M.toValue(x+f/b,!0);let e=m+y,t=S-y,i=M.allExtremes;if(r&&r[M.coll].push({axis:M,min:Math.min(m,S),max:Math.max(m,S)}),e>t&&([e,t]=[t,e]),1==b&&!o&&"yAxis"===M.coll&&!i){for(const C of M.series){var w=C.getExtremes(C.getProcessedData(!0).modified.getColumn("y")||[],!0);i=i??{dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE},isNumber(w.dataMin)&&isNumber(w.dataMax)&&(i.dataMin=Math.min(w.dataMin,i.dataMin),i.dataMax=Math.max(w.dataMax,i.dataMax))}M.allExtremes=i}var{dataMin:x,dataMax:f,min:y,max:m}=extend(M.getExtremes(),i||{}),S=l.parse(u.min),E=l.parse(u.max),x=x??S,f=f??E,T=t-e,B=M.categories?0:Math.min(T,f-x),x=x-B*(defined(S)?0:u.minPadding),f=f+B*(defined(E)?0:u.maxPadding),B=M.allowZoomOutside||1==b||"zoom"!==a&&1<b,u=Math.min(S??x,x,B?y:x),S=Math.max(E??f,f,B?m:f);M.isOrdinal&&1==b&&!o||(e<u&&(e=u,1<=b&&(t=e+T)),t>S&&(t=S,1<=b&&(e=t-T)),(o||M.series.length&&(e!==y||t!==m)&&e>=u&&t<=S)&&(r?r[M.coll].push({axis:M,min:e,max:t}):(M.isPanning="zoom"!==a,M.isPanning&&(p=!0),M.setExtremes(o?void 0:e,o?void 0:t,!1,!1,{move:v,trigger:a,scale:b}),!o&&(e>u||t<S)&&"mousewheel"!==a&&(c=!0)),d=!0),this.hasCartesianSeries||o||"mousewheel"===a||(c=!0),s&&(this[g?"mouseDownX":"mouseDownY"]=s[g?"chartX":"chartY"]))}}return d&&(r?fireEvent(this,"selection",r,()=>{delete e.selection,e.trigger="zoom",this.transform(e)}):(!c||p||this.resetZoomButton?!c&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw("zoom"===a&&(this.options.chart.animation??this.pointCount<100)))),d}}extend(Chart.prototype,{callbacks:[],collectionsWithInit:{xAxis:[Chart.prototype.addAxis,[!0]],yAxis:[Chart.prototype.addAxis,[!1]],series:[Chart.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});export default Chart;
"use strict";import H from"../Core/Globals.js";const{isSafari,win,win:{document:doc}}=H;import U from"../Core/Utilities.js";const error=U["error"],domurl=win.URL||win.webkitURL||win;function dataURLtoBlob(o){o=o.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(o&&3<o.length&&win.atob&&win.ArrayBuffer&&win.Uint8Array&&win.Blob&&domurl.createObjectURL){const e=win.atob(o[3]),t=new win.ArrayBuffer(e.length),r=new win.Uint8Array(t);for(let o=0;o<r.length;++o)r[o]=e.charCodeAt(o);return domurl.createObjectURL(new win.Blob([r],{type:o[1]}))}}function downloadURL(o,e){const t=win.navigator,r=doc.createElement("a");if("string"==typeof o||o instanceof String||!t.msSaveOrOpenBlob){if(o=""+o,1e3<t.userAgent.length)throw new Error("Input too long");var n=/Edge\/\d+/.test(t.userAgent),i=isSafari&&"string"==typeof o&&0===o.indexOf("data:application/pdf");if((i||n||2e6<o.length)&&!(o=dataURLtoBlob(o)||""))throw new Error("Failed to convert to blob");if(void 0!==r.download)r.href=o,r.download=e,doc.body.appendChild(r),r.click(),doc.body.removeChild(r);else try{if(!win.open(o,"chart"))throw new Error("Failed to open window")}catch{win.location.href=o}}else t.msSaveOrOpenBlob(o,e)}function getScript(n){return new Promise((o,e)=>{const t=doc.getElementsByTagName("head")[0],r=doc.createElement("script");r.type="text/javascript",r.src=n,r.onload=()=>{o()},r.onerror=()=>{e(error("Error loading script "+n))},t.appendChild(r)})}const DownloadURL={dataURLtoBlob:dataURLtoBlob,downloadURL:downloadURL,getScript:getScript};export default DownloadURL;export{getScript};
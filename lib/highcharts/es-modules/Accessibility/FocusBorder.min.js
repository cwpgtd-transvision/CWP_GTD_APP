"use strict";import U from"../Core/Utilities.js";const{addEvent,pick}=U;var FocusBorderComposition;!function(o){const E=["x","y","transform","width","height","r","d","stroke-width"];function s(){const o=this.focusElement,t=this.options.accessibility.keyboardNavigation.focusBorder;o&&(o.removeFocusBorder(),t.enabled&&o.addFocusBorder(t.margin,{stroke:t.style.color,strokeWidth:t.style.lineWidth,r:t.style.borderRadius}))}function i(o,t){const e=this.options.accessibility.keyboardNavigation.focusBorder,r=t||o.element;r&&r.focus&&(r.hcEvents&&r.hcEvents.focusin||addEvent(r,"focusin",function(){}),r.focus(),e.hideBrowserFocusOutline&&(r.style.outline="none")),this.focusElement&&this.focusElement.removeFocusBorder(),this.focusElement=o,this.renderFocusBorder()}function d(o,t){this.focusBorder&&this.removeFocusBorder();const e=this.getBBox(),r=pick(o,3),s=this.parentGroup,i=this.scaleX||s&&s.scaleX,d=this.scaleY||s&&s.scaleY,c=i?!d:d,n=c?Math.abs(i||d||1):(Math.abs(i||1)+Math.abs(d||1))/2,a=this.renderer.fontMetrics(this).h;e.x+=this.translateX||0,e.y+=this.translateY||0;let u=e.x-r,h=e.y-r,f=e.width+2*r,B=e.height+2*r;var l,y,p,k,m,F,v,x=!!this.text,H=("text"!==this.element.nodeName&&!x||(l=!!this.rotation,y=x?{x:l?1:0,y:0}:function(o){let t=0,e=0;return"middle"===o.attr("text-anchor")?t=e=.5:o.rotation?t=.25:e=.75,{x:t,y:e}}(this),p=+this.attr("x"),k=+this.attr("y"),isNaN(p)||(u=p-e.width*y.x-r),isNaN(k)||(m="start"===this.attr("text-anchor")?a:e.height,h=k-m*y.y-r),x&&l&&(m=f,f=B,B=m,isNaN(p)||(u=p-e.height*y.x-r),isNaN(k)||(h=k-e.width*y.y-r))),this.focusBorder=this.renderer.rect(u,h,f,B,parseInt((t&&t.r||0).toString(),10)/n).addClass("highcharts-focus-border").attr({zIndex:99}).add(s),this.renderer.styledMode||this.focusBorder.attr({stroke:t&&t.stroke,"stroke-width":(t&&t.strokeWidth||0)/n}),v=[o,t],(F=this).focusBorderUpdateHooks||(F.focusBorderUpdateHooks={},E.forEach(o=>{o+="Setter";const t=F[o]||F._defaultSetter;F.focusBorderUpdateHooks[o]=t,F[o]=function(){var o=t.apply(F,arguments);return F.addFocusBorder.apply(F,v),o}})),this);if(!H.focusBorderDestroyHook){const b=H.destroy;H.destroy=function(){return H.focusBorder&&H.focusBorder.destroy&&H.focusBorder.destroy(),b.apply(H,arguments)},H.focusBorderDestroyHook=b}}function c(){var e,o;(e=this).focusBorderUpdateHooks&&(Object.keys(e.focusBorderUpdateHooks).forEach(o=>{var t=e.focusBorderUpdateHooks[o];t===e._defaultSetter?delete e[o]:e[o]=t}),delete e.focusBorderUpdateHooks),(o=this).focusBorderDestroyHook&&(o.destroy=o.focusBorderDestroyHook,delete o.focusBorderDestroyHook),this.focusBorder&&(this.focusBorder.destroy(),delete this.focusBorder)}o.compose=function(o,t){const e=o.prototype,r=t.prototype;e.renderFocusBorder||(e.renderFocusBorder=s,e.setFocusToElement=i),r.addFocusBorder||(r.addFocusBorder=d,r.removeFocusBorder=c)}}(FocusBorderComposition=FocusBorderComposition||{});export default FocusBorderComposition;
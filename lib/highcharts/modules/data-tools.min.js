!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(e._Highcharts):"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts/highcharts"],function(e){return t(e)}):"object"==typeof exports?exports["highcharts/modules/data-tools"]=t(e._Highcharts):e.Highcharts=t(e.Highcharts)}("undefined"==typeof window?this:window,Ft=>(()=>{"use strict";var S={944:e=>{e.exports=Ft}},k={};function s(e){var t=k[e];if(void 0!==t)return t.exports;t=k[e]={exports:{}};return S[e](t,t.exports,s),t.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r,o,i,Y={},e=(s.d(Y,{default:()=>It}),s(944)),n=s.n(e);let{addEvent:V,fireEvent:U,merge:$}=n();class t{benchmark(e,t){let r=[],s=this,o=()=>{s.modifyTable(e),s.emit({type:"afterBenchmarkIteration"})},i=$({iterations:1},t)["iterations"],n=(s.on("afterBenchmarkIteration",()=>{r.length===i?s.emit({type:"afterBenchmark",results:r}):o()}),{startTime:0,endTime:0});return s.on("modify",()=>{n.startTime=window.performance.now()}),s.on("afterModify",()=>{n.endTime=window.performance.now(),r.push(n.endTime-n.startTime)}),o(),r}emit(e){U(this,e.type,e)}modify(r,s){let o=this;return new Promise((e,t)=>{r.modified===r&&(r.modified=r.clone(!1,s));try{e(o.modifyTable(r,s))}catch(e){o.emit({type:"error",detail:s,table:r}),t(e)}})}modifyCell(e,t,r,s,o){return this.modifyTable(e)}modifyColumns(e,t,r,s){return this.modifyTable(e)}modifyRows(e,t,r,s){return this.modifyTable(e)}on(e,t){return V(this,e,t)}}(r=t=t||{}).types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)};let l=t,d=((e=P=P||{}).setLength=function(e,t,r){return Array.isArray(e)?(e.length=t,e):e[r?"subarray":"slice"](0,t)},e.splice=function(e,t,r,s,o=[]){if(Array.isArray(e))return Array.isArray(o)||(o=Array.from(o)),{removed:e.splice(t,r,...o),array:e};let i=Object.getPrototypeOf(e).constructor,n=e[s?"subarray":"slice"](t,t+r),l=new i(e.length-r+o.length);return l.set(e.subarray(0,t),0),l.set(o,t),l.set(e.subarray(t+r),t+o.length),{removed:n,array:l}},P),{setLength:H,splice:_}=d,{fireEvent:a,objectEach:u,uniqueKey:h}=n(),{addEvent:B,defined:f,extend:G,fireEvent:K,isNumber:Z,uniqueKey:J}=n();class m extends class{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||h(),(this.modified=this).rowCount=0,this.versionTag=h();let r=0;u(e.columns||{},(e,t)=>{this.columns[t]=e.slice(),r=Math.max(r,e.length)}),this.applyRowCount(r)}applyRowCount(r){this.rowCount=r,u(this.columns,(e,t)=>{e.length!==r&&(this.columns[t]=H(e,r))})}deleteRows(s,o=1){if(0<o&&s<this.rowCount){let r=0;u(this.columns,(e,t)=>{this.columns[t]=_(e,s,o).array,r=e.length}),this.rowCount=r}a(this,"afterDeleteRows",{rowIndex:s,rowCount:o}),this.versionTag=h()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce((e,t)=>(e[t]=this.columns[t],e),{})}getRow(t,e){return(e||Object.keys(this.columns)).map(e=>this.columns[e]?.[t])}setColumn(e,t=[],r=0,s){this.setColumns({[e]:t},r,s)}setColumns(e,t,r){let s=this.rowCount;u(e,(e,t)=>{this.columns[t]=e.slice(),s=e.length}),this.applyRowCount(s),r?.silent||(a(this,"afterSetColumns"),this.versionTag=h())}setRow(e,s=this.rowCount,o,i){let n=this["columns"],l=o?this.rowCount+1:s+1;u(e,(e,t)=>{let r=n[t]||!1!==i?.addColumns&&Array(l);r&&(o?r=_(r,s,0,!0,[e]).array:r[s]=e,n[t]=r)}),l>this.rowCount&&this.applyRowCount(l),i?.silent||(a(this,"afterSetRows"),this.versionTag=h())}}{static isNull(r){if(r===m.NULL)return!0;if(r instanceof Array){if(!r.length)return!1;for(let e=0,t=r.length;e<t;++e)if(null!==r[e])return!1}else{var s=Object.keys(r);if(!s.length)return!1;for(let e=0,t=s.length;e<t;++e)if(null!==r[s[e]])return!1}return!0}constructor(e={}){super(e),this.modified=this}clone(e,t){let r={},s=(this.emit({type:"cloneTable",detail:t}),e||(r.columns=this.columns),this.autoId||(r.id=this.id),new m(r));return e||(s.versionTag=this.versionTag,s.originalRowIndexes=this.originalRowIndexes,s.localRowIndexes=this.localRowIndexes),this.emit({type:"afterCloneTable",detail:t,tableClone:s}),s}deleteColumns(o,e){let i=this.columns,n={},l={},t=this.modifier,a=this.rowCount;if((o=o||Object.keys(i)).length){this.emit({type:"deleteColumns",columnNames:o,detail:e});for(let e=0,t=o.length,r,s;e<t;++e)(r=i[s=o[e]])&&(n[s]=r,l[s]=Array(a)),delete i[s];return Object.keys(i).length||(this.rowCount=0,this.deleteRowIndexReferences()),t&&t.modifyColumns(this,l,0,e),this.emit({type:"afterDeleteColumns",columns:n,columnNames:o,detail:e}),n}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(l,a=1,e){let u=[],h=[],t=this.modifier;if(this.emit({type:"deleteRows",detail:e,rowCount:a,rowIndex:l||0}),void 0===l&&(l=0,a=this.rowCount),0<a&&l<this.rowCount){let i=this.columns,n=Object.keys(i);for(let r=0,e=n.length,t,s,o;r<e;++r){t=i[o=n[r]];var m=d.splice(t,l,a);s=m.removed,i[o]=t=m.array,r||(this.rowCount=t.length);for(let e=0,t=s.length;e<t;++e)u[e]=u[e]||[],u[e][r]=s[e];h.push(Array(e))}}return t&&t.modifyRows(this,h,l||0,e),this.emit({type:"afterDeleteRows",detail:e,rowCount:a,rowIndex:l||0,rows:u}),u}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=J()),K(this,e.type,e)}getCell(e,t){e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,r){let s=this.columns[e],o=s&&s[t];switch(typeof o){case"boolean":return+!!o;case"number":return isNaN(o)&&!r?null:o}return isNaN(o=parseFloat(""+(o??"")))&&!r?null:o}getCellAsString(e,t){e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(t,e){let r=this.columns[t],s=[];if(r){var o=r.length;if(e)for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<o;++e){if("number"==typeof(t=r[e]))return r.slice();if(null!=t)break}for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e))}}return s}getColumnNames(){return Object.keys(this.columns)}getColumns(o,i,n){let l=this.columns,a={};for(let e=0,t=(o=o||Object.keys(l)).length,r,s;e<t;++e)(r=l[s=o[e]])&&(i?a[s]=r:n&&!Array.isArray(r)?a[s]=Array.from(r):a[s]=r.slice());return a}getLocalRowIndex(e){var t=this["localRowIndexes"];return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){var t=this["originalRowIndexes"];return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,r){let s=this.columns[e];if(s){let e=-1;if(-1!==(e=Array.isArray(s)||Z(t)?s.indexOf(t,r):e))return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(i=0,n=this.rowCount-i,l){let a=this.columns,u=Array(n);l=l||Object.keys(a);for(let e=i,t=0,r=Math.min(this.rowCount,i+n),s,o;e<r;++e,++t)for(var h of(o=u[t]={},l))s=a[h],o[h]=s?s[e]:void 0;return u}getRows(i=0,n=this.rowCount-i,l){let a=this.columns,u=Array(n);l=l||Object.keys(a);for(let e=i,t=0,r=Math.min(this.rowCount,i+n),s,o;e<r;++e,++t)for(var h of(o=u[t]=[],l))s=a[h],o.push(s?s[e]:void 0);return u}getVersionTag(){return this.versionTag}hasColumns(r){var s=this.columns;for(let e=0,t=r.length;e<t;++e)if(!s[r[e]])return!1;return!0}hasRowWith(e,t){let r=this.columns[e];return Array.isArray(r)?-1!==r.indexOf(t):!(!f(t)||!Number.isFinite(t))&&-1!==r.indexOf(+t)}on(e,t){return B(this,e,t)}renameColumn(e,t){let r=this.columns;return!!r[e]&&(e!==t&&(r[t]=r[e],delete r[e]),!0)}setCell(e,t,r,s){let o=this.columns,i=this.modifier,n=o[e];n&&n[t]===r||(this.emit({type:"setCell",cellValue:r,columnName:e,detail:s,rowIndex:t}),n=n||(o[e]=Array(this.rowCount)),t>=this.rowCount&&(this.rowCount=t+1),n[t]=r,i&&i.modifyCell(this,e,t,r),this.emit({type:"afterSetCell",cellValue:r,columnName:e,detail:s,rowIndex:t}))}setColumns(n,l,e,a){let u=this.columns,t=this.modifier,h=Object.keys(n),m=this.rowCount;if(this.emit({type:"setColumns",columns:n,columnNames:h,detail:e,rowIndex:l}),f(l)||a){for(let e=0,t=h.length,r,s,o,i;e<t;++e){r=n[o=h[e]],i=Object.getPrototypeOf((s=u[o])&&a?s:r).constructor,s?i===Array?Array.isArray(s)||(s=Array.from(s)):s.length<m&&(s=new i(m)).set(u[o]):s=new i(m),u[o]=s;for(let e=l||0,t=r.length;e<t;++e)s[e]=r[e];m=Math.max(m,r.length)}this.applyRowCount(m)}else super.setColumns(n,l,G(e,{silent:!0}));t&&t.modifyColumns(this,n,l||0),this.emit({type:"afterSetColumns",columns:n,columnNames:h,detail:e,rowIndex:l})}setModifier(t,r){let s=this;return s.emit({type:"setModifier",detail:r,modifier:t,modified:s.modified}),(((s.modified=s).modifier=t)?t.modify(s):Promise.resolve(s)).then(e=>(e.emit({type:"afterSetModifier",detail:r,modifier:t,modified:e.modified}),e)).catch(e=>{throw s.emit({type:"setModifierError",error:e,modifier:t,modified:s.modified}),e})}setOriginalRowIndexes(o,e=!1){if(this.originalRowIndexes=o,!e){let s=this.localRowIndexes=[];for(let e=0,t=o.length,r;e<t;++e)f(r=o[e])&&(s[r]=e)}}setRow(e,t,r,s){this.setRows([e],t,r,s)}setRows(t,o=this.rowCount,i,e){let n=this.columns,l=Object.keys(n),r=this.modifier,a=t.length;this.emit({type:"setRows",detail:e,rowCount:a,rowIndex:o,rows:t});for(let e=0,r=o,s;e<a;++e,++r)if((s=t[e])===m.NULL)for(let t=0,e=l.length;t<e;++t){let e=n[l[t]];i?n[l[t]]=d.splice(e,r,0,!0,[null]).array:e[r]=null}else if(s instanceof Array)for(let e=0,t=l.length;e<t;++e)n[l[e]][r]=s[e];else super.setRow(s,r,void 0,{silent:!0});var s=i?a+t.length:o+a;if(s>this.rowCount){this.rowCount=s;for(let e=0,t=l.length;e<t;++e){var u=l[e];n[u]=d.setLength(n[u],s)}}r&&r.modifyRows(this,t,o),this.emit({type:"afterSetRows",detail:e,rowCount:a,rowIndex:o,rows:t})}}m.NULL={},m.version="1.0.0";let{addEvent:X,fireEvent:c,merge:q,pick:z}=n();class g{constructor(e={},r=[]){this.dataTables={},this.loaded=!1,this.metadata=e.metadata||{columns:{}};let s=0;if(0<r?.length)for(let e=0,t=r.length;e<t;++e){var o=r[e],i=o?.key;this.dataTables[i??s]=new m(o),i||s++}else this.dataTables[0]=new m(e.dataTable)}get polling(){return!!this._polling}get table(){return this.getTable()}describeColumn(e,t){let r=this.metadata.columns;r[e]=q(r[e]||{},t)}describeColumns(e){let t,r=Object.keys(e);for(;"string"==typeof(t=r.pop());)this.describeColumn(t,e[t])}emit(e){c(this,e.type,e)}getColumnOrder(e){let r=this.metadata.columns,t=Object.keys(r||{});if(t.length)return t.sort((e,t)=>z(r[e].index,0)-z(r[t].index,0))}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return c(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return X(this,e,t)}save(){return c(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))}setColumnOrder(r){for(let e=0,t=r.length;e<t;++e)this.describeColumn(r[e],{index:e})}async setModifierOptions(i,n){for(let[s,o]of Object.entries(this.dataTables)){let e=n?.find(e=>e.key===s),t=q(e?.dataModifier,i),r=t&&l.types[t.type];await o.setModifier(r?new r(t):void 0)}return this}startPolling(e=1e3){let t=this,r=t.dataTables;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,tables:r})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){this.polling&&(this?.pollingController?.abort(),window.clearTimeout(this._polling),delete this._polling)}whatIs(e){return this.metadata.columns[e]}initConverters(t,r,s){let o=0;for(var[i,n]of Object.entries(this.dataTables)){let e=r(i,n);s(e,t),n.deleteColumns(),n.setColumns(e.getTable().getColumns()),0===o&&(this.converter=e),o++}}}(o=g=g||{}).types={},o.registerType=function(e,t){return!!e&&!o.types[e]&&!!(o.types[e]=t)};let p=g,{addEvent:Q,fireEvent:W,isNumber:ee,merge:te}=n();class y{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){let t=new Date;if(!e)return NaN;let r=+e[4];return r>t.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};let t=te(y.defaultOptions,e),r=t.decimalPoint;"."!==r&&","!==r||(r="."===r?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+r+"([0-9]+)$")),this.options=t}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){return{number:this.asNumber,Date:this.asDate,string:this.asString}[this.guessType(e)].call(this,e)}asNumber(t){if("number"==typeof t)return t;if("boolean"==typeof t)return+!!t;if("string"!=typeof t)return t instanceof Date?t.getDate():t?t.getRowCount():NaN;{let e=this.decimalRegExp;if(-1<t.indexOf(" ")&&(t=t.replace(/\s+/g,"")),e){if(!e.test(t))return NaN;t=t.replace(e,"$1.$2")}return parseFloat(t)}}asString(e){return""+e}deduceDateFormat(e,t,r){let s=[],o=[],i="YYYY/mm/dd",n,l=[],a=0,u=!1,h,m;for((!t||t>e.length)&&(t=e.length);a<t;a++)if(void 0!==e[a]&&e[a]&&e[a].length)for(m=0,n=e[a].trim().replace(/[\-\.\/]/g," ").split(" "),l=["","",""];m<n.length;m++)m<l.length&&(h=parseInt(n[m],10))&&(o[m]=!o[m]||o[m]<h?h:o[m],void 0!==s[m]?s[m]!==h&&(s[m]=!1):s[m]=h,31<h?h<100?l[m]="YY":l[m]="YYYY":12<h&&h<=31?(l[m]="dd",u=!0):l[m].length||(l[m]="mm"));if(u){for(m=0;m<s.length;m++)!1!==s[m]?12<o[m]&&"YY"!==l[m]&&"YYYY"!==l[m]&&(l[m]="YY"):12<o[m]&&"mm"===l[m]&&(l[m]="dd");3===l.length&&"dd"===l[1]&&"dd"===l[2]&&(l[2]="YY"),i=l.join("/")}return r&&(this.options.dateFormat=i),i}emit(e){W(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")}getTable(){throw Error("Not implemented")}guessType(s){let o="string";if("string"==typeof s){let e=this.trim(""+s),t=this.decimalRegExp,r=this.trim(e,!0);t&&(r=t.test(r)?r.replace(t,"$1.$2"):"");var i=parseFloat(r);+r===i?s=i:o=ee(this.parseDate(s))?"Date":"string"}return o="number"==typeof s?31536e6<s?"Date":"number":o}on(e,t){return Q(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")}parseDate(e,t){let r=this.options,s=t||r.dateFormat,o=NaN,i,n,l;if(r.parseDate)o=r.parseDate(e);else{if(s)(n=this.dateFormats[s])||(n=this.dateFormats["YYYY/mm/dd"]),(l=e.match(n.regex))&&(o=n.parser(l));else for(i in this.dateFormats)if(n=this.dateFormats[i],l=e.match(n.regex)){s=i,o=n.parser(l);break}l||("object"==typeof(l=Date.parse(e))&&null!==l&&l.getTime?o=l.getTime()-6e4*l.getTimezoneOffset():ee(l)&&(o=l-6e4*new Date(l).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(o).getFullYear()&&(o=NaN)))}return o}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}y.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(i=y=y||{}).types={},i.registerType=function(e,t){return!!e&&!i.types[e]&&!!(i.types[e]=t)},i.getTableFromColumns=function(r=[],s=[]){let o=new m;for(let e=0,t=Math.max(s.length,r.length);e<t;++e)o.setColumn(s[e]||""+e,r[e]);return o};let b=y;class w{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,r){let s=this.listenerMap[e]=this.listenerMap[e]||{};return(s[t]=s[t]||[]).push(r),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(i,n,l,a){let u=i.id,e=n.state,h=this.listenerMap[u]&&this.listenerMap[u][e];if(h){let e=this.stateMap[u]=this.stateMap[u]??{},t=e[n.state]||[],r=(a&&(t.length||(e[n.state]=t),-1===w.getIndex(n,t)&&t.push(n)),{cursor:n,cursors:t,table:i}),s=(l&&(r.event=l),this.emittingRegister),o=this.buildEmittingTag(r);if(0<=s.indexOf(o))return this;try{this.emittingRegister.push(o);for(let e=0,t=h.length;e<t;++e)h[e].call(this,r)}finally{a=this.emittingRegister.indexOf(o);0<=a&&this.emittingRegister.splice(a,1)}}return this}remitCursor(e,t){let r=this.stateMap[e]&&this.stateMap[e][t.state];return r&&0<=(e=w.getIndex(t,r))&&r.splice(e,1),this}removeListener(e,t,r){let s=this.listenerMap[e]&&this.listenerMap[e][t];return s&&0<=(e=s.indexOf(r))&&s.splice(e,1),this}}function C(e,t){if("range"===e.type)return e;let r={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(r.columns=[e.column]),r}w.version="1.0.0",(e=w=w||{}).getIndex=function(s,o){if("position"===s.type){for(let e,t=0,r=o.length;t<r;++t)if("position"===(e=o[t]).type&&e.state===s.state&&e.column===s.column&&e.row===s.row)return t}else{var i=JSON.stringify(s.columns);for(let e,t=0,r=o.length;t<r;++t)if("range"===(e=o[t]).type&&e.state===s.state&&e.firstRow===s.firstRow&&e.lastRow===s.lastRow&&JSON.stringify(e.columns)===i)return t}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns)},e.isInRange=function(e,t){"position"===t.type&&(t=C(t));let r=(e="position"===e.type?C(e,t):e).columns,s=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!r||!s||r.every(e=>0<=s.indexOf(e)))},e.toPositions=function(t){if("position"===t.type)return[t];let s=t.columns||[],o=[],i=t.state;for(let r=t.firstRow,e=t.lastRow;r<e;++r)if(s.length)for(let e=0,t=s.length;e<t;++e)o.push({type:"position",column:s[e],row:r,state:i});else o.push({type:"position",row:r,state:i});return o},e.toRange=C;let re=w,se={connectors:[]};class oe{constructor(e=se){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){n().fireEvent(this,e.type,e)}getConnector(e){var t=this.connectors[e];if(t?.loaded)return Promise.resolve(t);let s=this.waiting[e];if(!s){s=this.waiting[e]=[];t=this.getConnectorOptions(e);if(!t)throw Error(`Connector '${e}' not found.`);this.loadConnector(t).then(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][0](r)}).catch(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][1](r)})}return new Promise((e,t)=>{s.push([e,t])})}getConnectorIds(){let r=this.options.connectors,s=[];for(let e=0,t=r.length;e<t;++e)s.push(r[e].id);return s}getConnectorOptions(r){var s=this.options.connectors;for(let e=0,t=s.length;e<t;++e)if(s[e].id===r)return s[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(o){return new Promise((r,e)=>{this.emit({type:"load",options:o});let t=p.types[o.type];if(!t)throw Error(`Connector type not found. (${o.type})`);let s=this.connectors[o.id]=new t(o.options,o.dataTables);s.load().then(({converter:e,dataTables:t})=>{s.dataTables=t,s.converter=e,s.loaded=!0,this.emit({type:"afterLoad",options:o}),r(s)}).catch(e)})}cancelPendingRequests(){let e=this["connectors"];for(var t of Object.keys(e))e[t].stopPolling()}on(e,t){return n().addEvent(this,e,t)}setConnectorOptions(r){let s=this.options.connectors,e=this.connectors;this.emit({type:"setConnectorOptions",options:r});for(let e=0,t=s.length;e<t;++e)if(s[e].id===r.id){s.splice(e,1);break}e[r.id]&&(e[r.id].stopPolling(),delete e[r.id]),s.push(r),this.emit({type:"afterSetConnectorOptions",options:r})}}oe.version="1.0.0";let ie=/^(?:FALSE|TRUE)/,ne=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,le=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,ae=/^([A-Z][A-Z\d\.]*)\(/,ue=/^(?:[+\-*\/^<=>]|<=|=>)/,he=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,me=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,de=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,fe=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function ce(o){let i=0;for(let e=0,t=o.length,r,s=1;e<t;++e)if("("===(r=o[e]))i||(s=e+1),++i;else if(")"===r&&!--i)return o.substring(s,e);if(0<i){let e=Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function ge(o){let i=-1;for(let e=0,t=o.length,r,s=!1;e<t;++e)if("\\"===(r=o[e]))s=!s;else if(s)s=!1;else if('"'===r){if(!(i<0))return o.substring(i+1,e);i=e}let e=Error("Incomplete string.");throw e.name="FormulaParseError",e}function pe(e,t){let i;if(i=e.match(me)){let e=""===i[2]||"["===i[2][0],t=""===i[1]||"["===i[1][0],r=""===i[4]||"["===i[4][0],s=""===i[3]||"["===i[3][0],o={type:"range",beginColumn:e?parseInt(i[2].substring(1,-1)||"0",10):parseInt(i[2],10)-1,beginRow:t?parseInt(i[1].substring(1,-1)||"0",10):parseInt(i[1],10)-1,endColumn:r?parseInt(i[4].substring(1,-1)||"0",10):parseInt(i[4],10)-1,endRow:s?parseInt(i[3].substring(1,-1)||"0",10):parseInt(i[3],10)-1};return e&&(o.beginColumnRelative=!0),t&&(o.beginRowRelative=!0),r&&(o.endColumnRelative=!0),s&&(o.endRowRelative=!0),o}if(i=e.match(he)){let e="$"!==i[1][0],t="$"!==i[2][0],r="$"!==i[3][0],s="$"!==i[4][0],o={type:"range",beginColumn:ye(e?i[1]:i[1].substring(1))-1,beginRow:parseInt(t?i[2]:i[2].substring(1),10)-1,endColumn:ye(r?i[3]:i[3].substring(1))-1,endRow:parseInt(s?i[4]:i[4].substring(1),10)-1};return e&&(o.beginColumnRelative=!0),t&&(o.beginRowRelative=!0),r&&(o.endColumnRelative=!0),s&&(o.endRowRelative=!0),o}e=R(e,t);return 1===e.length&&"string"!=typeof e[0]?e[0]:e}function R(r,s){let e=s?le:ne,o=[],i,n=("="===r[0]?r.substring(1):r).trim();for(;n;)if(i=n.match(fe)){let e=""===i[2]||"["===i[2][0],t=""===i[1]||"["===i[1][0],r={type:"reference",column:e?parseInt(i[2].substring(1,-1)||"0",10):parseInt(i[2],10)-1,row:t?parseInt(i[1].substring(1,-1)||"0",10):parseInt(i[1],10)-1};e&&(r.columnRelative=!0),t&&(r.rowRelative=!0),o.push(r),n=n.substring(i[0].length).trim()}else if(i=n.match(de)){let e="$"!==i[1][0],t="$"!==i[2][0],r={type:"reference",column:ye(e?i[1]:i[1].substring(1))-1,row:parseInt(t?i[2]:i[2].substring(1),10)-1};e&&(r.columnRelative=!0),t&&(r.rowRelative=!0),o.push(r),n=n.substring(i[0].length).trim()}else if(i=n.match(ue))o.push(i[0]),n=n.substring(i[0].length).trim();else if(i=n.match(ie))o.push("TRUE"===i[0]),n=n.substring(i[0].length).trim();else if(i=n.match(e))o.push(parseFloat(i[0])),n=n.substring(i[0].length).trim();else if('"'===n[0]){let e=ge(n);o.push(e.substring(1,-1)),n=n.substring(e.length+2).trim()}else{if(!(i=n.match(ae))){if("("===n[0]){var l=ce(n);if(l){o.push(R(l,s)),n=n.substring(l.length+2).trim();continue}}let e=r.length-n.length,t=Error("Unexpected character `"+r.substring(e,1+e)+"` at position "+(1+e)+". (`..."+r.substring(e-5,6+e)+"...`)");throw t.name="FormulaParseError",t}l=ce(n=n.substring(i[1].length).trim());o.push({type:"function",name:i[1],args:function(s,o){let i=[],n=o?";":",",l=0,a="";for(let e=0,t=s.length,r;e<t;++e){var u;(r=s[e])===n&&!l&&a?(i.push(pe(a,o)),a=""):'"'!==r||l||a?" "!==r&&(a+=r,"("===r?++l:")"===r&&--l):(u=ge(s.substring(e)),i.push(u),e+=u.length+1)}return!l&&a&&i.push(pe(a,o)),i}(l,s)}),n=n.substring(l.length+2).trim()}return o}function ye(o){let i=0;for(let e=0,t=o.length,r,s=o.length-1;e<t;++e)65<=(r=o.charCodeAt(e))&&r<=90&&(i+=(r-64)*Math.pow(26,s)),--s;return i}let be={parseFormula:R},we=["+","-","*","/","^","=","<","<=",">",">="],Ce={isFormula:function(e){return e instanceof Array},isFunction:function(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&0<=we.indexOf(e)},isRange:function(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}},{isFormula:Re,isFunction:Ne,isOperator:ve,isRange:Te,isReference:Ae,isValue:N}=Ce,Oe=/ */,xe=Number.MAX_VALUE/1.000000000001,Me=Number.MAX_VALUE/1.000000000002,Ie=Number.MAX_VALUE,Fe={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},v={},Ee=/^[A-Z][A-Z\.]*$/;function T(e){switch(typeof e){case"boolean":return e?Ie:xe;case"string":return Me;case"number":return e;default:return NaN}}function A(e){return"string"==typeof e?e.toLowerCase().replace(Oe,"\0"):e}function Pe(e){switch(typeof e){case"boolean":return+!!e;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function De(e,t,r){let s;switch(e){case"=":return A(t)===A(r);case"<":return typeof t==typeof r?A(t)<A(r):T(t)<T(r);case"<=":return typeof t==typeof r?A(t)<=A(r):T(t)<=T(r);case">":return typeof t==typeof r?A(t)>A(r):T(t)>T(r);case">=":return typeof t==typeof r?A(t)>=A(r):T(t)>=T(r)}switch(t=Pe(t),r=Pe(r),e){case"+":s=t+r;break;case"-":s=t-r;break;case"*":s=t*r;break;case"/":s=t/r;break;case"^":s=Math.pow(t,r);break;default:return NaN}return s%1?Math.round(1e9*s)/1e9:s}function je(e,t){return N(e)?e:Te(e)?t&&Le(e,t)||[]:Ne(e)?ke(e,t):O(Re(e)?e:[e],t)}function Le(o,i){let n=i.getColumnNames().slice(o.beginColumn,o.endColumn+1),l=[];for(let r=0,e=n.length,s;r<e;++r){var a=i.getColumn(n[r],!0)||[];for(let e=o.beginRow,t=o.endRow+1;e<t;++e)"string"==typeof(s=a[e])&&"="===s[0]&&i!==i.modified&&(s=i.modified.getCell(n[r],e)),l.push(N(s)?s:NaN)}return l}function Se(e,t){var r,s=t.getColumnNames()[e.column];return s?"string"==typeof(r=t.getCell(s,e.row))&&"="===r[0]&&t!==t.modified?(t=t.modified.getCell(s,e.row),N(t)?t:NaN):N(r)?r:NaN:NaN}function O(n,l){let a;for(let e=0,t=n.length,r,s,o,i;e<t;++e)if(ve(r=n[e]))s=r;else if(N(r)?i=r:Re(r)?i=O(n,l):Ne(r)?i=N(o=ke(r,l))?o:NaN:Ae(r)&&(i=l&&Se(r,l)),void 0!==i){if(void 0===a)a=s?De(s,0,i):i;else{if(!s)return NaN;var u=n[e+1];ve(u)&&Fe[u]>Fe[s]&&(i=De(u,i,O(n.slice(e+2))),e=t),a=De(s,a,i)}s=void 0,i=void 0}return N(a)?a:NaN}function ke(e,t){let r=v[e.name];if(r)try{return r(e.args,t)}catch{return NaN}let s=Error(`Function "${e.name}" not found.`);throw s.name="FormulaProcessError",s}let x={asNumber:Pe,getArgumentValue:je,getArgumentsValues:function(r,s){let o=[];for(let e=0,t=r.length;e<t;++e)o.push(je(r[e],s));return o},getRangeValues:Le,getReferenceValue:Se,processFormula:O,processorFunctions:v,registerProcessorFunction:function(e,t){return Ee.test(e)&&!v[e]&&!!(v[e]=t)},translateReferences:function s(o,i=0,n=0){for(let e=0,t=o.length,r;e<t;++e)(r=o[e])instanceof Array?s(r,i,n):Ne(r)?s(r.args,i,n):Te(r)?(r.beginColumnRelative&&(r.beginColumn+=i),r.beginRowRelative&&(r.beginRow+=n),r.endColumnRelative&&(r.endColumn+=i),r.endRowRelative&&(r.endRow+=n)):Ae(r)&&(r.columnRelative&&(r.column+=i),r.rowRelative&&(r.row+=n));return o}},Ye=x["getArgumentValue"],Ve=(x.registerProcessorFunction("ABS",function(e,t){var o=Ye(e[0],t);switch(typeof o){case"number":return Math.abs(o);case"object":{let s=[];for(let e=0,t=o.length,r;e<t;++e){if("number"!=typeof(r=o[e]))return NaN;s.push(Math.abs(r))}return s}default:return NaN}}),x)["getArgumentValue"],Ue=(x.registerProcessorFunction("AND",function s(o,i){for(let e=0,t=o.length,r;e<t;++e)if(!(r=Ve(o[e],i))||"object"==typeof r&&!s(r,i))return!1;return!0}),x)["getArgumentsValues"],$e=(x.registerProcessorFunction("AVERAGE",function(e,t){let r=Ue(e,t),o=0,i=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(++o,i+=s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(++o,i+=r)}return o?i/o:0}),x)["getArgumentValue"],He=(x.registerProcessorFunction("AVERAGEA",function(r,o){let i=0,n=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=$e(r[e],o))){case"boolean":++i,n+=+!!s;continue;case"number":isNaN(s)||(++i,n+=s);continue;case"string":++i;continue;default:for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"boolean":++i,n+=+!!r;continue;case"number":isNaN(r)||(++i,n+=r);continue;case"string":++i;continue}continue}return i?n/i:0}),x.registerProcessorFunction("COUNT",function s(e,o){let i=x.getArgumentsValues(e,o),n=0;for(let e=0,t=i.length,r;e<t;++e)switch(typeof(r=i[e])){case"number":isNaN(r)||++n;break;case"object":n+=s(r,o)}return n}),x.registerProcessorFunction("COUNTA",function s(e,o){let i=x.getArgumentsValues(e,o),n=0;for(let e=0,t=i.length,r;e<t;++e){switch(typeof(r=i[e])){case"number":if(isNaN(r))continue;break;case"object":n+=s(r,o);continue;case"string":if(!r)continue}++n}return n}),x)["getArgumentValue"],_e=(x.registerProcessorFunction("IF",function(e,t){return He(e[0],t)?He(e[1],t):He(e[2],t)}),x)["getArgumentValue"],Be=(x.registerProcessorFunction("ISNA",function(e,t){e=_e(e[0],t);return"number"!=typeof e||isNaN(e)}),x)["getArgumentsValues"],Ge=(x.registerProcessorFunction("MAX",function s(e,t){let o=Be(e,t),i=Number.NEGATIVE_INFINITY;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":r>i&&(i=r);break;case"object":(r=s(r))>i&&(i=r)}return isFinite(i)?i:0}),x.registerProcessorFunction("MEDIAN",function(e,t){let o=[],r=x.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||o.push(s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||o.push(r)}e=o.length;if(!e)return NaN;t=Math.floor(e/2);return e%2?o[t]:(o[t-1]+o[t])/2}),x)["getArgumentsValues"],Ke=(x.registerProcessorFunction("MIN",function s(e,t){let o=Ge(e,t),i=Number.POSITIVE_INFINITY;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":r<i&&(i=r);break;case"object":(r=s(r))<i&&(i=r)}return isFinite(i)?i:0}),x)["getArgumentValue"];function Ze(e,t){let o={},r=x.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(o[s]=(o[s]||0)+1);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(o[r]=(o[r]||0)+1)}return o}function Je(e,t){var i=Ze(e,t),n=Object.keys(i);if(!n.length)return NaN;let l=parseFloat(n[0]),a=i[n[0]];for(let e=1,t=n.length,r,s,o;e<t;++e)a<(o=i[r=n[e]])?(l=parseFloat(r),a=o):a===o&&l>(s=parseFloat(r))&&(l=s,a=o);return 1<a?l:NaN}x.registerProcessorFunction("MOD",function(e,t){let r=Ke(e[0],t),s=Ke(e[1],t);return"object"==typeof r&&(r=r[0]),"object"==typeof s&&(s=s[0]),"number"!=typeof r||"number"!=typeof s||0===s?NaN:r%s}),x.registerProcessorFunction("MODE",Je),x.registerProcessorFunction("MODE.MULT",function(e,t){var o=Ze(e,t),i=Object.keys(o);if(!i.length)return NaN;let n=[parseFloat(i[0])],l=o[i[0]];for(let e=1,t=i.length,r,s;e<t;++e)l<(s=o[r=i[e]])?(n=[parseFloat(r)],l=s):l===s&&n.push(parseFloat(r));return 1<l?n:NaN}),x.registerProcessorFunction("MODE.SNGL",Je);let Xe=x["getArgumentValue"],qe=(x.registerProcessorFunction("NOT",function(e,t){let r=Xe(e[0],t);switch(typeof(r="object"==typeof r?r[0]:r)){case"boolean":case"number":return!r}return NaN}),x)["getArgumentValue"],ze=(x.registerProcessorFunction("OR",function s(o,i){for(let e=0,t=o.length,r;e<t;++e)if("object"==typeof(r=qe(o[e],i))){if(s(r,i))return!0}else if(r)return!0;return!1}),x)["getArgumentsValues"],Qe=(x.registerProcessorFunction("PRODUCT",function s(e,o){let i=ze(e,o),n=1,l=!1;for(let e=0,t=i.length,r;e<t;++e)switch(typeof(r=i[e])){case"number":isNaN(r)||(l=!0,n*=r);break;case"object":l=!0,n*=s(r,o)}return l?n:0}),x.registerProcessorFunction("SUM",function s(e,o){let i=x.getArgumentsValues(e,o),n=0;for(let e=0,t=i.length,r;e<t;++e)switch(typeof(r=i[e])){case"number":isNaN(r)||(n+=r);break;case"object":n+=s(r,o)}return n}),x)["getArgumentValue"],We=(x.registerProcessorFunction("XOR",function(r,i){for(let e=0,t=r.length,s,o;e<t;++e)switch(typeof(o=Qe(r[e],i))){case"boolean":case"number":if(void 0===s)s=!!o;else if(!!o!==s)return!0;break;case"object":for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"boolean":case"number":if(void 0===s)s=!!r;else if(!!r!==s)return!0}}return!1}),{...be,...x,...Ce}),et=n()["merge"];class M extends b{constructor(e){e=et(M.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(n,e=this.options){let{useLocalDecimalPoint:t,lineDelimiter:r}=e,s=!1!==this.options.firstRowAsNames,{decimalPoint:l,itemDelimiter:a}=e,u=(l=l||(","!==a&&t?1.1.toLocaleString()[1]:"."),a=a||(","===l?";":","),n.getSortedColumns(e.usePresentationOrder)),h=Object.keys(u),m=[],d=h.length,f=[];s&&m.push(h.map(e=>`"${e}"`).join(a));for(let i=0;i<d;i++){let r,e=h[i],s=u[e],o=s.length,t=n.whatIs(e);t&&(r=t.dataType);for(let t=0;t<o;t++){let e=s[t];if(f[t]||(f[t]=[]),"string"===r?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",l):"string"==typeof e&&(e=`"${e}"`),f[t][i]=e,i===d-1){let e=i;for(;2<f[t].length&&void 0===f[t][e];)f[t].pop(),e--;m.push(f[t].join(a))}}}return m.join(r)}parse(e,t){let r=this.dataTypes,s=et(this.options,e),{beforeParse:o,lineDelimiter:i,firstRowAsNames:n,itemDelimiter:l}=s,a,u=0,{csv:h,startRow:m,endRow:d}=s,f;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),h=h&&o?o(h):h){if(a=h.replace(/\r\n|\r/g,"\n").split(i||"\n"),(!m||m<0)&&(m=0),(!d||d>=a.length)&&(d=a.length-1),l||(this.guessedItemDelimiter=this.guessDelimiter(a)),n){let t=a[0].split(l||this.guessedItemDelimiter||",");for(let e=0;e<t.length;e++)t[e]=t[e].trim().replace(/^["']|["']$/g,"");this.headers=t,m++}let e=0;for(u=m;u<=d;u++)"#"===a[u][0]?e++:this.parseCSVRow(a[u],u-m-e);r.length&&r[0].length&&"date"===r[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(let r=0,e=this.columns.length;r<e;++r)for(let t=0,e=(f=this.columns[r]).length;t<e;++t)if(f[t]&&"string"==typeof f[t]){let e=this.asGuessedType(f[t]);e instanceof Date&&(e=e.getTime()),this.columns[r][t]=e}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}parseCSVRow(t,r){let s=this,o=s.columns||[],i=s.dataTypes,{startColumn:n,endColumn:l}=s.options,e=s.options.itemDelimiter||s.guessedItemDelimiter,a=s.options["decimalPoint"],u=(a&&a!==e||(a=s.guessedDecimalPoint||"."),0),h="",m="",d=0,f=0,c=e=>{h=t[e]},g=e=>{i.length<f+1&&i.push([e]),i[f][i[f].length-1]!==e&&i[f].push(e)},p=()=>{if(n>d||d>l)return++d,void(m="");var e;"string"==typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),g("number")):isNaN(Date.parse(m))?g("string"):(m=m.replace(/\//g,"-"),g("date")):g("number"),o.length<f+1&&o.push([]),"number"!=typeof m&&"number"!==s.guessType(m)&&a&&(m=(e=m).replace(a,"."),"number"!==s.guessType(m)&&(m=e)),o[f][r]=m,m="",++f,++d};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(c(u),"#"===h&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(u)))return void p();if('"'===h)for(c(++u);u<t.length&&'"'!==h;)m+=h,c(++u);else h===e?p():m+=h}p()}}guessDelimiter(n){let l=0,a=0,e,u={",":0,";":0,"\t":0},t=n.length;for(let e=0;e<t;e++){let t=!1,r,s,o,i="";if(13<e)break;var h=n[e];for(let e=0;e<h.length&&(r=h[e],s=h[e+1],o=h[e-1],"#"!==r);e++){if('"'===r)if(t){if('"'!==o&&'"'!==s){for(;" "===s&&e<h.length;)s=h[++e];void 0!==u[s]&&u[s]++,t=!1}}else t=!0;else void 0!==u[r]?(isNaN(Date.parse(i=i.trim()))&&!isNaN(Number(i))&&isFinite(Number(i))||u[r]++,i=""):i+=r;","===r&&a++,"."===r&&l++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),l>a?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return b.getTableFromColumns(this.columns,this.headers)}}M.defaultOptions={...b.defaultOptions,lineDelimiter:"\n"},b.registerType("CSV",M);let{merge:tt,defined:rt}=n();class st extends p{constructor(e,t){e=tt(st.defaultOptions,e);super(e,t),this.options=rt(t)?tt(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){let r=this,s=r.dataTables,{csv:e,csvURL:o,dataModifier:i,dataTables:n}=r.options;return r.emit({type:"load",csv:e,detail:t,tables:s}),Promise.resolve(o?fetch(o,{signal:r?.pollingController?.signal}).then(e=>e.text()):e||"").then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=n?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new M(tt(this.options,r))},(e,t)=>{e.parse({csv:t})}),r.setModifierOptions(i,n).then(()=>e))).then(e=>(r.emit({type:"afterLoad",csv:e,detail:t,tables:s}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e})}}st.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},p.registerType("CSV",st);let{error:ot,isArray:it,merge:nt,objectEach:lt}=n();class I extends b{constructor(e){e=nt(I.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.options=e,this.table=new m}parse(e,t){let{beforeParse:r,orientation:s,firstRowAsNames:o,columnNames:i}=e=nt(this.options,e),n=e.data;if(n){if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers}),n=(n=r?r(n):n).slice(),"columns"===s)for(let t=0,e=n.length;t<e;t++){let e=n[t];if(!(e instanceof Array))return;this.headers instanceof Array?(o?this.headers.push(""+e.shift()):i&&i instanceof Array&&this.headers.push(i[t]),this.table.setColumn(this.headers[t]||t.toString(),e)):ot("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===s){o?this.headers=n.shift():i&&(this.headers=i);for(let e=0,t=n.length;e<t;e++){let s=n[e];if(it(s))for(let e=0,t=s.length;e<t;e++)this.columns.length<e+1&&this.columns.push([]),this.columns[e].push(s[e]),this.headers instanceof Array?this.table.setColumn(this.headers[e]||e.toString(),this.columns[e]):ot("JSONConverter: Invalid `columnNames` option.",!1);else{var l=this.headers;if(l&&!(l instanceof Array)){let r={};lt(l,(e,t)=>{r[t]=e.reduce((e,t)=>e[t],s)}),s=r}this.table.setRows([s],e)}}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.headers})}}getTable(){return this.table}}I.defaultOptions={...b.defaultOptions,data:[],orientation:"rows"},b.registerType("JSON",I);let{merge:at,defined:ut}=n();class ht extends p{constructor(e,t){e=at(ht.defaultOptions,e);super(e,t),this.options=ut(t)?at(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){let r=this,s=r.dataTables,{data:e,dataUrl:o,dataModifier:i,dataTables:n}=r.options;return r.emit({type:"load",data:e,detail:t,tables:s}),Promise.resolve(o?fetch(o,{signal:r?.pollingController?.signal}).then(e=>e.json()).catch(e=>{r.emit({type:"loadError",detail:t,error:e,tables:s}),console.warn(`Unable to fetch data from ${o}.`)}):e||[]).then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=n?.find(e=>e.key===t),r={dataTableKey:t,columnNames:r?.columnNames??e.columnNames,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,orientation:r?.orientation??e.orientation,beforeParse:r?.beforeParse??e.beforeParse};return new I(at(this.options,r))},(e,t)=>{e.parse({data:t})}),r.setModifierOptions(i,n).then(()=>e))).then(e=>(r.emit({type:"afterLoad",data:e,detail:t,tables:s}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e})}}ht.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},p.registerType("JSON",ht);let{merge:mt,uniqueKey:dt}=n();class F extends b{constructor(e){e=mt(F.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){let s,o=mt(this.options,e),i=(o.json?.values||[]).map(e=>e.slice());if(0===i.length)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:t,headers:this.header});let{beforeParse:r,json:n}=o;r&&n&&(i=r(n.values));for(let r=0,e=(this.columns=i).length;r<e;r++){s=i[r],this.header[r]=o.firstRowAsNames?""+s.shift():dt();for(let t=0,e=s.length;t<e;++t)if(s[t]&&"string"==typeof s[t]){let e=this.asGuessedType(s[t]);e instanceof Date&&(e=e.getTime()),this.columns[r][t]=e}}this.emit({type:"afterParse",columns:this.columns,detail:t,headers:this.header})}getTable(){return b.getTableFromColumns(this.columns,this.header)}}F.defaultOptions={...b.defaultOptions},b.registerType("GoogleSheets",F);let{merge:ft,pick:ct,defined:gt}=n();class E extends p{constructor(e,t){e=ft(E.defaultOptions,e);super(e,t),this.options=gt(t)?ft(e,{dataTables:t}):e}load(t){let r=this,s=r.dataTables,{dataModifier:o,dataRefreshRate:e,enablePolling:i,googleAPIKey:n,googleSpreadsheetKey:l,dataTables:a}=r.options,u=E.buildFetchURL(n,l,r.options);if(r.emit({type:"load",detail:t,tables:s,url:u}),URL.canParse(u))return fetch(u,{signal:r?.pollingController?.signal}).then(e=>e.json()).then(e=>{if("object"==typeof e&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status)throw Error(e.error.message);return this.initConverters(e,t=>{var e=this.options,r=a?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new F(ft(this.options,r))},(e,t)=>{e.parse({json:t})}),r.setModifierOptions(o,a)}).then(()=>(r.emit({type:"afterLoad",detail:t,tables:s,url:u}),i&&setTimeout(()=>r.load(),1e3*Math.max(e||0,1)),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e});throw Error("Invalid URL: "+u)}}E.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};{var P=E=E||{};let i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function pt(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:r,startColumn:s,startRow:o}=e;return r||(i[s||0]||"A")+(Math.max(o||0,0)+1)+":"+(i[ct(e,25)]||"Z")+(t?Math.max(t,0):"Z")}P.buildFetchURL=function(e,t,r={}){let s=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`),o=r.onlyColumnNames?"A1:Z1":pt(r),i=(s.pathname+=o,s.searchParams);return i.set("alt","json"),r.onlyColumnNames||(i.set("dateTimeRenderOption","FORMATTED_STRING"),i.set("majorDimension","COLUMNS"),i.set("valueRenderOption","UNFORMATTED_VALUE")),i.set("prettyPrint","false"),i.set("key",e),s.href},P.buildQueryRange=pt}p.registerType("GoogleSheets",E);let yt=n()["merge"];class D extends b{constructor(e){e=yt(D.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,r=this.options){let t=!1!==r.firstRowAsNames,s=r.useMultiLevelHeaders,o=e.getSortedColumns(r.usePresentationOrder),i=Object.keys(o),n=[],l=i.length,a=[],u="";if(t){let t=[];if(s){for(var h of i){let e=o[h];var m=((e=Array.isArray(e)?e:Array.from(e)).shift()||"").toString();o[h]=e,t.push(m)}u=this.getTableHeaderHTML(i,t,r)}else u=this.getTableHeaderHTML(void 0,i,r)}for(let r=0;r<l;r++){var d=o[i[r]],f=d.length;for(let t=0;t<f;t++){let e=d[t];a[t]||(a[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),a[t][r]=this.getCellHTMLFromValue(r?"td":"th",null,r?"":'scope="row"',e),r===l-1&&n.push("<tr>"+a[t].join("")+"</tr>")}}let c="";return"<table>"+(c=r.tableCaption?'<caption class="highcharts-table-caption">'+r.tableCaption+"</caption>":c)+u+"<tbody>"+n.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,r,s,o){let i=s,n="text"+(t?" "+t:"");return"number"==typeof i?(i=i.toString(),","===o&&(i=i.replace(".",o)),n="number"):s||(i="",n="empty"),"<"+e+(r?" "+r:"")+' class="'+n+'">'+i+"</"+e+">"}getTableHeaderHTML(e=[],t=[],r=this.options){let{useMultiLevelHeaders:s,useRowspanHeaders:o}=r,i="<thead>",n=0,l=t&&t.length,a,u=0,h;if(s&&e&&t&&!function(e,t){let r=e.length;if(t.length===r){for(;--r;)if(e[r]!==t[r])return;return 1}}(e,t)){for(i+="<tr>";n<l;++n)(a=e[n])===e[n+1]?++u:u?(i+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(u+1)+'"',a),u=0):(a===t[n]?o?(h=2,delete t[n]):(h=1,t[n]=""):h=1,i+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<h?' valign="top" rowspan="'+h+'"':""),a));i+="</tr>"}if(t){for(i+="<tr>",n=0,l=t.length;n<l;++n)void 0!==t[n]&&(i+=this.getCellHTMLFromValue("th",null,'scope="col"',t[n]));i+="</tr>"}return i+"</thead>"}parse(e,t){let a=[],s=[],o=yt(this.options,e),{endRow:u,startColumn:h,endColumn:m,firstRowAsNames:d}=o,f=o.tableElement||this.tableElement;if(f instanceof HTMLElement){this.tableElement=f,this.tableElementID=f.id,this.emit({type:"parse",columns:this.columns,detail:t,headers:this.headers});let r=f.getElementsByTagName("tr"),e=r.length,i=0,n,l=o["startRow"];if(d&&e){var c=r[0].children,g=c.length;for(let e=h;e<g&&!(e>m);e++)"TD"!==(n=c[e]).tagName&&"TH"!==n.tagName||s.push(n.innerHTML);l++}for(;i<e;){if(i>=l&&i<=u){let e=r[i].children,t=e.length,o=0;for(;o<t;){let r=o-h,s=a[r];if(("TD"===(n=e[o]).tagName||"TH"===n.tagName)&&o>=h&&o<=m){a[r]||(a[r]=[]);let e=this.asGuessedType(n.innerHTML),t=(e instanceof Date&&(e=e.getTime()),a[r][i-l]=e,1);for(;i-l>=t&&void 0===s[i-l-t];)s[i-l-t]=null,t++}o++}}i++}this.columns=a,this.headers=s,this.emit({type:"afterParse",columns:a,detail:t,headers:s})}else this.emit({type:"parseError",columns:a,detail:t,headers:s,error:"Not a valid HTML Table"})}getTable(){return b.getTableFromColumns(this.columns,this.headers)}}D.defaultOptions={...b.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},b.registerType("HTMLTable",D);let bt=n()["win"],wt=n()["merge"];class Ct extends p{constructor(e){e=wt(Ct.defaultOptions,e);super(e),this.converter=new D(e),this.options=e}load(e){let t,r=this,s=r.converter,o=r.table,{dataModifier:i,table:n}=r.options;var l;return r.emit({type:"load",detail:e,tables:{table:o},tableElement:r.tableElement}),"string"==typeof n?(r.tableID=n,t=bt.document.getElementById(n)):r.tableID=(t=n).id,r.tableElement=t||void 0,r.tableElement?(s.parse(wt({tableElement:r.tableElement},r.options),e),o.deleteColumns(),o.setColumns(s.getTable().getColumns()),r.setModifierOptions(i).then(()=>(r.emit({type:"afterLoad",detail:e,tables:{table:o},tableElement:r.tableElement}),r))):(r.emit({type:"loadError",detail:e,error:l="HTML table not provided, or element with ID not found",tables:{table:o}}),Promise.reject(Error(l)))}}Ct.defaultOptions={table:""},p.registerType("HTMLTable",Ct);let Rt=n()["merge"];class Nt extends l{constructor(e,...o){super(),this.chain=o,this.options=Rt(Nt.defaultOptions,e);var i=this.options.chain||[];for(let e=0,t=i.length,r,s;e<t;++e)(r=i[e]).type&&(s=l.types[r.type])&&o.push(new s(r))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}async modify(r,s){let o=this.options.reverse?this.chain.slice().reverse():this.chain.slice(),i=(r.modified===r&&(r.modified=r.clone(!1,s)),r);for(let e=0,t=o.length;e<t;++e){try{await o[e].modify(i,s)}catch(o){throw this.emit({type:"error",detail:s,table:r}),o}i=i.modified}return r.modified=i,r}modifyCell(e,s,o,i,n){let l=this.options.reverse?this.chain.reverse():this.chain;if(l.length){let r=e.clone();for(let e=0,t=l.length;e<t;++e)l[e].modifyCell(r,s,o,i,n),r=r.modified;e.modified=r}return e}modifyColumns(e,s,o,i){let n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){let r=e.clone();for(let e=0,t=n.length;e<t;++e)n[e].modifyColumns(r,s,o,i),r=r.modified;e.modified=r}return e}modifyRows(e,s,o,i){let n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){let r=e.clone();for(let e=0,t=n.length;e<t;++e)n[e].modifyRows(r,s,o,i),r=r.modified;e.modified=r}return e}modifyTable(e,r){this.emit({type:"modify",detail:r,table:e});let s=this.options.reverse?this.chain.reverse():this.chain.slice(),o=e.modified;for(let e=0,t=s.length;e<t;++e)o=s[e].modifyTable(o,r).modified;return e.modified=o,this.emit({type:"afterModify",detail:r,table:e}),e}remove(e,t){let r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),r.splice(r.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}Nt.defaultOptions={type:"Chain"},l.registerType("Chain",Nt);let vt=n()["merge"];class Tt extends l{constructor(e){super(),this.options=vt(Tt.defaultOptions,e)}modifyCell(e,t,r,s,o){let i=e.modified,n=i.getRowIndexBy("columnNames",t);return void 0===n?i.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,o):i.setCell(""+r,n,s,o),e}modifyColumns(e,i,n,l){let a=e.modified,r=a.getColumn("columnNames")||[],u=e.getColumnNames(),s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=u.length;e<t;++e)if(u[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,l);for(let e=0,t=(u=Object.keys(i)).length,s,r,o;e<t;++e){s=i[r=u[e]],o=a.getRowIndexBy("columnNames",r)||a.getRowCount();for(let e=0,t=n,r=s.length;e<r;++e,++t)a.setCell(""+t,o,s[e],l)}return e}modifyRows(e,o,i,n){let l=e.getColumnNames(),a=e.modified,r=a.getColumn("columnNames")||[],s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=l.length;e<t;++e)if(l[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,n);for(let e=0,r=i,t=o.length,s;e<t;++e,++r)if((s=o[e])instanceof Array)a.setColumn(""+r,s);else for(let e=0,t=l.length;e<t;++e)a.setCell(""+r,e,s[l[e]],n);return e}modifyTable(i,e){this.emit({type:"modify",detail:e,table:i});let t=i.modified;if(i.hasColumns(["columnNames"])){let r=(i.deleteColumns(["columnNames"])||{}).columnNames||[],s={},o=[];for(let e=0,t=r.length;e<t;++e)o.push(""+r[e]);for(let e=0,t=i.getRowCount(),r;e<t;++e)(r=i.getRow(e))&&(s[o[e]]=r);t.deleteColumns(),t.setColumns(s)}else{let s={};for(let e=0,t=i.getRowCount(),r;e<t;++e)(r=i.getRow(e))&&(s[""+e]=r);s.columnNames=i.getColumnNames(),t.deleteColumns(),t.setColumns(s)}return this.emit({type:"afterModify",detail:e,table:i}),i}}Tt.defaultOptions={type:"Invert"},l.registerType("Invert",Tt);class At extends l{constructor(e){super(),this.options={...At.defaultOptions,...e}}modifyTable(o,e){this.emit({type:"modify",detail:e,table:o});let i=this.options.alternativeSeparators,s=this.options.formulaColumns||o.getColumnNames(),n=o.modified;for(let e=0,t=s.length,r;e<t;++e)r=s[e],0<=s.indexOf(r)&&n.setColumn(r,this.processColumn(o,r));var l=this.options.columnFormulas||[];for(let e=0,t=l.length,r,s;e<t;++e)r=l[e],s=be.parseFormula(r.formula,i),n.setColumn(r.column,this.processColumnFormula(s,o,r.rowStart,r.rowEnd));return this.emit({type:"afterModify",detail:e,table:o}),o}processColumn(o,e,t=0){let i=this.options.alternativeSeparators,n=(o.getColumn(e,!0)||[]).slice(0<t?t:0);for(let e=0,t=n.length,r=[],s;e<t;++e)if("string"==typeof(s=n[e])&&"="===s[0])try{r=""===s?r:be.parseFormula(s.substring(1),i),n[e]=x.processFormula(r,o)}catch{n[e]=NaN}return n}processColumnFormula(r,e,s=0,o=e.getRowCount()){s=0<=s?s:0,o=0<=o?o:e.getRowCount()+o;let i=[],n=e.modified;for(let e=0,t=o-s;e<t;++e)try{i[e]=x.processFormula(r,n)}catch{i[e]=NaN}finally{r=x.translateReferences(r,0,1)}return i}}At.defaultOptions={type:"Math",alternativeSeparators:!1},l.registerType("Math",At);let Ot=n()["merge"];class xt extends l{constructor(e){super(),this.options=Ot(xt.defaultOptions,e)}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let l=[],{additive:a,ranges:u,strict:h}=this.options;if(u.length){let o=e.modified,i=e.getColumns(),n=[];for(let e=0,t=u.length,r,s;e<t;++e)if(r=u[e],!h||typeof r.minValue==typeof r.maxValue){0<e&&!a&&(o.deleteRows(),o.setRows(n),o.setOriginalRowIndexes(l,!0),i=o.getColumns(),n=[],l=[]);for(let e=0,t=(s=i[r.column]||[]).length;e<t;++e)switch(typeof s[e]){default:continue;case"boolean":case"number":case"string":}}o.deleteRows(),o.setRows(n),o.setOriginalRowIndexes(l)}return this.emit({type:"afterModify",detail:t,table:e}),e}}xt.defaultOptions={type:"Range",ranges:[]},l.registerType("Range",xt);let Mt=n()["merge"];class j extends l{static ascending(e,t){return(e||0)<(t||0)?-1:+((t||0)<(e||0))}static descending(e,t){return(t||0)<(e||0)?-1:+((e||0)<(t||0))}constructor(e){super(),this.options=Mt(j.defaultOptions,e)}getRowReferences(e){let r=e.getRows(),s=[];for(let e=0,t=r.length;e<t;++e)s.push({index:e,row:r[e]});return s}modifyCell(e,t,r,s,o){var{orderByColumn:i,orderInColumn:n}=this.options;return t===i&&(n?(e.modified.setCell(t,r,s),e.modified.setColumn(n,this.modifyTable(new m({columns:e.getColumns([i,n])})).modified.getColumn(n))):this.modifyTable(e,o)),e}modifyColumns(e,t,r,s){let{orderByColumn:o,orderInColumn:i}=this.options,n=Object.keys(t);return-1<n.indexOf(o)&&(i&&t[n[0]].length?(e.modified.setColumns(t,r),e.modified.setColumn(i,this.modifyTable(new m({columns:e.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(e,s)),e}modifyRows(e,t,r,s){var{orderByColumn:o,orderInColumn:i}=this.options;return i&&t.length?(e.modified.setRows(t,r),e.modified.setColumn(i,this.modifyTable(new m({columns:e.getColumns([o,i])})).modified.getColumn(i))):this.modifyTable(e,s),e}modifyTable(e,t){this.emit({type:"modify",detail:t,table:e});let r=e.getColumnNames(),o=e.getRowCount(),i=this.getRowReferences(e),{direction:s,orderByColumn:n,orderInColumn:l}=this.options,a="asc"===s?j.ascending:j.descending,u=r.indexOf(n),h=e.modified;if(-1!==u&&i.sort((e,t)=>a(e.row[u],t.row[u])),l){let t=[];for(let e=0;e<o;++e)t[i[e].index]=e;h.setColumns({[l]:t})}else{let t,r=[],s=[];for(let e=0;e<o;++e)t=i[e],r.push(h.getOriginalRowIndex(t.index)),s.push(t.row);h.setRows(s,0),h.setOriginalRowIndexes(r)}return this.emit({type:"afterModify",detail:t,table:e}),e}}j.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},l.registerType("Sort",j);let L=n(),It=(L.DataConnector=L.DataConnector||p,L.DataConverter=L.DataConverter||b,L.DataCursor=L.DataCursor||re,L.DataModifier=L.DataModifier||l,L.DataPool=L.DataPool||oe,L.DataTable=L.DataTable||m,L.Formula=L.Formula||We,n());return Y.default})());
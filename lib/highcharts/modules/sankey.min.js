!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(t._Highcharts,t._Highcharts.SeriesRegistry,t._Highcharts.Point,t._Highcharts.Color,t._Highcharts.SVGElement):"function"==typeof define&&define.amd?define("highcharts/modules/sankey",["highcharts/highcharts"],function(t){return e(t,t.SeriesRegistry,t.Point,t.Color,t.SVGElement)}):"object"==typeof exports?exports["highcharts/modules/sankey"]=e(t._Highcharts,t._Highcharts.SeriesRegistry,t._Highcharts.Point,t._Highcharts.Color,t._Highcharts.SVGElement):t.Highcharts=e(t.Highcharts,t.Highcharts.SeriesRegistry,t.Highcharts.Point,t.Highcharts.Color,t.Highcharts.SVGElement)}("undefined"==typeof window?this:window,(rt,at,lt,ht,dt)=>(()=>{"use strict";var o={28:t=>{t.exports=dt},260:t=>{t.exports=lt},512:t=>{t.exports=at},620:t=>{t.exports=ht},944:t=>{t.exports=rt}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;e=i[t]={exports:{}};return o[t](e,e.exports,s),e.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var o in e)s.o(e,o)&&!s.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var t={},e=(s.d(t,{default:()=>nt}),s(944)),e=s.n(e),n=s(512),n=s.n(n);let{prototype:r,prototype:{pointClass:{prototype:l}}}=n()["series"],{defined:a,extend:z,find:D,merge:A,pick:h}=e();function d(){return this.data=[].concat(this.points||[],this.nodes),r.destroy.apply(this,arguments)}function E(){this.nodes&&(this.nodes.forEach(t=>{t.destroy()}),this.nodes.length=0),r.setData.apply(this,arguments)}function p(t){let e=arguments,o=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==t&&o.forEach(t=>{t&&t.series&&(l.setState.apply(t,e),t.isNode||(t.fromNode.graphic&&l.setState.apply(t.fromNode,e),t.toNode&&t.toNode.graphic&&l.setState.apply(t.toNode,e)))}),l.setState.apply(this,e)}function c(t,e,o,i){let s=this.series.options.nodes,n=this.series.options.data,r=n?.length||0,a=n?.[this.index];l.update.call(this,t,!this.isNode&&e,o,i),this.isNode&&(t=(s||[]).reduce((t,e,o)=>this.id===e.id?o:t,-1),i=A(s&&s[t]||{},n?.[this.index]||{}),n&&(a?n[this.index]=a:n.length=r),s?0<=t?s[t]=i:s.push(i):this.series.options.nodes=[i],h(e,!0)&&this.series.chart.redraw(o))}(f=x=x||{}).compose=function(t,e){let o=t.prototype,i=e.prototype;return o.setNodeState=p,o.setState=p,o.update=c,i.destroy=d,i.setData=E,e},f.createNode=function(t){let e=this.pointClass,o=(t,e)=>D(t,t=>t.id===e),i=o(this.nodes,t),n;if(!i){n=this.options.nodes&&o(this.options.nodes,t);let s=new e(this,z({className:"highcharts-node",isNode:!0,id:t,y:1},n));s.linksTo=[],s.linksFrom=[],s.getSum=function(){let e=0,o=0;return s.linksTo.forEach(t=>{e+=t.weight||0}),s.linksFrom.forEach(t=>{o+=t.weight||0}),Math.max(e,o)},s.offset=function(e,o){let i=0;for(let t=0;t<s[o].length;t++){if(s[o][t]===e)return i;i+=s[o][t].weight}},s.hasShape=function(){let e=0;return s.linksTo.forEach(t=>{t.outgoing&&e++}),!s.linksTo.length||e!==s.linksTo.length},s.index=this.nodes.push(s)-1,i=s}return i.formatPrefix="node",i.name=i.name||i.options.id||"",i.mass=h(i.options.mass,i.options.marker&&i.options.marker.radius,this.options.marker&&this.options.marker.radius,4),i},f.destroy=d,f.generatePoints=function(){let e=this.chart,o={};r.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(t=>{t.linksFrom.length=0,t.linksTo.length=0,t.level=t.options.level}),this.points.forEach(t=>{a(t.from)&&(o[t.from]||(o[t.from]=this.createNode(t.from)),o[t.from].linksFrom.push(t),t.fromNode=o[t.from],e.styledMode?t.colorIndex=h(t.options.colorIndex,o[t.from].colorIndex):t.color=t.options.color||o[t.from].color),a(t.to)&&(o[t.to]||(o[t.to]=this.createNode(t.to)),o[t.to].linksTo.push(t),t.toNode=o[t.to]),t.name=t.name||t.id},this),this.nodeLookup=o},f.setNodeState=p,f.updateNode=c;let u=x;var f=s(260),m=s.n(f);let _=n().seriesTypes["column"],g=e()["defined"];class y extends _.prototype.pointClass{applyOptions(t,e){return m().prototype.applyOptions.call(this,t,e),g(this.options.level)&&(this.options.column=this.column=this.options.level),this}getClassName(){return(this.isNode?"highcharts-node ":"highcharts-link ")+m().prototype.getClassName.call(this)}getFromNode(){let e=-1,o;for(let t=0;t<this.linksTo.length;t++){var i=this.linksTo[t];i.fromNode.column>e&&i.fromNode!==this&&(e=(o=i.fromNode).column)}return{fromNode:o,fromColumn:e}}setNodeColumn(){g(this.options.column)||(0===this.linksTo.length?this.column=0:this.column=this.getFromNode().fromColumn+1)}isValid(){return this.isNode||"number"==typeof this.weight}}let{defined:X,getAlignFactor:R,relativeLength:v}=e();{var x=P=P||{};x.compose=function(t,e){return t.sankeyColumn=new H(t,e),t};class H{constructor(t,e){this.points=t,this.series=e}getTranslationFactor(t){let e=this.points,o=e.slice(),i=t.chart,s=t.options.minLinkWidth||0,n,r=0,a,l=(i.plotSizeY||0)-(t.options.borderWidth||0)-(e.length-1)*t.nodePadding;for(;e.length;){for(r=l/e.sankeyColumn.sum(),n=!1,a=e.length;a--;)e[a].getSum()*r<s&&(e.splice(a,1),l=Math.max(0,l-s),n=!0);if(!n)break}for(var h of(e.length=0,o))e.push(h);return r}top(o){let i=this.series,s=i.nodePadding,t=this.points.reduce((t,e)=>(0<t&&(t+=s),t+=Math.max(e.getSum()*o,i.options.minLinkWidth||0)),0);return R(i.options.nodeAlignment||"center")*((i.chart.plotSizeY||0)-t)}left(o){let i=this.series,t=i.chart,s=i.options.equalNodes,n=t.inverted?t.plotHeight:t.plotWidth,r=i.nodePadding,e=this.points.reduce((t,e)=>(0<t&&(t+=r),t+=s?n/e.series.nodes.length-r:Math.max(e.getSum()*o,i.options.minLinkWidth||0)),0);return((t.plotSizeX||0)-Math.round(e))/2}sum(){return this.points.reduce((t,e)=>t+e.getSum(),0)}offset(e,o){let i=this.points,s=this.series,n=s.nodePadding,r=0,a;if(s.is("organization")&&e.hangsFrom)return{absoluteTop:e.hangsFrom.nodeY};for(let t=0;t<i.length;t++){var l=i[t].getSum(),h=Math.max(l*o,s.options.minLinkWidth||0),d=e.options[s.chart.inverted?"offsetHorizontal":"offsetVertical"],p=e.options.offset||0;if(a=l?h+n:0,i[t]===e)return{relativeTop:r+(X(d)?v(d,h):v(p,a))};r+=a}}}x.SankeyColumnAdditions=H}let b=P;f=s(620),x=s.n(f);let{isArray:j,isNumber:k,isObject:N,merge:C,pick:I,relativeLength:V}=e();var P=s(28),f=s.n(P);let G=e()["deg2rad"],{addEvent:L,merge:q,uniqueKey:Z,defined:S,extend:K}=e();function $(s,t){t=q(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},t);let n=this.renderer.url,r=this.text||this,e=r.textPath,{attributes:a,enabled:l}=t;return s=s||e&&e.path,e&&e.undo(),s&&l?(t=L(r,"afterModifyTree",o=>{if(s&&l){let t=s.attr("id"),e=(t||s.attr("id",t=Z()),{x:0,y:0});S(a.dx)&&(e.dx=a.dx,delete a.dx),S(a.dy)&&(e.dy=a.dy,delete a.dy),r.attr(e),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());var i=o.nodes.slice(0);o.nodes.length=0,o.nodes[0]={tagName:"textPath",attributes:K(a,{"text-anchor":a.textAnchor,href:n+"#"+t}),children:i}}}),r.textPath={path:s,undo:t}):(r.attr({dx:0,dy:0}),delete r.textPath),this.added&&(r.textCache="",this.renderer.buildText(r)),this}function J(h){let o=h.bBox,d=this.element?.querySelector("textPath");if(d){let i=[],{b:s,h:t}=this.renderer.fontMetrics(this.element),n=t-s,e=RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),r=d.innerHTML.replace(e,"").split(/<tspan class="highcharts-br"[^>]*>/),a=r.length,l=(t,e)=>{var{x:e,y:o}=e,t=(d.getRotationOfChar(t)-90)*G,i=Math.cos(t),t=Math.sin(t);return[[e-n*i,o-n*t],[e+s*i,o+s*t]]};for(let e=0,o=0;o<a;o++){var p=r[o].length;for(let t=0;t<p;t+=5)try{var c=e+t+o,[u,f]=l(c,d.getStartPositionOfChar(c));0===t?(i.push(f),i.push(u)):(0===o&&i.unshift(f),o===a-1&&i.push(u))}catch(h){break}e+=p-1;try{var m=e+o,g=d.getEndPositionOfChar(m),[y,v]=l(m,g);i.unshift(v),i.unshift(y)}catch(h){break}}i.length&&i.push(i[0].slice()),o.polygon=i}return o}function Q(t){let e=t.labelOptions,o=t.point,i=e[o.formatPrefix+"TextPath"]||e.textPath;i&&!e.useHTML&&(this.setTextPath(o.getDataLabelPath?.(this)||o.graphic,i),o.dataLabelPath&&!i.enabled&&(o.dataLabelPath=o.dataLabelPath.destroy()))}let{column:T,line:U}=n().seriesTypes,Y=x()["parse"],{getLevelOptions:tt,getNodeWidth:et}={getLevelOptions:function(t){let n,e,o,r,i,s,a={};if(N(t))for(r=k(t.from)?t.from:1,s=t.levels,e={},n=N(t.defaults)?t.defaults:{},j(s)&&(e=s.reduce((t,e)=>{let o,i,s;return N(e)&&k(e.level)&&(i=I((s=C({},e)).levelIsConstant,n.levelIsConstant),delete s.levelIsConstant,delete s.level,N(t[o=e.level+(i?0:r-1)])?C(!0,t[o],s):t[o]=s),t},{})),i=k(t.to)?t.to:1,o=0;o<=i;o++)a[o]=C({},n,N(e[o])?e[o]:{});return a},getNodeWidth:function(t,e){var{chart:t,options:o}=t,{nodeDistance:o=0,nodeWidth:i=0}=o,{plotSizeX:t=1}=t;if("auto"!==i)return V(i,t);if("string"==typeof o&&/%$/.test(o))return t/(e+parseFloat(o)/100*(e-1));i=Number(o);return(t+i)/(e||1)-i}},{clamp:ot,crisp:w,extend:it,isObject:O,merge:M,pick:B,relativeLength:F,stableSort:st}=e();{P=f(),L(P,"afterGetBBox",J),L(P,"beforeAddingDataLabel",Q);let t=P.prototype;t.setTextPath||(t.setTextPath=$)}class W extends T{static getDLOptions(t){var e=O(t.optionsPoint)?t.optionsPoint.dataLabels:{};return M({style:{}},O(t.level)?t.level.dataLabels:{},e)}createNodeColumns(){let e=[];for(var t of this.nodes)t.setNodeColumn(),e[t.column]||(e[t.column]=b.compose([],this)),e[t.column].push(t);for(let t=0;t<e.length;t++)void 0===e[t]&&(e[t]=b.compose([],this));return e}order(t,e){if(void 0===t.level)for(var o of(t.level=e,t.linksFrom))o.toNode&&this.order(o.toNode,e+1)}generatePoints(){if(u.generatePoints.apply(this,arguments),this.orderNodes){for(var t of this.nodes)0===t.linksTo.length&&this.order(t,0);st(this.nodes,(t,e)=>t.level-e.level)}}getNodePadding(){let t=this.options.nodePadding||0;var e;return t=this.nodeColumns&&(e=this.nodeColumns.reduce((t,e)=>Math.max(t,e.length),0))*t>this.chart.plotSizeY?this.chart.plotSizeY/e:t}hasData(){return!!this.dataTable.rowCount}pointAttribs(t,e){if(!t)return{};let o=this,i=(t.isNode?t:t.fromNode).level,s=o.mapOptionsToLevel[i||0]||{},n=t.options,r=s.states&&s.states[e||""]||{},a=["colorByPoint","borderColor","borderWidth","linkOpacity","opacity"].reduce((t,e)=>(t[e]=B(r[e],n[e],s[e],o.options[e]),t),{}),l=B(r.color,n.color,(a.colorByPoint?t:s).color);return t.isNode?{fill:l,stroke:a.borderColor,"stroke-width":a.borderWidth,opacity:a.opacity}:{fill:l,"fill-opacity":a.linkOpacity}}drawTracker(){T.prototype.drawTracker.call(this,this.points),T.prototype.drawTracker.call(this,this.nodes)}drawPoints(){T.prototype.drawPoints.call(this,this.points),T.prototype.drawPoints.call(this,this.nodes)}drawDataLabels(){T.prototype.drawDataLabels.call(this,this.points),T.prototype.drawDataLabels.call(this,this.nodes)}translate(){this.generatePoints(),this.nodeColumns=this.createNodeColumns();let o=this,t=this.chart,e=this.options,i=this.nodeColumns,s=i.length;for(var n of(this.nodeWidth=et(this,s),this.nodePadding=this.getNodePadding(),this.translationFactor=i.reduce((t,e)=>Math.min(t,e.sankeyColumn.getTranslationFactor(o)),1/0),this.colDistance=(t.plotSizeX-this.nodeWidth-e.borderWidth)/Math.max(1,i.length-1),o.mapOptionsToLevel=tt({from:1,levels:e.levels,to:i.length-1,defaults:{borderColor:e.borderColor,borderRadius:e.borderRadius,borderWidth:e.borderWidth,color:o.color,colorByPoint:e.colorByPoint,levelIsConstant:!0,linkColor:e.linkColor,linkLineWidth:e.linkLineWidth,linkOpacity:e.linkOpacity,states:e.states}}),i))for(var r of n)o.translateNode(r,n);for(var a of this.nodes)for(var l of a.linksFrom)(l.weight||l.isNull)&&l.to&&(o.translateLink(l),l.allowShadow=!1)}translateLink(o){let t=(t,e)=>{e=t.offset(o,e)*r;return Math.min(t.nodeY+e,t.nodeY+(t.shapeArgs&&t.shapeArgs.height||0)-c)},e=o.fromNode,i=o.toNode,s=this.chart,n=s["inverted"],r=this.translationFactor,a=this.options,l=B(o.linkColorMode,a.linkColorMode),h=(s.inverted?-this.colDistance:this.colDistance)*a.curveFactor,d=e.nodeX,p=i.nodeX,A=o.outgoing,c=Math.max(o.weight*r,this.options.minLinkWidth),u=t(e,"linksFrom"),f=t(i,"linksTo"),m=this.nodeWidth,g=p>d+m;var y,v,x,b,k,N,C,P,L,S,T,w,O,M,F,W,H,z,D;s.inverted&&(u=s.plotSizeY-u,f=(s.plotSizeY||0)-f,m=-m,c=-c,g=p<d),o.shapeType="path",o.linkBase=[u,u+c,f,f+c],g&&"number"==typeof f?o.shapeArgs={d:[["M",d+m,u],["C",d+m+h,u,p-h,f,p,f],["L",p+(A?m:0),f+c/2],["L",p,f+c],["C",p-h,f+c,d+m+h,u+c,d+m,u+c],["Z"]]}:"number"==typeof f&&(P=s.plotHeight-u-c,y=p-20-c,v=p-20,k=(b=(x=d+m)+20)+c,S=(L=(P=(C=(N=(z=u)+c)+20)+P)+20)+c,O=(w=(T=f)+c)+20,D=N-.7*c,M=L+.7*c,F=w-.7*c,W=p-.7*c,H=x+.7*c,o.shapeArgs={d:[["M",x,z],["C",H,z,k,D,k,C],["L",k,P],["C",k,M,H,S,x,S],["L",p,S],["C",W,S,y,M,y,P],["L",y,O],["C",y,F,W,T,p,T],["L",p,w],["C",v,w,v,w,v,O],["L",v,P],["C",v,L,v,L,p,L],["L",x,L],["C",b,L,b,L,b,P],["L",b,C],["C",b,N,b,N,x,N],["Z"]]}),o.dlBox={x:d+(p-d+m)/2,y:u+(f-u)/2,height:c,width:0},o.tooltipPos=s.inverted?[s.plotSizeY-o.dlBox.y-c/2,s.plotSizeX-o.dlBox.x]:[o.dlBox.x,o.dlBox.y+c/2],o.y=o.plotY=1,o.x=o.plotX=1,o.options.color||("from"===l?o.color=e.color:"to"===l?o.color=i.color:"gradient"===l&&(z=Y(e.color).get(),D=Y(i.color).get(),o.color={linearGradient:{x1:1,x2:0,y1:0,y2:0},stops:[[0,n?z:D],[1,n?D:z]]}))}translateNode(n,r){var t=this.translationFactor,a=this.chart,l=this.options,{borderRadius:h,borderWidth:e=0}=l,o=n.getSum(),d=Math.max(Math.round(o*t),this.options.minLinkWidth),p=Math.round(this.nodeWidth),c=r.sankeyColumn.offset(n,t),r=w(B(c.absoluteTop,r.sankeyColumn.top(t)+c.relativeTop),e),t=w(this.colDistance*n.column+e/2,e)+F(n.options[a.inverted?"offsetVertical":"offsetHorizontal"]||0,p),c=a.inverted?a.plotSizeX-t:t;if(n.sum=o){n.shapeType="roundedRect";let t=n.nodeX=c,e=n.nodeY=r,o=n.options.width||l.width||p,i=n.options.height||l.height||d,s=ot(F("object"==typeof h?h.radius:h||0,o),0,d/2);a.inverted&&(t=c-p,e=a.plotSizeY-r-d,o=n.options.height||l.height||p,i=n.options.width||l.width||d),n.dlOptions=W.getDLOptions({level:this.mapOptionsToLevel[n.level],optionsPoint:n.options}),n.plotX=1,n.plotY=1,n.tooltipPos=a.inverted?[a.plotSizeY-e-i/2,a.plotSizeX-t-o/2]:[t+o/2,e+i/2],n.shapeArgs={x:t,y:e,width:o,height:i,r:s,display:n.hasShape()?"":"none"}}else n.dlOptions={enabled:!1}}}W.defaultOptions=M(T.defaultOptions,{borderWidth:0,colorByPoint:!0,curveFactor:.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){},inside:!0},inactiveOtherPoints:!0,linkColorMode:"from",linkOpacity:.5,opacity:1,minLinkWidth:0,nodeAlignment:"center",nodeWidth:20,nodePadding:10,nodeDistance:30,showInLegend:!1,states:{hover:{linkOpacity:1,opacity:1},inactive:{linkOpacity:.1,opacity:.1,animation:{duration:50}}},tooltip:{followPointer:!0,headerFormat:'<span style="font-size: 0.8em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} → {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}}),u.compose(y,W),it(W.prototype,{animate:U.prototype.animate,createNode:u.createNode,forceDL:!0,invertible:!0,isCartesian:!1,orderNodes:!0,noSharedTooltip:!0,pointArrayMap:["from","to","weight"],pointClass:y,searchPoint:e().noop}),n().registerSeriesType("sankey",W);let nt=e();return t.default})());
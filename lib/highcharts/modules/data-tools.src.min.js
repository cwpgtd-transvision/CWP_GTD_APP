!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(e._Highcharts):"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts/highcharts"],function(e){return t(e)}):"object"==typeof exports?exports["highcharts/modules/data-tools"]=t(e._Highcharts):e.Highcharts=t(e.Highcharts)}("undefined"==typeof window?this:window,Wt=>(()=>{"use strict";var k={944:e=>{e.exports=Wt}},S={};function s(e){var t=S[e];if(void 0!==t)return t.exports;t=S[e]={exports:{}};return k[e](t,t.exports,s),t.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r,V={},e=(s.d(V,{default:()=>zt}),s(944)),o=s.n(e);const{addEvent:Y,fireEvent:U,merge:$}=o();class t{benchmark(e,t){const r=[],s=this,o=()=>{s.modifyTable(e),s.emit({type:"afterBenchmarkIteration"})};const n=$({iterations:1},t)["iterations"],i=(s.on("afterBenchmarkIteration",()=>{r.length===n?s.emit({type:"afterBenchmark",results:r}):o()}),{startTime:0,endTime:0});return s.on("modify",()=>{i.startTime=window.performance.now()}),s.on("afterModify",()=>{i.endTime=window.performance.now(),r.push(i.endTime-i.startTime)}),o(),r}emit(e){U(this,e.type,e)}modify(r,s){const o=this;return new Promise((e,t)=>{r.modified===r&&(r.modified=r.clone(!1,s));try{e(o.modifyTable(r,s))}catch(e){o.emit({type:"error",detail:s,table:r}),t(e)}})}modifyCell(e,t,r,s,o){return this.modifyTable(e)}modifyColumns(e,t,r,s){return this.modifyTable(e)}modifyRows(e,t,r,s){return this.modifyTable(e)}on(e,t){return Y(this,e,t)}}(r=t=t||{}).types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)};const i=t,f=((e=R=R||{}).setLength=function(e,t,r){return Array.isArray(e)?(e.length=t,e):e[r?"subarray":"slice"](0,t)},e.splice=function(e,t,r,s,o=[]){if(Array.isArray(e))return Array.isArray(o)||(o=Array.from(o)),{removed:e.splice(t,r,...o),array:e};const n=Object.getPrototypeOf(e).constructor;var s=e[s?"subarray":"slice"](t,t+r),i=e.length-r+o.length;const a=new n(i);return a.set(e.subarray(0,t),0),a.set(o,t),a.set(e.subarray(t+r),t+o.length),{removed:s,array:a}},R),{setLength:H,splice:_}=f,{fireEvent:l,objectEach:u,uniqueKey:c}=o();var n,a,e=class{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||c(),(this.modified=this).rowCount=0,this.versionTag=c();let r=0;u(e.columns||{},(e,t)=>{this.columns[t]=e.slice(),r=Math.max(r,e.length)}),this.applyRowCount(r)}applyRowCount(r){this.rowCount=r,u(this.columns,(e,t)=>{e.length!==r&&(this.columns[t]=H(e,r))})}deleteRows(s,o=1){if(0<o&&s<this.rowCount){let r=0;u(this.columns,(e,t)=>{this.columns[t]=_(e,s,o).array,r=e.length}),this.rowCount=r}l(this,"afterDeleteRows",{rowIndex:s,rowCount:o}),this.versionTag=c()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce((e,t)=>(e[t]=this.columns[t],e),{})}getRow(t,e){return(e||Object.keys(this.columns)).map(e=>this.columns[e]?.[t])}setColumn(e,t=[],r=0,s){this.setColumns({[e]:t},r,s)}setColumns(e,t,r){let s=this.rowCount;u(e,(e,t)=>{this.columns[t]=e.slice(),s=e.length}),this.applyRowCount(s),r?.silent||(l(this,"afterSetColumns"),this.versionTag=c())}setRow(e,s=this.rowCount,o,n){const i=this["columns"],a=o?this.rowCount+1:s+1;u(e,(e,t)=>{let r=i[t]||!1!==n?.addColumns&&new Array(a);r&&(o?r=_(r,s,0,!0,[e]).array:r[s]=e,i[t]=r)}),a>this.rowCount&&this.applyRowCount(a),n?.silent||(l(this,"afterSetRows"),this.versionTag=c())}};const{addEvent:B,defined:d,extend:G,fireEvent:K,isNumber:Z,uniqueKey:J}=o();class h extends e{static isNull(r){if(r===h.NULL)return!0;if(r instanceof Array){if(!r.length)return!1;for(let e=0,t=r.length;e<t;++e)if(null!==r[e])return!1}else{var s=Object.keys(r);if(!s.length)return!1;for(let e=0,t=s.length;e<t;++e)if(null!==r[s[e]])return!1}return!0}constructor(e={}){super(e),this.modified=this}clone(e,t){const r=this,s={},o=(r.emit({type:"cloneTable",detail:t}),e||(s.columns=r.columns),r.autoId||(s.id=r.id),new h(s));return e||(o.versionTag=r.versionTag,o.originalRowIndexes=r.originalRowIndexes,o.localRowIndexes=r.localRowIndexes),r.emit({type:"afterCloneTable",detail:t,tableClone:o}),o}deleteColumns(o,e){const t=this,n=t.columns,i={},a={},r=t.modifier,l=t.rowCount;if((o=o||Object.keys(n)).length){t.emit({type:"deleteColumns",columnNames:o,detail:e});for(let e=0,t=o.length,r,s;e<t;++e)s=o[e],(r=n[s])&&(i[s]=r,a[s]=new Array(l)),delete n[s];return Object.keys(n).length||(t.rowCount=0,this.deleteRowIndexReferences()),r&&r.modifyColumns(t,a,0,e),t.emit({type:"afterDeleteColumns",columns:i,columnNames:o,detail:e}),i}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(n,i=1,e){const a=this,l=[],u=[],t=a.modifier;if(a.emit({type:"deleteRows",detail:e,rowCount:i,rowIndex:n||0}),void 0===n&&(n=0,i=a.rowCount),0<i&&n<a.rowCount){const m=a.columns,d=Object.keys(m);for(let r=0,e=d.length,t,s,o;r<e;++r){o=d[r],t=m[o];var c=f.splice(t,n,i);s=c.removed,m[o]=t=c.array,r||(a.rowCount=t.length);for(let e=0,t=s.length;e<t;++e)l[e]=l[e]||[],l[e][r]=s[e];u.push(new Array(e))}}return t&&t.modifyRows(a,u,n||0,e),a.emit({type:"afterDeleteRows",detail:e,rowCount:i,rowIndex:n||0,rows:l}),l}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=J()),K(this,e.type,e)}getCell(e,t){e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,r){e=this.columns[e];let s=e&&e[t];switch(typeof s){case"boolean":return s?1:0;case"number":return isNaN(s)&&!r?null:s}return s=parseFloat(""+(s??"")),isNaN(s)&&!r?null:s}getCellAsString(e,t){e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(t,e){const r=this.columns[t],s=[];if(r){var o=r.length;if(e)for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<o;++e){if("number"==typeof(t=r[e]))return r.slice();if(null!=t)break}for(let e=0;e<o;++e)s.push(this.getCellAsNumber(t,e))}}return s}getColumnNames(){return Object.keys(this.columns)}getColumns(o,n,i){const a=this.columns,l={};for(let e=0,t=(o=o||Object.keys(a)).length,r,s;e<t;++e)s=o[e],(r=a[s])&&(n?l[s]=r:i&&!Array.isArray(r)?l[s]=Array.from(r):l[s]=r.slice());return l}getLocalRowIndex(e){var t=this["localRowIndexes"];return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){var t=this["originalRowIndexes"];return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,r){const s=this.columns[e];if(s){let e=-1;if(-1!==(e=Array.isArray(s)||Z(t)?s.indexOf(t,r):e))return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(n=0,i=this.rowCount-n,a){const l=this.columns,u=new Array(i);a=a||Object.keys(l);for(let e=n,t=0,r=Math.min(this.rowCount,n+i),s,o;e<r;++e,++t){o=u[t]={};for(const c of a)s=l[c],o[c]=s?s[e]:void 0}return u}getRows(n=0,i=this.rowCount-n,a){const l=this.columns,u=new Array(i);a=a||Object.keys(l);for(let e=n,t=0,r=Math.min(this.rowCount,n+i),s,o;e<r;++e,++t){o=u[t]=[];for(const c of a)s=l[c],o.push(s?s[e]:void 0)}return u}getVersionTag(){return this.versionTag}hasColumns(r){var s=this.columns;for(let e=0,t=r.length;e<t;++e)if(!s[r[e]])return!1;return!0}hasRowWith(e,t){const r=this.columns[e];return Array.isArray(r)?-1!==r.indexOf(t):!(!d(t)||!Number.isFinite(t))&&-1!==r.indexOf(+t)}on(e,t){return B(this,e,t)}renameColumn(e,t){const r=this.columns;return!!r[e]&&(e!==t&&(r[t]=r[e],delete r[e]),!0)}setCell(e,t,r,s){const o=this,n=o.columns,i=o.modifier;let a=n[e];a&&a[t]===r||(o.emit({type:"setCell",cellValue:r,columnName:e,detail:s,rowIndex:t}),a=a||(n[e]=new Array(o.rowCount)),t>=o.rowCount&&(o.rowCount=t+1),a[t]=r,i&&i.modifyCell(o,e,t,r),o.emit({type:"afterSetCell",cellValue:r,columnName:e,detail:s,rowIndex:t}))}setColumns(i,a,e,l){const t=this,u=t.columns,r=t.modifier,c=Object.keys(i);let m=t.rowCount;if(t.emit({type:"setColumns",columns:i,columnNames:c,detail:e,rowIndex:a}),d(a)||l){for(let e=0,t=c.length,r,s,o,n;e<t;++e){r=i[o=c[e]],s=u[o],n=Object.getPrototypeOf(s&&l?s:r).constructor,s?n===Array?Array.isArray(s)||(s=Array.from(s)):s.length<m&&(s=new n(m)).set(u[o]):s=new n(m),u[o]=s;for(let e=a||0,t=r.length;e<t;++e)s[e]=r[e];m=Math.max(m,r.length)}this.applyRowCount(m)}else super.setColumns(i,a,G(e,{silent:!0}));r&&r.modifyColumns(t,i,a||0),t.emit({type:"afterSetColumns",columns:i,columnNames:c,detail:e,rowIndex:a})}setModifier(t,r){const s=this;let e;return s.emit({type:"setModifier",detail:r,modifier:t,modified:s.modified}),(s.modified=s).modifier=t,(e=t?t.modify(s):Promise.resolve(s)).then(e=>(e.emit({type:"afterSetModifier",detail:r,modifier:t,modified:e.modified}),e)).catch(e=>{throw s.emit({type:"setModifierError",error:e,modifier:t,modified:s.modified}),e})}setOriginalRowIndexes(s,e=!1){if(this.originalRowIndexes=s,!e){const o=this.localRowIndexes=[];for(let e=0,t=s.length,r;e<t;++e)r=s[e],d(r)&&(o[r]=e)}}setRow(e,t,r,s){this.setRows([e],t,r,s)}setRows(t,o=this.rowCount,n,e){const r=this,i=r.columns,a=Object.keys(i),s=r.modifier,l=t.length;r.emit({type:"setRows",detail:e,rowCount:l,rowIndex:o,rows:t});for(let e=0,r=o,s;e<l;++e,++r)if((s=t[e])===h.NULL)for(let e=0,t=a.length;e<t;++e){const m=i[a[e]];n?i[a[e]]=f.splice(m,r,0,!0,[null]).array:m[r]=null}else if(s instanceof Array)for(let e=0,t=a.length;e<t;++e)i[a[e]][r]=s[e];else super.setRow(s,r,void 0,{silent:!0});var u=n?l+t.length:o+l;if(u>r.rowCount){r.rowCount=u;for(let e=0,t=a.length;e<t;++e){var c=a[e];i[c]=f.setLength(i[c],u)}}s&&s.modifyRows(r,t,o),r.emit({type:"afterSetRows",detail:e,rowCount:l,rowIndex:o,rows:t})}}h.NULL={},h.version="1.0.0";const m=h,{addEvent:X,fireEvent:g,merge:q,pick:z}=o();class p{constructor(e={},r=[]){this.dataTables={},this.loaded=!1,this.metadata=e.metadata||{columns:{}};let s=0;if(0<r?.length)for(let e=0,t=r.length;e<t;++e){var o=r[e],n=o?.key;this.dataTables[n??s]=new m(o),n||s++}else this.dataTables[0]=new m(e.dataTable)}get polling(){return!!this._polling}get table(){return this.getTable()}describeColumn(e,t){const r=this.metadata.columns;r[e]=q(r[e]||{},t)}describeColumns(e){const t=Object.keys(e);for(var r;"string"==typeof(r=t.pop());)this.describeColumn(r,e[r])}emit(e){g(this,e.type,e)}getColumnOrder(e){const r=this.metadata.columns,t=Object.keys(r||{});if(t.length)return t.sort((e,t)=>z(r[e].index,0)-z(r[t].index,0))}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return g(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return X(this,e,t)}save(){return g(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(r){for(let e=0,t=r.length;e<t;++e)this.describeColumn(r[e],{index:e})}async setModifierOptions(e,t){for(const[s,o]of Object.entries(this.dataTables)){var r=t?.find(e=>e.key===s),r=q(r?.dataModifier,e);const n=r&&i.types[r.type];await o.setModifier(n?new n(r):void 0)}return this}startPolling(e=1e3){const t=this,r=t.dataTables;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,tables:r})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){this.polling&&(this?.pollingController?.abort(),window.clearTimeout(this._polling),delete this._polling)}whatIs(e){return this.metadata.columns[e]}initConverters(e,t,r){let s=0;for(var[o,n]of Object.entries(this.dataTables)){const i=t(o,n);r(i,e),n.deleteColumns(),n.setColumns(i.getTable().getColumns()),0===s&&(this.converter=i),s++}}}(n=p=p||{}).types={},n.registerType=function(e,t){return!!e&&!n.types[e]&&!!(n.types[e]=t)};const y=p,{addEvent:Q,fireEvent:W,isNumber:ee,merge:te}=o();class b{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let r=+e[4];return r>t.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};e=te(b.defaultOptions,e);let t=e.decimalPoint;"."!==t&&","!==t||(t="."===t?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+t+"([0-9]+)$")),this.options=e}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this,r={number:t.asNumber,Date:t.asDate,string:t.asString};return r[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"!=typeof e)return e instanceof Date?e.getDate():e?e.getRowCount():NaN;{const t=this.decimalRegExp;if(-1<e.indexOf(" ")&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}}asString(e){return""+e}deduceDateFormat(e,t,r){const s=[],o=[];let n="YYYY/mm/dd",i,a=[],l=0,u=!1,c,m;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(i=e[l].trim().replace(/[\-\.\/]/g," ").split(" "),a=["","",""],m=0;m<i.length;m++)m<a.length&&(c=parseInt(i[m],10))&&(o[m]=!o[m]||o[m]<c?c:o[m],void 0!==s[m]?s[m]!==c&&(s[m]=!1):s[m]=c,31<c?a[m]=c<100?"YY":"YYYY":12<c&&c<=31?(a[m]="dd",u=!0):a[m].length||(a[m]="mm"));if(u){for(m=0;m<s.length;m++)!1!==s[m]?12<o[m]&&"YY"!==a[m]&&"YYYY"!==a[m]&&(a[m]="YY"):12<o[m]&&"mm"===a[m]&&(a[m]="dd");3===a.length&&"dd"===a[1]&&"dd"===a[2]&&(a[2]="YY"),n=a.join("/")}return r&&(this.options.dateFormat=n),n}emit(e){W(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(t){let r="string";if("string"==typeof t){const o=this.trim(""+t),n=this.decimalRegExp;let e=this.trim(o,!0);n&&(e=n.test(e)?e.replace(n,"$1.$2"):"");var s=parseFloat(e);+e===s?t=s:(s=this.parseDate(t),r=ee(s)?"Date":"string")}return r="number"==typeof t?31536e6<t?"Date":"number":r}on(e,t){return Q(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const r=this,s=r.options;let o=t||s.dateFormat,n=NaN,i,a,l;if(s.parseDate)n=s.parseDate(e);else{if(o)a=(a=r.dateFormats[o])||r.dateFormats["YYYY/mm/dd"],(l=e.match(a.regex))&&(n=a.parser(l));else for(i in r.dateFormats)if(a=r.dateFormats[i],l=e.match(a.regex)){o=i,n=a.parser(l);break}l||("object"==typeof(l=Date.parse(e))&&null!==l&&l.getTime?n=l.getTime()-6e4*l.getTimezoneOffset():ee(l)&&(n=l-6e4*new Date(l).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(n).getFullYear()&&(n=NaN)))}return n}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}b.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},(a=b=b||{}).types={},a.registerType=function(e,t){return!!e&&!a.types[e]&&!!(a.types[e]=t)},a.getTableFromColumns=function(r=[],s=[]){const o=new m;for(let e=0,t=Math.max(s.length,r.length);e<t;++e)o.setColumn(s[e]||""+e,r[e]);return o};const w=b;class C{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,r){const s=this.listenerMap[e]=this.listenerMap[e]||{},o=s[t]=s[t]||[];return o.push(r),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(e,t,r,s){const o=e.id,n=t.state,i=this.listenerMap[o]&&this.listenerMap[o][n];if(i){const a=this.stateMap[o]=this.stateMap[o]??{},l=a[t.state]||[],u=(s&&(l.length||(a[t.state]=l),-1===C.getIndex(t,l)&&l.push(t)),{cursor:t,cursors:l,table:e}),c=(r&&(u.event=r),this.emittingRegister),m=this.buildEmittingTag(u);if(0<=c.indexOf(m))return this;try{this.emittingRegister.push(m);for(let e=0,t=i.length;e<t;++e)i[e].call(this,u)}finally{s=this.emittingRegister.indexOf(m);0<=s&&this.emittingRegister.splice(s,1)}}return this}remitCursor(e,t){const r=this.stateMap[e]&&this.stateMap[e][t.state];return r&&0<=(e=C.getIndex(t,r))&&r.splice(e,1),this}removeListener(e,t,r){const s=this.listenerMap[e]&&this.listenerMap[e][t];return s&&0<=(e=s.indexOf(r))&&s.splice(e,1),this}}function re(e,t){if("range"===e.type)return e;const r={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(r.columns=[e.column]),r}C.version="1.0.0",(R=C=C||{}).getIndex=function(s,o){if("position"===s.type){for(let e,t=0,r=o.length;t<r;++t)if("position"===(e=o[t]).type&&e.state===s.state&&e.column===s.column&&e.row===s.row)return t}else{var n=JSON.stringify(s.columns);for(let e,t=0,r=o.length;t<r;++t)if("range"===(e=o[t]).type&&e.state===s.state&&e.firstRow===s.firstRow&&e.lastRow===s.lastRow&&JSON.stringify(e.columns)===n)return t}return-1},R.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&(e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns))},R.isInRange=function(e,t){"position"===t.type&&(t=re(t));const r=(e="position"===e.type?re(e,t):e).columns,s=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!r||!s||r.every(e=>0<=s.indexOf(e)))},R.toPositions=function(t){if("position"===t.type)return[t];var s=t.columns||[];const o=[];var n=t.state;for(let r=t.firstRow,e=t.lastRow;r<e;++r)if(s.length)for(let e=0,t=s.length;e<t;++e)o.push({type:"position",column:s[e],row:r,state:n});else o.push({type:"position",row:r,state:n});return o},R.toRange=re;e=C;const se={connectors:[]};class oe{constructor(e=se){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){o().fireEvent(this,e.type,e)}getConnector(e){var t=this.connectors[e];if(t?.loaded)return Promise.resolve(t);let s=this.waiting[e];if(!s){s=this.waiting[e]=[];t=this.getConnectorOptions(e);if(!t)throw new Error(`Connector '${e}' not found.`);this.loadConnector(t).then(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][0](r)}).catch(r=>{delete this.waiting[e];for(let e=0,t=s.length;e<t;++e)s[e][1](r)})}return new Promise((e,t)=>{s.push([e,t])})}getConnectorIds(){const r=this.options.connectors,s=[];for(let e=0,t=r.length;e<t;++e)s.push(r[e].id);return s}getConnectorOptions(r){var s=this.options.connectors;for(let e=0,t=s.length;e<t;++e)if(s[e].id===r)return s[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(o){return new Promise((r,e)=>{this.emit({type:"load",options:o});const t=y.types[o.type];if(!t)throw new Error(`Connector type not found. (${o.type})`);const s=this.connectors[o.id]=new t(o.options,o.dataTables);s.load().then(({converter:e,dataTables:t})=>{s.dataTables=t,s.converter=e,s.loaded=!0,this.emit({type:"afterLoad",options:o}),r(s)}).catch(e)})}cancelPendingRequests(){const e=this["connectors"];for(const t of Object.keys(e))e[t].stopPolling()}on(e,t){return o().addEvent(this,e,t)}setConnectorOptions(r){const s=this.options.connectors,e=this.connectors;this.emit({type:"setConnectorOptions",options:r});for(let e=0,t=s.length;e<t;++e)if(s[e].id===r.id){s.splice(e,1);break}e[r.id]&&(e[r.id].stopPolling(),delete e[r.id]),s.push(r),this.emit({type:"afterSetConnectorOptions",options:r})}}oe.version="1.0.0";var R=oe;const ne=/^(?:FALSE|TRUE)/,ie=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,ae=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,le=/^([A-Z][A-Z\d\.]*)\(/,ue=/^(?:[+\-*\/^<=>]|<=|=>)/,ce=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,me=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,de=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,fe=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function he(o){let n=0;for(let e=0,t=o.length,r,s=1;e<t;++e)if("("===(r=o[e]))n||(s=e+1),++n;else if(")"===r&&!--n)return o.substring(s,e);if(0<n){const e=new Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function ge(o){let n=-1;for(let e=0,t=o.length,r,s=!1;e<t;++e)if("\\"===(r=o[e]))s=!s;else if(s)s=!1;else if('"'===r){if(!(n<0))return o.substring(n+1,e);n=e}const e=new Error("Incomplete string.");throw e.name="FormulaParseError",e}function pe(e,t){let r;if(r=e.match(me)){var s=""===r[2]||"["===r[2][0],o=""===r[1]||"["===r[1][0],n=""===r[4]||"["===r[4][0],i=""===r[3]||"["===r[3][0];const a={type:"range",beginColumn:s?parseInt(r[2].substring(1,-1)||"0",10):parseInt(r[2],10)-1,beginRow:o?parseInt(r[1].substring(1,-1)||"0",10):parseInt(r[1],10)-1,endColumn:n?parseInt(r[4].substring(1,-1)||"0",10):parseInt(r[4],10)-1,endRow:i?parseInt(r[3].substring(1,-1)||"0",10):parseInt(r[3],10)-1};return s&&(a.beginColumnRelative=!0),o&&(a.beginRowRelative=!0),n&&(a.endColumnRelative=!0),i&&(a.endRowRelative=!0),a}if(r=e.match(ce)){s="$"!==r[1][0],o="$"!==r[2][0],n="$"!==r[3][0],i="$"!==r[4][0];const l={type:"range",beginColumn:be(s?r[1]:r[1].substring(1))-1,beginRow:parseInt(o?r[2]:r[2].substring(1),10)-1,endColumn:be(n?r[3]:r[3].substring(1))-1,endRow:parseInt(i?r[4]:r[4].substring(1),10)-1};return s&&(l.beginColumnRelative=!0),o&&(l.beginRowRelative=!0),n&&(l.endColumnRelative=!0),i&&(l.endRowRelative=!0),l}s=ye(e,t);return 1===s.length&&"string"!=typeof s[0]?s[0]:s}function ye(e,t){const r=t?ae:ie,s=[];let o,n=("="===e[0]?e.substring(1):e).trim();for(;n;)if(o=n.match(fe)){var i=""===o[2]||"["===o[2][0],a=""===o[1]||"["===o[1][0];const u={type:"reference",column:i?parseInt(o[2].substring(1,-1)||"0",10):parseInt(o[2],10)-1,row:a?parseInt(o[1].substring(1,-1)||"0",10):parseInt(o[1],10)-1};i&&(u.columnRelative=!0),a&&(u.rowRelative=!0),s.push(u),n=n.substring(o[0].length).trim()}else if(o=n.match(de)){i="$"!==o[1][0],a="$"!==o[2][0];const c={type:"reference",column:be(i?o[1]:o[1].substring(1))-1,row:parseInt(a?o[2]:o[2].substring(1),10)-1};i&&(c.columnRelative=!0),a&&(c.rowRelative=!0),s.push(c),n=n.substring(o[0].length).trim()}else if(o=n.match(ue))s.push(o[0]),n=n.substring(o[0].length).trim();else if(o=n.match(ne))s.push("TRUE"===o[0]),n=n.substring(o[0].length).trim();else if(o=n.match(r))s.push(parseFloat(o[0])),n=n.substring(o[0].length).trim();else if('"'===n[0]){const m=ge(n);s.push(m.substring(1,-1)),n=n.substring(m.length+2).trim()}else{if(!(o=n.match(le))){if("("===n[0]){var l=he(n);if(l){s.push(ye(l,t)),n=n.substring(l.length+2).trim();continue}}const d=e.length-n.length,f=new Error("Unexpected character `"+e.substring(d,1+d)+"` at position "+(1+d)+". (`..."+e.substring(d-5,6+d)+"...`)");throw f.name="FormulaParseError",f}l=he(n=n.substring(o[1].length).trim());s.push({type:"function",name:o[1],args:function(s,o){const n=[],i=o?";":",";let a=0,l="";for(let e=0,t=s.length,r;e<t;++e){var u;(r=s[e])===i&&!a&&l?(n.push(pe(l,o)),l=""):'"'!==r||a||l?" "!==r&&(l+=r,"("===r?++a:")"===r&&--a):(u=ge(s.substring(e)),n.push(u),e+=u.length+1)}return!a&&l&&n.push(pe(l,o)),n}(l,t)}),n=n.substring(l.length+2).trim()}return s}function be(o){let n=0;for(let e=0,t=o.length,r,s=o.length-1;e<t;++e)65<=(r=o.charCodeAt(e))&&r<=90&&(n+=(r-64)*Math.pow(26,s)),--s;return n}const we={parseFormula:ye},Ce=["+","-","*","/","^","=","<","<=",">",">="];var v={isFormula:function(e){return e instanceof Array},isFunction:function(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type},isOperator:function(e){return"string"==typeof e&&0<=Ce.indexOf(e)},isRange:function(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type},isReference:function(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type},isValue:function(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}};const{isFormula:Re,isFunction:ve,isOperator:Ne,isRange:Te,isReference:Oe,isValue:N}=v,Ae=/ */,xe=Number.MAX_VALUE/1.000000000001,Ie=Number.MAX_VALUE/1.000000000002,Me=Number.MAX_VALUE,Fe={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},T={},Ee=/^[A-Z][A-Z\.]*$/;function O(e){switch(typeof e){case"boolean":return e?Me:xe;case"string":return Ie;case"number":return e;default:return NaN}}function A(e){return"string"==typeof e?e.toLowerCase().replace(Ae,"\0"):e}function Pe(e){switch(typeof e){case"boolean":return e?1:0;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function De(e,t,r){switch(e){case"=":return A(t)===A(r);case"<":return typeof t==typeof r?A(t)<A(r):O(t)<O(r);case"<=":return typeof t==typeof r?A(t)<=A(r):O(t)<=O(r);case">":return typeof t==typeof r?A(t)>A(r):O(t)>O(r);case">=":return typeof t==typeof r?A(t)>=A(r):O(t)>=O(r)}t=Pe(t),r=Pe(r);let s;switch(e){case"+":s=t+r;break;case"-":s=t-r;break;case"*":s=t*r;break;case"/":s=t/r;break;case"^":s=Math.pow(t,r);break;default:return NaN}return s%1?Math.round(1e9*s)/1e9:s}function je(e,t){return N(e)?e:Te(e)?t&&Le(e,t)||[]:ve(e)?Se(e,t):x(Re(e)?e:[e],t)}function Le(o,n){const i=n.getColumnNames().slice(o.beginColumn,o.endColumn+1),a=[];for(let r=0,e=i.length,s;r<e;++r){var l=n.getColumn(i[r],!0)||[];for(let e=o.beginRow,t=o.endRow+1;e<t;++e)"string"==typeof(s=l[e])&&"="===s[0]&&n!==n.modified&&(s=n.modified.getCell(i[r],e)),a.push(N(s)?s:NaN)}return a}function ke(e,t){var r,s=t.getColumnNames()[e.column];return s?"string"==typeof(r=t.getCell(s,e.row))&&"="===r[0]&&t!==t.modified?(t=t.modified.getCell(s,e.row),N(t)?t:NaN):N(r)?r:NaN:NaN}function x(i,a){let l;for(let e=0,t=i.length,r,s,o,n;e<t;++e)if(r=i[e],Ne(r))s=r;else if(N(r)?n=r:Re(r)?n=x(i,a):ve(r)?(o=Se(r,a),n=N(o)?o:NaN):Oe(r)&&(n=a&&ke(r,a)),void 0!==n){if(void 0===l)l=s?De(s,0,n):n;else{if(!s)return NaN;var u=i[e+1];Ne(u)&&Fe[u]>Fe[s]&&(n=De(u,n,x(i.slice(e+2))),e=t),l=De(s,l,n)}s=void 0,n=void 0}return N(l)?l:NaN}function Se(e,t){const r=T[e.name];if(r)try{return r(e.args,t)}catch{return NaN}const s=new Error(`Function "${e.name}" not found.`);throw s.name="FormulaProcessError",s}const I={asNumber:Pe,getArgumentValue:je,getArgumentsValues:function(r,s){const o=[];for(let e=0,t=r.length;e<t;++e)o.push(je(r[e],s));return o},getRangeValues:Le,getReferenceValue:ke,processFormula:x,processorFunctions:T,registerProcessorFunction:function(e,t){return Ee.test(e)&&!T[e]&&!!(T[e]=t)},translateReferences:function s(o,n=0,i=0){for(let e=0,t=o.length,r;e<t;++e)(r=o[e])instanceof Array?s(r,n,i):ve(r)?s(r.args,n,i):Te(r)?(r.beginColumnRelative&&(r.beginColumn+=n),r.beginRowRelative&&(r.beginRow+=i),r.endColumnRelative&&(r.endColumn+=n),r.endRowRelative&&(r.endRow+=i)):Oe(r)&&(r.columnRelative&&(r.column+=n),r.rowRelative&&(r.row+=i));return o}},Ve=I["getArgumentValue"];function Ye(e,t){var s=Ve(e[0],t);switch(typeof s){case"number":return Math.abs(s);case"object":{const o=[];for(let e=0,t=s.length,r;e<t;++e){if("number"!=typeof(r=s[e]))return NaN;o.push(Math.abs(r))}return o}default:return NaN}}I.registerProcessorFunction("ABS",Ye);const Ue=I["getArgumentValue"];function $e(s,o){for(let e=0,t=s.length,r;e<t;++e)if(!(r=Ue(s[e],o))||"object"==typeof r&&!$e(r,o))return!1;return!0}I.registerProcessorFunction("AND",$e);const He=I["getArgumentsValues"];function _e(e,t){var r=He(e,t);let o=0,n=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(++o,n+=s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(++o,n+=r)}return o?n/o:0}I.registerProcessorFunction("AVERAGE",_e);const Be=I["getArgumentValue"];function Ge(r,o){let n=0,i=0;for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=Be(r[e],o))){case"boolean":++n,i+=s?1:0;continue;case"number":isNaN(s)||(++n,i+=s);continue;case"string":++n;continue;default:for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"boolean":++n,i+=r?1:0;continue;case"number":isNaN(r)||(++n,i+=r);continue;case"string":++n;continue}continue}return n?i/n:0}I.registerProcessorFunction("AVERAGEA",Ge);function Ke(e,s){var o=I.getArgumentsValues(e,s);let n=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||++n;break;case"object":n+=Ke(r,s)}return n}I.registerProcessorFunction("COUNT",Ke);function Ze(e,s){var o=I.getArgumentsValues(e,s);let n=0;for(let e=0,t=o.length,r;e<t;++e){switch(typeof(r=o[e])){case"number":if(isNaN(r))continue;break;case"object":n+=Ze(r,s);continue;case"string":if(r)break;continue}++n}return n}I.registerProcessorFunction("COUNTA",Ze);const Je=I["getArgumentValue"];function Xe(e,t){return Je(e[0],t)?Je(e[1],t):Je(e[2],t)}I.registerProcessorFunction("IF",Xe);const qe=I["getArgumentValue"];function ze(e,t){e=qe(e[0],t);return"number"!=typeof e||isNaN(e)}I.registerProcessorFunction("ISNA",ze);const Qe=I["getArgumentsValues"];function We(e,t){var s=Qe(e,t);let o=Number.NEGATIVE_INFINITY;for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"number":r>o&&(o=r);break;case"object":(r=We(r))>o&&(o=r)}return isFinite(o)?o:0}I.registerProcessorFunction("MAX",We);function et(e,t){const o=[],r=I.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||o.push(s);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||o.push(r)}e=o.length;if(!e)return NaN;t=Math.floor(e/2);return e%2?o[t]:(o[t-1]+o[t])/2}I.registerProcessorFunction("MEDIAN",et);const tt=I["getArgumentsValues"];function rt(e,t){var s=tt(e,t);let o=Number.POSITIVE_INFINITY;for(let e=0,t=s.length,r;e<t;++e)switch(typeof(r=s[e])){case"number":r<o&&(o=r);break;case"object":(r=rt(r))<o&&(o=r)}return isFinite(o)?o:0}I.registerProcessorFunction("MIN",rt);const st=I["getArgumentValue"];function ot(e,t){let r=st(e[0],t),s=st(e[1],t);return"object"==typeof r&&(r=r[0]),"object"==typeof s&&(s=s[0]),"number"!=typeof r||"number"!=typeof s||0===s?NaN:r%s}I.registerProcessorFunction("MOD",ot);function nt(e,t){const o={},r=I.getArgumentsValues(e,t);for(let e=0,t=r.length,s;e<t;++e)switch(typeof(s=r[e])){case"number":isNaN(s)||(o[s]=(o[s]||0)+1);break;case"object":for(let e=0,t=s.length,r;e<t;++e)"number"!=typeof(r=s[e])||isNaN(r)||(o[r]=(o[r]||0)+1)}return o}function it(e,t){var o=nt(e,t),n=Object.keys(o);if(!n.length)return NaN;let i=[parseFloat(n[0])],a=o[n[0]];for(let e=1,t=n.length,r,s;e<t;++e)s=o[r=n[e]],a<s?(i=[parseFloat(r)],a=s):a===s&&i.push(parseFloat(r));return 1<a?i:NaN}function at(e,t){var n=nt(e,t),i=Object.keys(n);if(!i.length)return NaN;let a=parseFloat(i[0]),l=n[i[0]];for(let e=1,t=i.length,r,s,o;e<t;++e)o=n[r=i[e]],l<o?(a=parseFloat(r),l=o):l===o&&(s=parseFloat(r),a>s&&(a=s,l=o));return 1<l?a:NaN}I.registerProcessorFunction("MODE",at),I.registerProcessorFunction("MODE.MULT",it),I.registerProcessorFunction("MODE.SNGL",at);const lt=I["getArgumentValue"];function ut(e,t){let r=lt(e[0],t);switch(typeof(r="object"==typeof r?r[0]:r)){case"boolean":case"number":return!r}return NaN}I.registerProcessorFunction("NOT",ut);const ct=I["getArgumentValue"];function mt(s,o){for(let e=0,t=s.length,r;e<t;++e)if("object"==typeof(r=ct(s[e],o))){if(mt(r,o))return!0}else if(r)return!0;return!1}I.registerProcessorFunction("OR",mt);const dt=I["getArgumentsValues"];function ft(e,s){var o=dt(e,s);let n=1,i=!1;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(i=!0,n*=r);break;case"object":i=!0,n*=ft(r,s)}return i?n:0}I.registerProcessorFunction("PRODUCT",ft);function ht(e,s){var o=I.getArgumentsValues(e,s);let n=0;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":isNaN(r)||(n+=r);break;case"object":n+=ht(r,s)}return n}I.registerProcessorFunction("SUM",ht);const gt=I["getArgumentValue"];function pt(r,n){for(let e=0,t=r.length,s,o;e<t;++e)switch(typeof(o=gt(r[e],n))){case"boolean":case"number":if(void 0===s)s=!!o;else if(!!o!==s)return!0;break;case"object":for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"boolean":case"number":if(void 0===s)s=!!r;else if(!!r!==s)return!0}}return!1}I.registerProcessorFunction("XOR",pt);v={...we,...I,...v};const yt=o()["merge"];class M extends w{constructor(e){e=yt(M.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(e,t=this.options){var{useLocalDecimalPoint:r,lineDelimiter:s}=t,o=!1!==this.options.firstRowAsNames;let{decimalPoint:n,itemDelimiter:i}=t;n=n||(","!==i&&r?1.1.toLocaleString()[1]:"."),i=i||(","===n?";":",");const a=e.getSortedColumns(t.usePresentationOrder),l=Object.keys(a),u=[],c=l.length,m=[];o&&u.push(l.map(e=>`"${e}"`).join(i));for(let s=0;s<c;s++){var d=l[s],f=a[d],h=f.length,d=e.whatIs(d);let r;d&&(r=d.dataType);for(let t=0;t<h;t++){let e=f[t];if(m[t]||(m[t]=[]),"string"===r?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",n):"string"==typeof e&&(e=`"${e}"`),m[t][s]=e,s===c-1){let e=s;for(;2<m[t].length;){if(void 0!==m[t][e])break;m[t].pop(),e--}u.push(m[t].join(i))}}}return u.join(s)}parse(e,t){const s=this,r=s.dataTypes,o=yt(this.options,e),{beforeParse:n,lineDelimiter:i,firstRowAsNames:a,itemDelimiter:l}=o;let u,c=0,{csv:m,startRow:d,endRow:f}=o,h;if(s.columns=[],s.emit({type:"parse",columns:s.columns,detail:t,headers:s.headers}),m=m&&n?n(m):m){if(u=m.replace(/\r\n|\r/g,"\n").split(i||"\n"),(!d||d<0)&&(d=0),(!f||f>=u.length)&&(f=u.length-1),l||(s.guessedItemDelimiter=s.guessDelimiter(u)),a){const g=u[0].split(l||s.guessedItemDelimiter||",");for(let e=0;e<g.length;e++)g[e]=g[e].trim().replace(/^["']|["']$/g,"");s.headers=g,d++}let e=0;for(c=d;c<=f;c++)"#"===u[c][0]?e++:s.parseCSVRow(u[c],c-d-e);r.length&&r[0].length&&"date"===r[0][1]&&!s.options.dateFormat&&s.deduceDateFormat(s.columns[0],null,!0);for(let r=0,e=s.columns.length;r<e;++r)for(let t=0,e=(h=s.columns[r]).length;t<e;++t)if(h[t]&&"string"==typeof h[t]){let e=s.asGuessedType(h[t]);e instanceof Date&&(e=e.getTime()),s.columns[r][t]=e}}s.emit({type:"afterParse",columns:s.columns,detail:t,headers:s.headers})}parseCSVRow(t,r){const s=this,o=s.columns||[],n=s.dataTypes,{startColumn:i,endColumn:a}=s.options,e=s.options.itemDelimiter||s.guessedItemDelimiter;let l=s.options["decimalPoint"],u=(l&&l!==e||(l=s.guessedDecimalPoint||"."),0),c="",m="",d=0,f=0;var h=e=>{c=t[e]};const g=e=>{n.length<f+1&&n.push([e]),n[f][n[f].length-1]!==e&&n[f].push(e)};var p=()=>{if(i>d||d>a)return++d,void(m="");var e;"string"==typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),g("number")):isNaN(Date.parse(m))?g("string"):(m=m.replace(/\//g,"-"),g("date")):g("number"),o.length<f+1&&o.push([]),"number"!=typeof m&&"number"!==s.guessType(m)&&l&&(m=(e=m).replace(l,"."),"number"!==s.guessType(m)&&(m=e)),o[f][r]=m,m="",++f,++d};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(h(u),"#"===c&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(u)))return void p();if('"'===c)for(h(++u);u<t.length&&'"'!==c;)m+=c,h(++u);else c===e?p():m+=c}p()}}guessDelimiter(i){let a=0,l=0,e;const u={",":0,";":0,"\t":0},t=i.length;for(let e=0;e<t;e++){let t=!1,r,s,o,n="";if(13<e)break;var c=i[e];for(let e=0;e<c.length&&(r=c[e],s=c[e+1],o=c[e-1],"#"!==r);e++){if('"'===r)if(t){if('"'!==o&&'"'!==s){for(;" "===s&&e<c.length;)s=c[++e];void 0!==u[s]&&u[s]++,t=!1}}else t=!0;else void 0!==u[r]?(n=n.trim(),isNaN(Date.parse(n))&&!isNaN(Number(n))&&isFinite(Number(n))||u[r]++,n=""):n+=r;","===r&&l++,"."===r&&a++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),a>l?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return w.getTableFromColumns(this.columns,this.headers)}}M.defaultOptions={...w.defaultOptions,lineDelimiter:"\n"},w.registerType("CSV",M);const bt=M,{merge:wt,defined:Ct}=o();class Rt extends y{constructor(e,t){e=wt(Rt.defaultOptions,e);super(e,t),this.options=Ct(t)?wt(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const r=this,s=r.dataTables,{csv:e,csvURL:o,dataModifier:n,dataTables:i}=r.options;return r.emit({type:"load",csv:e,detail:t,tables:s}),Promise.resolve(o?fetch(o,{signal:r?.pollingController?.signal}).then(e=>e.text()):e||"").then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=i?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new bt(wt(this.options,r))},(e,t)=>{e.parse({csv:t})}),r.setModifierOptions(n,i).then(()=>e))).then(e=>(r.emit({type:"afterLoad",csv:e,detail:t,tables:s}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e})}}Rt.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},y.registerType("CSV",Rt);const{error:vt,isArray:Nt,merge:Tt,objectEach:Ot}=o();class F extends w{constructor(e){e=Tt(F.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.options=e,this.table=new m}parse(e,t){var s=this;const{beforeParse:r,orientation:o,firstRowAsNames:n,columnNames:i}=e=Tt(s.options,e);let a=e.data;if(a){if(s.columns=[],s.emit({type:"parse",columns:s.columns,detail:t,headers:s.headers}),a=(a=r?r(a):a).slice(),"columns"===o)for(let e=0,t=a.length;e<t;e++){const l=a[e];if(!(l instanceof Array))return;s.headers instanceof Array?(n?s.headers.push(""+l.shift()):i&&i instanceof Array&&s.headers.push(i[e]),s.table.setColumn(s.headers[e]||e.toString(),l)):vt("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===o){n?s.headers=a.shift():i&&(s.headers=i);for(let e=0,t=a.length;e<t;e++){let r=a[e];if(Nt(r))for(let e=0,t=r.length;e<t;e++)s.columns.length<e+1&&s.columns.push([]),s.columns[e].push(r[e]),s.headers instanceof Array?this.table.setColumn(s.headers[e]||e.toString(),s.columns[e]):vt("JSONConverter: Invalid `columnNames` option.",!1);else{const i=s.headers;if(i&&!(i instanceof Array)){const u={};Ot(i,(e,t)=>{u[t]=e.reduce((e,t)=>e[t],r)}),r=u}this.table.setRows([r],e)}}}s.emit({type:"afterParse",columns:s.columns,detail:t,headers:s.headers})}}getTable(){return this.table}}F.defaultOptions={...w.defaultOptions,data:[],orientation:"rows"},w.registerType("JSON",F);const At=F,{merge:xt,defined:It}=o();class Mt extends y{constructor(e,t){e=xt(Mt.defaultOptions,e);super(e,t),this.options=It(t)?xt(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const r=this,s=r.dataTables,{data:e,dataUrl:o,dataModifier:n,dataTables:i}=r.options;return r.emit({type:"load",data:e,detail:t,tables:s}),Promise.resolve(o?fetch(o,{signal:r?.pollingController?.signal}).then(e=>e.json()).catch(e=>{r.emit({type:"loadError",detail:t,error:e,tables:s}),console.warn(`Unable to fetch data from ${o}.`)}):e||[]).then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=i?.find(e=>e.key===t),r={dataTableKey:t,columnNames:r?.columnNames??e.columnNames,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,orientation:r?.orientation??e.orientation,beforeParse:r?.beforeParse??e.beforeParse};return new At(xt(this.options,r))},(e,t)=>{e.parse({data:t})}),r.setModifierOptions(n,i).then(()=>e))).then(e=>(r.emit({type:"afterLoad",data:e,detail:t,tables:s}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e})}}Mt.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},y.registerType("JSON",Mt);const{merge:Ft,uniqueKey:Et}=o();class E extends w{constructor(e){e=Ft(E.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const s=this,o=Ft(s.options,e);let n=(o.json?.values||[]).map(e=>e.slice());if(0===n.length)return!1;s.header=[],s.columns=[],s.emit({type:"parse",columns:s.columns,detail:t,headers:s.header});const{beforeParse:r,json:i}=o;r&&i&&(n=r(i.values));let a;for(let r=0,e=(s.columns=n).length;r<e;r++){a=n[r],s.header[r]=o.firstRowAsNames?""+a.shift():Et();for(let t=0,e=a.length;t<e;++t)if(a[t]&&"string"==typeof a[t]){let e=s.asGuessedType(a[t]);e instanceof Date&&(e=e.getTime()),s.columns[r][t]=e}}s.emit({type:"afterParse",columns:s.columns,detail:t,headers:s.header})}getTable(){return w.getTableFromColumns(this.columns,this.header)}}E.defaultOptions={...w.defaultOptions},w.registerType("GoogleSheets",E);const Pt=E,{merge:Dt,pick:jt,defined:Lt}=o();class P extends y{constructor(e,t){e=Dt(P.defaultOptions,e);super(e,t),this.options=Lt(t)?Dt(e,{dataTables:t}):e}load(t){const r=this,s=r.dataTables,{dataModifier:o,dataRefreshRate:e,enablePolling:n,googleAPIKey:i,googleSpreadsheetKey:a,dataTables:l}=r.options,u=P.buildFetchURL(i,a,r.options);if(r.emit({type:"load",detail:t,tables:s,url:u}),URL.canParse(u))return fetch(u,{signal:r?.pollingController?.signal}).then(e=>e.json()).then(e=>{if("object"==typeof(t=e)&&t&&"object"==typeof t.error&&t.error&&"number"==typeof t.error.code&&"string"==typeof t.error.message&&"string"==typeof t.error.status)throw new Error(e.error.message);var t;return this.initConverters(e,t=>{var e=this.options,r=l?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new Pt(Dt(this.options,r))},(e,t)=>{e.parse({json:t})}),r.setModifierOptions(o,l)}).then(()=>(r.emit({type:"afterLoad",detail:t,tables:s,url:u}),n&&setTimeout(()=>r.load(),1e3*Math.max(e||0,1)),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:s}),e});throw new Error("Invalid URL: "+u)}}P.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0};{var kt=P=P||{};const Qt="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function St(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:r,startColumn:s,startRow:o}=e;return r||(Qt[s||0]||"A")+(Math.max(o||0,0)+1)+":"+(Qt[jt(e,25)]||"Z")+(t?Math.max(t,0):"Z")}kt.buildFetchURL=function(e,t,r={}){const s=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`),o=(t=r.onlyColumnNames?"A1:Z1":St(r),s.pathname+=t,s.searchParams);return o.set("alt","json"),r.onlyColumnNames||(o.set("dateTimeRenderOption","FORMATTED_STRING"),o.set("majorDimension","COLUMNS"),o.set("valueRenderOption","UNFORMATTED_VALUE")),o.set("prettyPrint","false"),o.set("key",e),s.href},kt.buildQueryRange=St}y.registerType("GoogleSheets",P);const Vt=o()["merge"];class D extends w{constructor(e){e=Vt(D.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,t=this.options){var r=!1!==t.firstRowAsNames,s=t.useMultiLevelHeaders;const o=e.getSortedColumns(t.usePresentationOrder),n=Object.keys(o),i=[],a=n.length,l=[];let u="";if(r){const g=[];if(s){for(const p of n){let e=o[p];var c=((e=Array.isArray(e)?e:Array.from(e)).shift()||"").toString();o[p]=e,g.push(c)}u=this.getTableHeaderHTML(n,g,t)}else u=this.getTableHeaderHTML(void 0,n,t)}for(let r=0;r<a;r++){var m=n[r],d=o[m],f=d.length;for(let t=0;t<f;t++){let e=d[t];l[t]||(l[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),l[t][r]=this.getCellHTMLFromValue(r?"td":"th",null,r?"":'scope="row"',e),r===a-1&&i.push("<tr>"+l[t].join("")+"</tr>")}}let h="";return"<table>"+(h=t.tableCaption?'<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>":h)+u+"<tbody>"+i.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,r,s,o){let n=s,i="text"+(t?" "+t:"");return"number"==typeof n?(n=n.toString(),","===o&&(n=n.replace(".",o)),i="number"):s||(n="",i="empty"),"<"+e+(r?" "+r:"")+' class="'+i+'">'+n+"</"+e+">"}getTableHeaderHTML(e=[],t=[],r=this.options){var{useMultiLevelHeaders:r,useRowspanHeaders:s}=r;let o="<thead>",n=0,i=t&&t.length,a,l=0,u;if(r&&e&&t&&!function(e,t){let r=e.length;if(t.length===r){for(;--r;)if(e[r]!==t[r])return;return 1}}(e,t)){for(o+="<tr>";n<i;++n)(a=e[n])===e[n+1]?++l:l?(o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',a),l=0):(a===t[n]?s?(u=2,delete t[n]):(u=1,t[n]=""):u=1,o+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<u?' valign="top" rowspan="'+u+'"':""),a));o+="</tr>"}if(t){for(o+="<tr>",n=0,i=t.length;n<i;++n)void 0!==t[n]&&(o+=this.getCellHTMLFromValue("th",null,'scope="col"',t[n]));o+="</tr>"}return o+="</thead>"}parse(e,t){const n=this,i=[],a=[],l=Vt(n.options,e),{endRow:u,startColumn:c,endColumn:m,firstRowAsNames:d}=l,f=l.tableElement||this.tableElement;if(f instanceof HTMLElement){n.tableElement=f,n.tableElementID=f.id,this.emit({type:"parse",columns:n.columns,detail:t,headers:n.headers});var h=f.getElementsByTagName("tr"),g=h.length;let r=0,s,o=l["startRow"];if(d&&g){var p=h[0].children,y=p.length;for(let e=c;e<y&&!(e>m);e++)"TD"!==(s=p[e]).tagName&&"TH"!==s.tagName||a.push(s.innerHTML);o++}for(;r<g;){if(r>=o&&r<=u){var b=h[r].children,w=b.length;let e=0;for(;e<w;){const C=e-c,R=i[C];if(("TD"===(s=b[e]).tagName||"TH"===s.tagName)&&e>=c&&e<=m){i[C]||(i[C]=[]);let e=n.asGuessedType(s.innerHTML),t=(e instanceof Date&&(e=e.getTime()),i[C][r-o]=e,1);for(;r-o>=t&&void 0===R[r-o-t];)R[r-o-t]=null,t++}e++}}r++}this.columns=i,this.headers=a,this.emit({type:"afterParse",columns:i,detail:t,headers:a})}else n.emit({type:"parseError",columns:i,detail:t,headers:a,error:"Not a valid HTML Table"})}getTable(){return w.getTableFromColumns(this.columns,this.headers)}}D.defaultOptions={...w.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},w.registerType("HTMLTable",D);const Yt=D,Ut=o()["win"],$t=o()["merge"];class Ht extends y{constructor(e){e=$t(Ht.defaultOptions,e);super(e),this.converter=new Yt(e),this.options=e}load(e){const t=this,r=t.converter,s=t.table,{dataModifier:o,table:n}=t.options;t.emit({type:"load",detail:e,tables:{table:s},tableElement:t.tableElement});let i;var a;return"string"==typeof n?(t.tableID=n,i=Ut.document.getElementById(n)):(i=n,t.tableID=i.id),t.tableElement=i||void 0,t.tableElement?(r.parse($t({tableElement:t.tableElement},t.options),e),s.deleteColumns(),s.setColumns(r.getTable().getColumns()),t.setModifierOptions(o).then(()=>(t.emit({type:"afterLoad",detail:e,tables:{table:s},tableElement:t.tableElement}),t))):(t.emit({type:"loadError",detail:e,error:a="HTML table not provided, or element with ID not found",tables:{table:s}}),Promise.reject(new Error(a)))}}Ht.defaultOptions={table:""},y.registerType("HTMLTable",Ht);const _t=o()["merge"];class Bt extends i{constructor(e,...o){super(),this.chain=o,this.options=_t(Bt.defaultOptions,e);var n=this.options.chain||[];for(let e=0,t=n.length,r,s;e<t;++e)(r=n[e]).type&&(s=i.types[r.type])&&o.push(new s(r))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}async modify(r,s){const o=this.options.reverse?this.chain.slice().reverse():this.chain.slice();r.modified===r&&(r.modified=r.clone(!1,s));let n=r;for(let e=0,t=o.length;e<t;++e){try{await o[e].modify(n,s)}catch(e){throw this.emit({type:"error",detail:s,table:r}),e}n=n.modified}return r.modified=n,r}modifyCell(e,s,o,n,i){const a=this.options.reverse?this.chain.reverse():this.chain;if(a.length){let r=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyCell(r,s,o,n,i),r=r.modified;e.modified=r}return e}modifyColumns(e,s,o,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let r=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyColumns(r,s,o,n),r=r.modified;e.modified=r}return e}modifyRows(e,s,o,n){const i=this.options.reverse?this.chain.reverse():this.chain.slice();if(i.length){let r=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyRows(r,s,o,n),r=r.modified;e.modified=r}return e}modifyTable(e,s){var t=this,o=(t.emit({type:"modify",detail:s,table:e}),t.options.reverse?t.chain.reverse():t.chain.slice());let n=e.modified;for(let e=0,t=o.length,r;e<t;++e)r=o[e],n=r.modifyTable(n,s).modified;return e.modified=n,t.emit({type:"afterModify",detail:s,table:e}),e}remove(e,t){const r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),r.splice(r.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}Bt.defaultOptions={type:"Chain"},i.registerType("Chain",Bt);const Gt=o()["merge"];class Kt extends i{constructor(e){super(),this.options=Gt(Kt.defaultOptions,e)}modifyCell(e,t,r,s,o){const n=e.modified,i=n.getRowIndexBy("columnNames",t);return void 0===i?n.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,o):n.setCell(""+r,i,s,o),e}modifyColumns(e,n,i,a){const l=e.modified,r=l.getColumn("columnNames")||[];let u=e.getColumnNames(),s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=u.length;e<t;++e)if(u[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,a);for(let e=0,t=(u=Object.keys(n)).length,s,r,o;e<t;++e){s=n[r=u[e]],o=l.getRowIndexBy("columnNames",r)||l.getRowCount();for(let e=0,t=i,r=s.length;e<r;++e,++t)l.setCell(""+t,o,s[e],a)}return e}modifyRows(e,o,n,i){const a=e.getColumnNames(),l=e.modified,r=l.getColumn("columnNames")||[];let s=e.getRowCount()!==r.length;if(!s)for(let e=0,t=a.length;e<t;++e)if(a[e]!==r[e]){s=!0;break}if(s)return this.modifyTable(e,i);for(let e=0,r=n,t=o.length,s;e<t;++e,++r)if((s=o[e])instanceof Array)l.setColumn(""+r,s);else for(let e=0,t=a.length;e<t;++e)l.setCell(""+r,e,s[a[e]],i);return e}modifyTable(s,e){this.emit({type:"modify",detail:e,table:s});const t=s.modified;if(s.hasColumns(["columnNames"])){const r=(s.deleteColumns(["columnNames"])||{}).columnNames||[],o={},n=[];for(let e=0,t=r.length;e<t;++e)n.push(""+r[e]);for(let e=0,t=s.getRowCount(),r;e<t;++e)(r=s.getRow(e))&&(o[n[e]]=r);t.deleteColumns(),t.setColumns(o)}else{const i={};for(let e=0,t=s.getRowCount(),r;e<t;++e)(r=s.getRow(e))&&(i[""+e]=r);i.columnNames=s.getColumnNames(),t.deleteColumns(),t.setColumns(i)}return this.emit({type:"afterModify",detail:e,table:s}),s}}Kt.defaultOptions={type:"Invert"},i.registerType("Invert",Kt);class Zt extends i{constructor(e){super(),this.options={...Zt.defaultOptions,...e}}modifyTable(o,e){var n=this;n.emit({type:"modify",detail:e,table:o});const i=n.options.alternativeSeparators,s=n.options.formulaColumns||o.getColumnNames(),a=o.modified;for(let e=0,t=s.length,r;e<t;++e)r=s[e],0<=s.indexOf(r)&&a.setColumn(r,n.processColumn(o,r));var l=n.options.columnFormulas||[];for(let e=0,t=l.length,r,s;e<t;++e)r=l[e],s=we.parseFormula(r.formula,i),a.setColumn(r.column,n.processColumnFormula(s,o,r.rowStart,r.rowEnd));return n.emit({type:"afterModify",detail:e,table:o}),o}processColumn(o,e,t=0){const n=this.options.alternativeSeparators,i=(o.getColumn(e,!0)||[]).slice(0<t?t:0);for(let e=0,t=i.length,r=[],s;e<t;++e)if("string"==typeof(s=i[e])&&"="===s[0])try{r=""===s?r:we.parseFormula(s.substring(1),n),i[e]=I.processFormula(r,o)}catch{i[e]=NaN}return i}processColumnFormula(r,e,s=0,o=e.getRowCount()){s=0<=s?s:0,o=0<=o?o:e.getRowCount()+o;const n=[],i=e.modified;for(let e=0,t=o-s;e<t;++e)try{n[e]=I.processFormula(r,i)}catch{n[e]=NaN}finally{r=I.translateReferences(r,0,1)}return n}}Zt.defaultOptions={type:"Math",alternativeSeparators:!1},i.registerType("Math",Zt);const Jt=o()["merge"];class Xt extends i{constructor(e){super(),this.options=Jt(Xt.defaultOptions,e)}modifyTable(u,e){this.emit({type:"modify",detail:e,table:u});let c=[];var{additive:m,ranges:r,strict:d}=this.options;if(r.length){const f=u.modified;let a=u.getColumns(),l=[];for(let e=0,t=r.length,n,i;e<t;++e)if(n=r[e],!d||typeof n.minValue==typeof n.maxValue){0<e&&!m&&(f.deleteRows(),f.setRows(l),f.setOriginalRowIndexes(c,!0),a=f.getColumns(),l=[],c=[]);for(let e=0,t=(i=a[n.column]||[]).length,r,s,o;e<t;++e){switch(typeof(r=i[e])){default:continue;case"boolean":case"number":case"string":}d&&typeof r!=typeof n.minValue||r>=n.minValue&&r<=n.maxValue&&(o=m?(s=u.getRow(e),u.getOriginalRowIndex(e)):(s=f.getRow(e),f.getOriginalRowIndex(e)),s&&(l.push(s),c.push(o)))}}f.deleteRows(),f.setRows(l),f.setOriginalRowIndexes(c)}return this.emit({type:"afterModify",detail:e,table:u}),u}}Xt.defaultOptions={type:"Range",ranges:[]},i.registerType("Range",Xt);const qt=o()["merge"];class j extends i{static ascending(e,t){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0}static descending(e,t){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0}constructor(e){super(),this.options=qt(j.defaultOptions,e)}getRowReferences(e){const r=e.getRows(),s=[];for(let e=0,t=r.length;e<t;++e)s.push({index:e,row:r[e]});return s}modifyCell(e,t,r,s,o){var{orderByColumn:n,orderInColumn:i}=this.options;return t===n&&(i?(e.modified.setCell(t,r,s),e.modified.setColumn(i,this.modifyTable(new m({columns:e.getColumns([n,i])})).modified.getColumn(i))):this.modifyTable(e,o)),e}modifyColumns(e,t,r,s){const{orderByColumn:o,orderInColumn:n}=this.options,i=Object.keys(t);return-1<i.indexOf(o)&&(n&&t[i[0]].length?(e.modified.setColumns(t,r),e.modified.setColumn(n,this.modifyTable(new m({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s)),e}modifyRows(e,t,r,s){var{orderByColumn:o,orderInColumn:n}=this.options;return n&&t.length?(e.modified.setRows(t,r),e.modified.setColumn(n,this.modifyTable(new m({columns:e.getColumns([o,n])})).modified.getColumn(n))):this.modifyTable(e,s),e}modifyTable(e,t){var r;this.emit({type:"modify",detail:t,table:e});const s=e.getColumnNames(),o=e.getRowCount(),n=this.getRowReferences(e),{direction:i,orderByColumn:a,orderInColumn:l}=this.options,u="asc"===i?j.ascending:j.descending,c=s.indexOf(a),m=e.modified;if(-1!==c&&n.sort((e,t)=>u(e.row[c],t.row[c])),l){const d=[];for(let e=0;e<o;++e)d[n[e].index]=e;m.setColumns({[l]:d})}else{const f=[],h=[];for(let e=0;e<o;++e)r=n[e],f.push(m.getOriginalRowIndex(r.index)),h.push(r.row);m.setRows(h,0),m.setOriginalRowIndexes(f)}return this.emit({type:"afterModify",detail:t,table:e}),e}}j.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},i.registerType("Sort",j);const L=o(),zt=(L.DataConnector=L.DataConnector||y,L.DataConverter=L.DataConverter||w,L.DataCursor=L.DataCursor||e,L.DataModifier=L.DataModifier||i,L.DataPool=L.DataPool||R,L.DataTable=L.DataTable||m,L.Formula=L.Formula||v,o());return V.default})());
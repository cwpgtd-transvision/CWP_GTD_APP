import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";import*as __WEBPACK_EXTERNAL_MODULE__modules_stock_src_js_b3d80146__ from"../modules/stock.src.js";var __webpack_require__={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(r,{a:r}),r},d:(e,r)=>{for(var t in r)__webpack_require__.o(r,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject),x=e=>{var r={};return __webpack_require__.d(r,e),r},y=e=>()=>e;const stock_src_js_namespaceObject=x({}),external_highcharts_src_js_default_SeriesRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SeriesRegistry;var external_highcharts_src_js_default_SeriesRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_SeriesRegistry_namespaceObject);const{atr:ATRIndicator,sma:SMAIndicator}=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes,{addEvent,correctFloat,isArray,isNumber,extend,merge,objectEach}=external_highcharts_src_js_default_default();function createPointObj(e,r){return{index:r,close:e.getColumn("close")[r],x:e.getColumn("x")[r]}}class SupertrendIndicator extends SMAIndicator{init(){const t=this,o=(super.init.apply(t,arguments),addEvent(this.chart.constructor,"afterLinkSeries",()=>{if(t.options){const e=t.options,r=t.linkedParent.options;e.cropThreshold=r.cropThreshold-(e.params.period-1)}o()},{order:1}))}drawGraph(){const t=this,e=t.options,r=t.linkedParent,o=r.getColumn("x"),s=r?r.points:[],l=t.points,i=t.graph,n=s.length-l.length,a=0<n?n:0,_={options:{gapSize:e.gapSize}},c={top:[],bottom:[],intersect:[]},d={top:{styles:{lineWidth:e.lineWidth,lineColor:e.fallingTrendColor||e.color,dashStyle:e.dashStyle}},bottom:{styles:{lineWidth:e.lineWidth,lineColor:e.risingTrendColor||e.color,dashStyle:e.dashStyle}},intersect:e.changeTrendLine};let p,h,u,g,x,m,f,y,b,j=l.length;for(;j--;)p=l[j],h=l[j-1],u=s[j-1+a],g=s[j-2+a],x=s[j+a],m=s[j+a+1],f=p.options.color,y={x:p.x,plotX:p.plotX,plotY:p.plotY,isNull:!1},!g&&u&&isNumber(o[u.index-1])&&(g=createPointObj(r,u.index-1)),!m&&x&&isNumber(o[x.index+1])&&(m=createPointObj(r,x.index+1)),!u&&g&&isNumber(o[g.index+1])?u=createPointObj(r,g.index+1):!u&&x&&isNumber(o[x.index-1])&&(u=createPointObj(r,x.index-1)),p&&u&&x&&g&&p.x!==u.x&&(p.x===x.x?(g=u,u=x):p.x===g.x?(u=g,g={close:r.getColumn("close")[u.index-1],x:o[u.index-1]}):m&&p.x===m.x&&(u=m,g=x)),h&&g&&u?(b={x:h.x,plotX:h.plotX,plotY:h.plotY,isNull:!1},p.y>=u.close&&h.y>=g.close?(p.color=f||e.fallingTrendColor||e.color,c.top.push(y)):p.y<u.close&&h.y<g.close?(p.color=f||e.risingTrendColor||e.color,c.bottom.push(y)):(c.intersect.push(y),c.intersect.push(b),c.intersect.push(merge(b,{isNull:!0})),p.y>=u.close&&h.y<g.close?(p.color=f||e.fallingTrendColor||e.color,h.color=f||e.risingTrendColor||e.color,c.top.push(y),c.top.push(merge(b,{isNull:!0}))):p.y<u.close&&h.y>=g.close&&(p.color=f||e.risingTrendColor||e.color,h.color=f||e.fallingTrendColor||e.color,c.bottom.push(y),c.bottom.push(merge(b,{isNull:!0}))))):u&&(p.y>=u.close?(p.color=f||e.fallingTrendColor||e.color,c.top.push(y)):(p.color=f||e.risingTrendColor||e.color,c.bottom.push(y)));objectEach(c,function(e,r){t.points=e,t.options=merge(d[r].styles,_),t.graph=t["graph"+r+"Line"],SMAIndicator.prototype.drawGraph.call(t),t["graph"+r+"Line"]=t.graph}),t.points=l,t.options=e,t.graph=i}getValues(e,r){const t=r.period,o=r.multiplier,s=e.xData,l=e.yData,i=[],n=[],a=[],_=0===t?0:t-1,c=[],d=[];let p,h,u,g,x,m,f,y,b,j;if(!(s.length<=t||!isArray(l[0])||4!==l[0].length||t<0)){for(p=ATRIndicator.prototype.getValues.call(this,e,{period:t}).yData,j=0;j<p.length;j++)b=l[_+j],y=l[_+j-1]||[],x=c[j-1],m=d[j-1],f=a[j-1],0===j&&(x=m=f=0),h=correctFloat((b[1]+b[2])/2+o*p[j]),u=correctFloat((b[1]+b[2])/2-o*p[j]),h<x||y[3]>x?c[j]=h:c[j]=x,u>m||y[3]<m?d[j]=u:d[j]=m,f===x&&b[3]<c[j]||f===m&&b[3]<d[j]?g=c[j]:(f===x&&b[3]>c[j]||f===m&&b[3]>d[j])&&(g=d[j]),i.push([s[_+j],g]),n.push(s[_+j]),a.push(g);return{values:i,xData:n,yData:a}}}}SupertrendIndicator.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),extend(SupertrendIndicator.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("supertrend",SupertrendIndicator);const Supertrend_SupertrendIndicator=null,supertrend_src=external_highcharts_src_js_default_default();export{supertrend_src as default};
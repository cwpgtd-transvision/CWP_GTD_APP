import*as e from"../highcharts.js";import"../modules/stock.js";var t,a={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},d:(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};let o=e.default;var i=a.n(o);a.d({},{});let s={getArrayExtremes:function(e,a,i){return e.reduce((e,t)=>[Math.min(e[0],t[a]),Math.max(e[1],t[i])],[Number.MAX_VALUE,-Number.MAX_VALUE])}},r=e.default.SeriesRegistry;var n=a.n(r);let{prototype:l}=n().seriesTypes["sma"],{defined:p,error:h,merge:c}=i(),u=(!function(e){let a=["bottomLine"],i=["top","bottom"],o=["top"];function x(e){return"plot"+e.charAt(0).toUpperCase()+e.slice(1)}function N(e,t){let a=[];return(e.pointArrayMap||[]).forEach(e=>{e!==t&&a.push(x(e))}),a}function r(){let a=this,e=a.pointValKey,t=a.linesApiNames,i=a.areaLinesNames,o=a.points,r=a.options,s=a.graph,n={options:{gapSize:r.gapSize}},u=[],d=N(a,e),m=o.length,y;var f,g,A;d.forEach((e,t)=>{for(u[t]=[];m--;)y=o[m],u[t].push({x:y.x,plotX:y.plotX,plotY:y[e],isNull:!p(y[e])});m=o.length}),a.userOptions.fillColor&&i.length&&(f=u[d.indexOf(x(i[0]))],g=1===i.length?o:u[d.indexOf(x(i[1]))],A=a.color,a.points=g,a.nextPoints=f,a.color=a.userOptions.fillColor,a.options=c(o,n),a.graph=a.area,a.fillGraph=!0,l.drawGraph.call(a),a.area=a.graph,delete a.nextPoints,delete a.fillGraph,a.color=A),t.forEach((e,t)=>{u[t]?(a.points=u[t],r[e]?a.options=c(r[e].styles,n):h('Error: "There is no '+e+' in DOCS options declared. Check if linesApiNames are consistent with your DOCS line names."'),a.graph=a["graph"+e],l.drawGraph.call(a),a["graph"+e]=a.graph):h('Error: "'+e+" doesn't have equivalent in pointArrayMap. To many elements in linesApiNames relative to pointArrayMap.\"")}),a.points=o,a.options=r,a.graph=s,l.drawGraph.call(a)}function s(e){let t,a=[],i;if(e=e||this.points,this.fillGraph&&this.nextPoints){if((t=l.getGraphPath.call(this,this.nextPoints))&&t.length){t[0][0]="L",a=l.getGraphPath.call(this,e);for(let e=(i=t.slice(0,a.length)).length-1;0<=e;e--)a.push(i[e])}}else a=l.getGraphPath.apply(this,arguments);return a}function n(t){let a=[];return(this.pointArrayMap||[]).forEach(e=>{a.push(t[e])}),a}function u(){let e=this.pointArrayMap,i,o;i=N(this),l.translate.apply(this,arguments),this.points.forEach(a=>{e.forEach((e,t)=>{o=a[e],null!==(o=this.dataModify?this.dataModify.modifyValue(o):o)&&(a[i[t]]=this.yAxis.toPixels(o,!0))})})}e.compose=function(e){let t=e.prototype;return t.linesApiNames=t.linesApiNames||a.slice(),t.pointArrayMap=t.pointArrayMap||i.slice(),t.pointValKey=t.pointValKey||"top",t.areaLinesNames=t.areaLinesNames||o.slice(),t.drawGraph=r,t.getGraphPath=s,t.toYData=n,t.translate=u,e}}(t=t||{}),t),d=n().seriesTypes["sma"],{extend:m,isArray:y,merge:f}=i();class g extends d{init(){super.init.apply(this,arguments),this.options=f({smoothedLine:{styles:{lineColor:this.color}}},this.options)}getValues(e,t){let a=t.periods[0],i=t.periods[1],o=e.xData,r=e.yData,n=r?r.length:0,l=[],p=[],h=[],u,d,c,m=null,f,g;if(!(n<a)&&y(r[0])&&4===r[0].length){let e=!0,t=0;for(g=a-1;g<n;g++){var A;(u=r.slice(g-a+1,g+1),d=(f=s.getArrayExtremes(u,2,1))[0],isNaN(c=(r[g][3]-d)/(f[1]-d)*100)&&e)?t++:(e&&!isNaN(c)&&(e=!1),A=p.push(o[g]),isNaN(c)?h.push([h[A-2]&&"number"==typeof h[A-2][0]?h[A-2][0]:null,null]):h.push([c,null]),g>=t+(a-1)+(i-1)&&(m=super.getValues({xData:p.slice(-i),yData:h.slice(-i)},{period:i}).yData[0]),l.push([o[g],c,m]),h[A-1][1]=m)}return{values:l,xData:p,yData:h}}}}g.defaultOptions=f(d.defaultOptions,{params:{index:void 0,period:void 0,periods:[14,3]},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>%K: {point.y}<br/>%D: {point.smoothed}<br/>'},smoothedLine:{styles:{lineWidth:1,lineColor:void 0}},dataGrouping:{approximation:"averages"}}),m(g.prototype,{areaLinesNames:[],nameComponents:["periods"],nameBase:"Stochastic",pointArrayMap:["y","smoothed"],parallelArrays:["x","y","smoothed"],pointValKey:"y",linesApiNames:["smoothedLine"]}),u.compose(g),n().registerSeriesType("stochastic",g);let A=i();export{A as default};
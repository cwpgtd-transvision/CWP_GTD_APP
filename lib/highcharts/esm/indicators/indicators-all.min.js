import*as e from"../highcharts.js";import*as t from"../modules/datagrouping.js";import"../modules/stock.js";var s,a={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},d:(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};let o=e.default;var i=a.n(o);let n=e.default.Chart;var r=a.n(n);let l=e.default.SeriesRegistry;var p=a.n(l);let u=p().seriesTypes["line"],{addEvent:h,fireEvent:d,error:c,extend:m,isArray:g,merge:y,pick:f}=i(),x=(t,s)=>{let e=[],a=t.pointArrayMap,o=s&&t.dataTable.modified||t.dataTable;if(!a)return t.getColumn("y",s);let i=a.map(e=>t.getColumn(e,s));for(let s=0;s<o.rowCount;s++){var r=a.map((e,t)=>i[t]?.[s]||0);e.push(r)}return e};class D extends u{destroy(){this.dataEventsToUnbind.forEach(function(e){e()}),super.destroy.apply(this,arguments)}getName(){let s=[],e=this.name;return e||((this.nameComponents||[]).forEach(function(e,t){s.push(this.options.params[e]+f(this.nameSuffixes[t],""))},this),e=(this.nameBase||this.type.toUpperCase())+(this.nameComponents?" ("+s.join(", ")+")":"")),e}getValues(e,t){let s=t.period,a=e.xData||[],o=e.yData,i=o.length,r=[],n=[],l=[],p,u=-1,h=0,d,c=0;if(!(a.length<s)){for(g(o[0])&&(u=t.index||0);h<s-1;)c+=u<0?o[h]:o[h][u],h++;for(p=h;p<i;p++)c+=u<0?o[p]:o[p][u],d=[a[p],c/s],r.push(d),n.push(d[0]),l.push(d[1]),c-=u<0?o[p-h]:o[p-h][u];return{values:r,xData:n,yData:l}}}init(t,e){let s=this;super.init.call(s,t,e);e=h(r(),"afterLinkSeries",function({isUpdating:e}){if(!e){e=!!s.dataEventsToUnbind.length;if(!s.linkedParent)return c("Series "+s.options.linkedTo+" not found! Check `linkedTo`.",!1,t);if(e||(s.dataEventsToUnbind.push(h(s.linkedParent,"updatedData",function(){s.recalculateValues()})),s.calculateOn.xAxis&&s.dataEventsToUnbind.push(h(s.linkedParent.xAxis,s.calculateOn.xAxis,function(){s.recalculateValues()}))),"init"===s.calculateOn.chart)s.closestPointRange||s.recalculateValues();else if(!e){let e=h(s.chart,s.calculateOn.chart,function(){s.recalculateValues(),e()})}}},{order:0});s.dataEventsToUnbind=[],s.eventsToUnbind.push(e)}recalculateValues(){let a=[],t=this.dataTable,o=this.points||[],e=this.dataTable.rowCount,s=!0,i,r,n,l,p=this.linkedParent.yData,u=this.linkedParent.processedYData,h=(this.linkedParent.xData=this.linkedParent.getColumn("x"),this.linkedParent.yData=x(this.linkedParent),this.linkedParent.processedYData=x(this.linkedParent,!0),this.linkedParent.options&&this.linkedParent.dataTable.rowCount&&this.getValues(this.linkedParent,this.options.params)||{values:[],xData:[],yData:[]}),c=(delete this.linkedParent.xData,this.linkedParent.yData=p,this.linkedParent.processedYData=u,this.pointArrayMap||["y"]),m={};if(h.yData.forEach(a=>{c.forEach((e,t)=>{let s=m[e]||[];s.push(g(a)?a[t]:a),m[e]||(m[e]=s)})}),e&&!this.hasGroupedData&&this.visible&&this.points)if(this.cropped){this.xAxis&&(n=this.xAxis.min,l=this.xAxis.max);let e=this.cropData(t,n,l),s=["x",...this.pointArrayMap||["y"]];for(let t=0;t<(e.modified?.rowCount||0);t++){var y=s.map(e=>this.getColumn(e)[t]||0);a.push(y)}var f=this.getColumn("x");i=h.xData.indexOf(f[0]),r=h.xData.indexOf(f[f.length-1]),-1===i&&r===h.xData.length-2&&a[0][0]===o[0].x&&a.shift(),this.updateData(a)}else(this.updateAllPoints||h.xData.length!==e-1&&h.xData.length!==e+1)&&(s=!1,this.updateData(h.values));s&&(t.setColumns({...m,x:h.xData}),this.options.data=h.values),this.calculateOn.xAxis&&this.getColumn("x",!0).length&&(this.isDirty=!0,this.redraw()),this.isDirtyData=!!this.linkedSeries.length,d(this,"updatedData")}processData(){var e=this.options.compareToMain,t=this.linkedParent;super.processData.apply(this,arguments),this.dataModify&&t&&t.dataModify&&t.dataModify.compareValue&&e&&(this.dataModify.compareValue=t.dataModify.compareValue)}}D.defaultOptions=y(u.defaultOptions,{name:void 0,tooltip:{valueDecimals:4},linkedTo:void 0,compareToMain:!1,params:{index:3,period:14}}),m(D.prototype,{calculateOn:{chart:"init"},hasDerivedData:!0,nameComponents:["period"],nameSuffixes:[],useCommonDataGrouping:!0}),p().registerSeriesType("sma",D);let v=p().seriesTypes["sma"],{correctFloat:A,isArray:S,merge:b}=i();class T extends v{accumulatePeriodPoints(e,t,s){let a=0,o=0;for(;o<e;)a+=t<0?s[o]:s[o][t],o++;return a}calculateEma(e,t,s,a,o,i,r){e=e[s-1],t=i<0?t[s-1]:t[s-1][i];return[e,void 0===o?r:A(t*a+o*(1-a))]}getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=2/(s+1),n=[],l=[],p=[],u,h,d,c=-1,m;if(!(i<s)){for(S(o[0])&&(c=t.index||0),m=this.accumulatePeriodPoints(s,c,o)/s,d=s;d<i+1;d++)h=this.calculateEma(a,o,d,r,u,c,m),n.push(h),l.push(h[0]),p.push(h[1]),u=h[1];return{values:n,xData:l,yData:p}}}}T.defaultOptions=b(v.defaultOptions,{params:{index:3,period:9}}),p().registerSeriesType("ema",T);let C=p().seriesTypes["sma"],{error:P,extend:M,merge:V}=i();class L extends C{static populateAverage(e,t,s,a,o){var i=t[a][1],r=t[a][2],t=t[a][3],s=s[a];return[e[a],t===i&&t===r||i===r?0:(2*t-r-i)/(i-r)*s]}getValues(e,t){let s,a,o,i=t.period,r=e.xData,n=e.yData,l=t.volumeSeriesID,p=e.chart.get(l),u=p?.getColumn("y"),h=n?n.length:0,d=[],c=[],m=[];if(!(r.length<=i&&h&&4!==n[0].length)){if(p){for(a=i;a<h;a++)s=d.length,o=L.populateAverage(r,n,u,a,i),0<s&&(o[1]+=d[s-1][1]),d.push(o),c.push(o[0]),m.push(o[1]);return{values:d,xData:c,yData:m}}P("Series "+l+" not found! Check `volumeSeriesID`.",!0,e.chart)}}}L.defaultOptions=V(C.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume"}}),M(L.prototype,{nameComponents:!1,nameBase:"Accumulation/Distribution"}),p().registerSeriesType("ad",L);let k=i()["noop"],{column:{prototype:O},sma:E}=p().seriesTypes,{extend:w,merge:I,correctFloat:N,isArray:B}=i();class G extends E{drawGraph(){let e,t=this.options,s=this.points,a=this.userOptions.color,o=t.greaterBarColor,i=t.lowerBarColor,r=s[0];if(!a&&r)for(e=1,r.color=o;e<s.length;e++)s[e].y>s[e-1].y?s[e].color=o:s[e].y<s[e-1].y?s[e].color=i:s[e].color=s[e-1].color}getValues(e){let t=e.xData||[],s=e.yData||[],a=s.length,o=[],i=[],r=[],n,l,p,u,h,d,c=0,m=0;if(!(t.length<=34)&&B(s[0])&&4===s[0].length){for(h=0;h<33;h++)u=(s[h][1]+s[h][2])/2,29<=h&&(m=N(m+u)),c=N(c+u);for(d=33;d<a;d++)m=N(m+(u=(s[d][1]+s[d][2])/2)),c=N(c+u),n=N(m/5-c/34),o.push([t[d],n]),i.push(t[d]),r.push(n),l=d+1-5,p=d+1-34,m=N(m-(s[l][1]+s[l][2])/2),c=N(c-(s[p][1]+s[p][2])/2);return{values:o,xData:i,yData:r}}}}G.defaultOptions=I(E.defaultOptions,{params:{index:void 0,period:void 0},greaterBarColor:"#06b535",lowerBarColor:"#f21313",threshold:0,groupPadding:.2,pointPadding:.2,crisp:!1,states:{hover:{halo:{size:0}}}}),w(G.prototype,{nameBase:"AO",nameComponents:void 0,markerAttribs:k,getColumnMetrics:O.getColumnMetrics,crispCol:O.crispCol,translate:O.translate,drawPoints:O.drawPoints}),p().registerSeriesType("ao",G);let{prototype:W}=p().seriesTypes["sma"],{defined:z,error:Y,merge:F}=i(),X=(!function(e){let s=["bottomLine"],a=["top","bottom"],o=["top"];function g(e){return"plot"+e.charAt(0).toUpperCase()+e.slice(1)}function y(e,t){let s=[];return(e.pointArrayMap||[]).forEach(e=>{e!==t&&s.push(g(e))}),s}function i(){let s=this,e=s.pointValKey,t=s.linesApiNames,a=s.areaLinesNames,o=s.points,i=s.options,r=s.graph,n={options:{gapSize:i.gapSize}},l=[],p=y(s,e),u=o.length,h;var d,c,m;p.forEach((e,t)=>{for(l[t]=[];u--;)h=o[u],l[t].push({x:h.x,plotX:h.plotX,plotY:h[e],isNull:!z(h[e])});u=o.length}),s.userOptions.fillColor&&a.length&&(d=l[p.indexOf(g(a[0]))],c=1===a.length?o:l[p.indexOf(g(a[1]))],m=s.color,s.points=c,s.nextPoints=d,s.color=s.userOptions.fillColor,s.options=F(o,n),s.graph=s.area,s.fillGraph=!0,W.drawGraph.call(s),s.area=s.graph,delete s.nextPoints,delete s.fillGraph,s.color=m),t.forEach((e,t)=>{l[t]?(s.points=l[t],i[e]?s.options=F(i[e].styles,n):Y('Error: "There is no '+e+' in DOCS options declared. Check if linesApiNames are consistent with your DOCS line names."'),s.graph=s["graph"+e],W.drawGraph.call(s),s["graph"+e]=s.graph):Y('Error: "'+e+" doesn't have equivalent in pointArrayMap. To many elements in linesApiNames relative to pointArrayMap.\"")}),s.points=o,s.options=i,s.graph=r,W.drawGraph.call(s)}function r(e){let t,s=[],a;if(e=e||this.points,this.fillGraph&&this.nextPoints){if((t=W.getGraphPath.call(this,this.nextPoints))&&t.length){t[0][0]="L",s=W.getGraphPath.call(this,e);for(let e=(a=t.slice(0,s.length)).length-1;0<=e;e--)s.push(a[e])}}else s=W.getGraphPath.apply(this,arguments);return s}function n(t){let s=[];return(this.pointArrayMap||[]).forEach(e=>{s.push(t[e])}),s}function l(){let e=this.pointArrayMap,a,o;a=y(this),W.translate.apply(this,arguments),this.points.forEach(s=>{e.forEach((e,t)=>{o=s[e],null!==(o=this.dataModify?this.dataModify.modifyValue(o):o)&&(s[a[t]]=this.yAxis.toPixels(o,!0))})})}e.compose=function(e){let t=e.prototype;return t.linesApiNames=t.linesApiNames||s.slice(),t.pointArrayMap=t.pointArrayMap||a.slice(),t.pointValKey=t.pointValKey||"top",t.areaLinesNames=t.areaLinesNames||o.slice(),t.drawGraph=i,t.getGraphPath=r,t.toYData=n,t.translate=l,e}}(s=s||{}),s),R=p().seriesTypes["sma"],{extend:K,merge:U,pick:Z}=i();function j(e,t){let s=e[0],a=0,o;for(o=1;o<e.length;o++)("max"===t&&e[o]>=s||"min"===t&&e[o]<=s)&&(s=e[o],a=o);return a}class _ extends R{getValues(e,t){let s,a,o,i,r,n=t.period,l=e.xData,p=e.yData,u=p?p.length:0,h=[],d=[],c=[];for(i=n-1;i<u;i++)o=j((r=p.slice(i-n+1,i+2)).map(function(e){return Z(e[2],e)}),"min"),s=j(r.map(function(e){return Z(e[1],e)}),"max")/n*100,a=o/n*100,l[i+1]&&(h.push([l[i+1],s,a]),d.push(l[i+1]),c.push([s,a]));return{values:h,xData:d,yData:c}}}_.defaultOptions=U(R.defaultOptions,{params:{index:void 0,period:25},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b><br/>Aroon Up: {point.y}<br/>Aroon Down: {point.aroonDown}<br/>'},aroonDown:{styles:{lineWidth:1,lineColor:void 0}},dataGrouping:{approximation:"averages"}}),K(_.prototype,{areaLinesNames:[],linesApiNames:["aroonDown"],nameBase:"Aroon",pointArrayMap:["y","aroonDown"],pointValKey:"y"}),X.compose(_),p().registerSeriesType("aroon",_);let q=p().seriesTypes["aroon"],{extend:H,merge:$}=i();class J extends q{getValues(e,t){let s,a,o=[],i=[],r=[],n=super.getValues.call(this,e,t);for(a=0;a<n.yData.length;a++)s=n.yData[a][0]-n.yData[a][1],o.push([n.xData[a],s]),i.push(n.xData[a]),r.push(s);return{values:o,xData:i,yData:r}}}J.defaultOptions=$(q.defaultOptions,{tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b>: {point.y}'}}),H(J.prototype,{nameBase:"Aroon Oscillator",linesApiNames:[],pointArrayMap:["y"],pointValKey:"y"}),X.compose(q),p().registerSeriesType("aroonoscillator",J);let Q=p().seriesTypes["sma"],{isArray:ee,merge:et}=i();function es(e,t){var s=e[1]-e[2];return Math.max(s,void 0===t?0:Math.abs(e[1]-t[3]),void 0===t?0:Math.abs(e[2]-t[3]))}class ea extends Q{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=[[a[0],o[0]]],n=[],l=[],p=[],u,h,d=0,c=1,m=0;if(!(a.length<=s)&&ee(o[0])&&4===o[0].length){for(h=1;h<=i;h++){var g,y=h,f=a[y],y=o[y];r.push([f,y]),s<c?(d=(f=h,y=s,g=d,(u=[a[f-1],(g*(y-1)+es(o[f-1],o[f-2]))/y])[1]),n.push(u),l.push(u[0]),p.push(u[1])):(s===c?(d=m/(h-1),n.push([a[h-1],d]),l.push(a[h-1]),p.push(d)):m+=es(o[h-1],o[h-2]),c++)}return{values:n,xData:l,yData:p}}}}ea.defaultOptions=et(Q.defaultOptions,{params:{index:void 0}}),p().registerSeriesType("atr",ea);let eo=p().seriesTypes["sma"],{extend:ei,isArray:en,merge:er}=i();class el extends eo{init(){p().seriesTypes.sma.prototype.init.apply(this,arguments),this.options=er({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)}getValues(e,t){let s,a,o,i,r,n,l,u,h,d=t.period,c=t.standardDeviation,m=[],g=[],y=e.xData,f=e.yData,x=f?f.length:0,v=[];if(!(y.length<d)){var D=en(f[0]);for(h=d;h<=x;h++)r=y.slice(h-d,h),n=f.slice(h-d,h),i=(u=p().seriesTypes.sma.prototype.getValues.call(this,{xData:r,yData:n},t)).xData[0],a=(s=u.yData[0])+c*(l=function(e,t,s,a){let o=e.length,i=0,r,n=0;for(;i<o;i++)n+=(r=(s?e[i][t]:e[i])-a)*r;return Math.sqrt(n/=o-1)}(n,t.index,D,s)),o=s-c*l,v.push([i,a,s,o]),m.push(i),g.push([a,s,o]);return{values:v,xData:m,yData:g}}}}el.defaultOptions=er(eo.defaultOptions,{params:{period:20,standardDeviation:2,index:3},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"}}),ei(el.prototype,{areaLinesNames:["top","bottom"],linesApiNames:["topLine","bottomLine"],nameComponents:["period","standardDeviation"],pointArrayMap:["top","middle","bottom"],pointValKey:"middle"}),X.compose(el),p().registerSeriesType("bb",el);let ep=p().seriesTypes["sma"],{isArray:eu,merge:eh}=i();class ed extends ep{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=[],n=[],l=[],p=[],u,h,d=[],c,m=1,g,y,f;if(!(a.length<=s)&&eu(o[0])&&4===o[0].length){for(;m<s;)h=o[m-1],r.push((h[1]+h[2]+h[3])/3),m++;for(f=s;f<=i;f++)y=((h=o[f-1])[1]+h[2]+h[3])/3,c=r.push(y),u=(y-(g=(d=r.slice(c-s)).reduce(function(e,t){return e+t},0)/s))/(.015*(function(e,t){let s=e.length,a=0,o;for(o=0;o<s;o++)a+=Math.abs(t-e[o]);return a}(d,g)/s)),n.push([a[f-1],u]),l.push(a[f-1]),p.push(u);return{values:n,xData:l,yData:p}}}}ed.defaultOptions=eh(ep.defaultOptions,{params:{index:void 0}}),p().registerSeriesType("cci",ed);let ec=p().seriesTypes["sma"],em=i()["merge"];class eg extends ec{constructor(){super(...arguments),this.nameBase="Chaikin Money Flow"}isValid(){let e=this.chart,t=this.options,s=this.linkedParent,a=this.volumeSeries||(this.volumeSeries=e.get(t.params.volumeSeriesID)),o=4===s?.pointArrayMap?.length;function i(e){return e.dataTable.rowCount>=t.params.period}return!!(s&&a&&i(s)&&i(a)&&o)}getValues(e,t){if(this.isValid())return this.getMoneyFlow(e.xData,e.yData,this.volumeSeries.getColumn("y"),t.period)}getMoneyFlow(e,t,s,a){let o=t.length,i=[],r=[],n=[],l=[],p,u,h=-1,d=0,c=0;function m(e,t){var s=e[1],a=e[2],e=e[3];return null!==t&&null!==s&&null!==a&&null!==e&&s!==a?(e-a-(s-e))/(s-a)*t:(h=p,null)}if(0<a&&a<=o){for(p=0;p<a;p++)i[p]=m(t[p],s[p]),d+=s[p],c+=i[p];for(r.push(e[p-1]),n.push(p-h>=a&&0!==d?c/d:null),l.push([r[0],n[0]]);p<o;p++)i[p]=m(t[p],s[p]),d=(d-=s[p-a])+s[p],c=(c-=i[p-a])+i[p],u=[e[p],p-h>=a?c/d:null],r.push(u[0]),n.push(u[1]),l.push([u[0],u[1]])}return{values:l,xData:r,yData:n}}}eg.defaultOptions=em(ec.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume"}}),p().registerSeriesType("cmf",eg);let ey=p().seriesTypes["sma"],{correctFloat:ef,extend:ex,isArray:eD,merge:ev}=i();class eA extends ey{calculateDM(e,t,s){var a=e[t][1],o=e[t][2],i=e[t-1][1],e=e[t-1][2];return ef(e-o<a-i?s?Math.max(a-i,0):0:s?0:Math.max(e-o,0))}calculateDI(e,t){return e/t*100}calculateDX(e,t){return ef(Math.abs(e-t)/Math.abs(e+t)*100)}smoothValues(e,t,s){return ef(e-e/s+t)}getTR(e,t){return ef(Math.max(e[1]-e[2],t?Math.abs(e[1]-t[3]):0,t?Math.abs(e[2]-t[3]):0))}getValues(e,t){let c=t.period,m=e.xData,g=e.yData,s=g?g.length:0,y=[],f=[],x=[];if(!(m.length<=c)&&eD(g[0])&&4===g[0].length){let p=0,u=0,h=0,d;for(d=1;d<s;d++){let e,t,s,a,o,i,r,n,l;d<=c?(a=this.calculateDM(g,d,!0),o=this.calculateDM(g,d),i=this.getTR(g[d],g[d-1]),p+=a,u+=o,h+=i,d===c&&(r=this.calculateDI(p,h),n=this.calculateDI(u,h),l=this.calculateDX(p,u),y.push([m[d],l,r,n]),f.push(m[d]),x.push([l,r,n]))):(a=this.calculateDM(g,d,!0),o=this.calculateDM(g,d),i=this.getTR(g[d],g[d-1]),e=this.smoothValues(p,a,c),t=this.smoothValues(u,o,c),s=this.smoothValues(h,i,c),p=e,u=t,h=s,r=this.calculateDI(p,h),n=this.calculateDI(u,h),l=this.calculateDX(p,u),y.push([m[d],l,r,n]),f.push(m[d]),x.push([l,r,n]))}return{values:y,xData:f,yData:x}}}}eA.defaultOptions=ev(ey.defaultOptions,{params:{index:void 0},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color: {point.color}">●</span><b> {series.name}</b><br/><span style="color: {point.color}">DX</span>: {point.y}<br/><span style="color: {point.series.options.plusDILine.styles.lineColor}">+DI</span>: {point.plusDI}<br/><span style="color: {point.series.options.minusDILine.styles.lineColor}">-DI</span>: {point.minusDI}<br/>'},plusDILine:{styles:{lineWidth:1,lineColor:"#06b535"}},minusDILine:{styles:{lineWidth:1,lineColor:"#f21313"}},dataGrouping:{approximation:"averages"}}),ex(eA.prototype,{areaLinesNames:[],nameBase:"DMI",linesApiNames:["plusDILine","minusDILine"],pointArrayMap:["y","plusDI","minusDI"],parallelArrays:["x","y","plusDI","minusDI"],pointValKey:"y"}),X.compose(eA),p().registerSeriesType("dmi",eA);let eS=p().seriesTypes["sma"],{extend:eb,merge:eT,correctFloat:eC,pick:eP}=i();function eM(e,t,s,a,o){a=eP(t[s][a],t[s]);return o?eC(e-a):eC(e+a)}class eV extends eS{getValues(e,t){let s=t.period,a=t.index,o=Math.floor(s/2+1),i=s+o,r=e.xData||[],n=e.yData||[],l=n.length,p=[],u=[],h=[],d,c,m,g,y,f=0;if(!(r.length<=i)){for(g=0;g<s-1;g++)f=eM(f,n,g,a);for(y=0;y<=l-i;y++)c=y+s-1,m=y+i-1,f=eM(f,n,c,a),d=eP(n[m][a],n[m])-f/s,f=eM(f,n,y,a,!0),p.push([r[m],d]),u.push(r[m]),h.push(d);return{values:p,xData:u,yData:h}}}}eV.defaultOptions=eT(eS.defaultOptions,{params:{index:0,period:21}}),eb(eV.prototype,{nameBase:"DPO"}),p().registerSeriesType("dpo",eV);let eL=p().seriesTypes["ema"],{correctFloat:ek,extend:eO,merge:eE,error:ew}=i();class eI extends eL{getValues(e,t){let s,a,o=t.periods,i=t.period,r=[],n=[],l=[];if(2!==o.length||o[1]<=o[0])ew('Error: "Chaikin requires two periods. Notice, first period should be lower than the second one."');else{e=L.prototype.getValues.call(this,e,{volumeSeriesID:t.volumeSeriesID,period:i});if(e){var p=super.getValues.call(this,e,{period:o[0]}),u=super.getValues.call(this,e,{period:o[1]});if(p&&u){var h=o[1]-o[0];for(a=0;a<u.yData.length;a++)s=ek(p.yData[a+h]-u.yData[a]),r.push([u.xData[a],s]),n.push(u.xData[a]),l.push(s);return{values:r,xData:n,yData:l}}}}}}eI.defaultOptions=eE(eL.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume",period:9,periods:[3,10]}}),eO(eI.prototype,{nameBase:"Chaikin Osc",nameComponents:["periods"]}),p().registerSeriesType("chaikin",eI);let eN=p().seriesTypes["sma"],{isNumber:eB,merge:eG}=i();class eW extends eN{getValues(e,t){let o=t.period,i=e.xData,r=e.yData,n=r?r.length:0,l=[],p=[],u=[],h,d=t.index,c;if(!(i.length<o)){c=eB(r[0])?r:(d=Math.min(d,r[0].length-1),r.map(e=>e[d]));let e,t=0,s=0,a;for(let e=o;0<e;e--)c[e]>c[e-1]?t+=c[e]-c[e-1]:c[e]<c[e-1]&&(s+=c[e-1]-c[e]);for(a=0<t+s?100*(t-s)/(t+s):0,p.push(i[o]),u.push(a),l.push([i[o],a]),h=o+1;h<n;h++)e=Math.abs(c[h-o-1]-c[h-o]),c[h]>c[h-1]?t+=c[h]-c[h-1]:c[h]<c[h-1]&&(s+=c[h-1]-c[h]),c[h-o]>c[h-o-1]?t-=e:s-=e,a=0<t+s?100*(t-s)/(t+s):0,p.push(i[h]),u.push(a),l.push([i[h],a]);return{values:l,xData:p,yData:u}}}}eW.defaultOptions=eG(eN.defaultOptions,{params:{period:20,index:3}}),p().registerSeriesType("cmo",eW);let ez=p().seriesTypes["ema"],{correctFloat:eY,isArray:eF,merge:eX}=i();class eR extends ez{getEMA(e,t,s,a,o,i){return super.calculateEma(i||[],e,void 0===o?1:o,this.EMApercent,t,void 0===a?-1:a,s)}getValues(e,t){let s=t.period,a=[],o=2*s,i=e.xData,r=e.yData,n=r?r.length:0,l=[],p=[],u=[],h=0,d=0,c,m,g,y,f=-1,x,v=0;if(this.EMApercent=2/(s+1),!(n<2*s-1)){for(eF(r[0])&&(f=t.index||0),v=(h=super.accumulatePeriodPoints(s,f,r))/s,h=0,y=s;y<n+2;y++)y<n+1&&(d=this.getEMA(r,m,v,f,y)[1],a.push(d)),m=d,y<o?h+=d:(y===o&&(v=h/s),d=a[y-s-1],c=this.getEMA([d],g,v)[1],x=[i[y-2],eY(2*d-c)],l.push(x),p.push(x[0]),u.push(x[1]),g=c);return{values:l,xData:p,yData:u}}}}eR.defaultOptions=eX(ez.defaultOptions),p().registerSeriesType("dema",eR);let eK=p().seriesTypes["ema"],{correctFloat:eU,isArray:eZ,merge:ej}=i();class e_ extends eK{getEMA(e,t,s,a,o,i){return super.calculateEma(i||[],e,void 0===o?1:o,this.EMApercent,t,void 0===a?-1:a,s)}getTemaPoint(e,t,s,a){return[e[a-3],eU(3*s.level1-3*s.level2+s.level3)]}getValues(e,t){let s=t.period,a=2*s,o=3*s,i=e.xData,r=e.yData,n=r?r.length:0,l=[],p=[],u=[],h=[],d=[],c={},m=-1,g=0,y=0,f,x,v,D;if(this.EMApercent=2/(s+1),!(n<3*s-2)){for(eZ(r[0])&&(m=t.index||0),y=(g=super.accumulatePeriodPoints(s,m,r))/s,g=0,v=s;v<n+3;v++)v<n+1&&(c.level1=this.getEMA(r,f,y,m,v)[1],h.push(c.level1)),f=c.level1,v<a?g+=c.level1:(v===a&&(y=g/s,g=0),c.level1=h[v-s-1],c.level2=this.getEMA([c.level1],x,y)[1],d.push(c.level2),x=c.level2,v<o?g+=c.level2:(v===o&&(y=g/s),v===n+1&&(c.level1=h[v-s-1],c.level2=this.getEMA([c.level1],x,y)[1],d.push(c.level2)),c.level1=h[v-s-2],c.level2=d[v-2*s-1],c.level3=this.getEMA([c.level2],c.prevLevel3,y)[1],(D=this.getTemaPoint(i,o,c,v))&&(l.push(D),p.push(D[0]),u.push(D[1])),c.prevLevel3=c.level3));return{values:l,xData:p,yData:u}}}}e_.defaultOptions=ej(eK.defaultOptions),p().registerSeriesType("tema",e_);let eq=p().seriesTypes["tema"],{correctFloat:eH,merge:e$}=i();class eJ extends eq{getTemaPoint(e,t,s,a){if(t<a)return[e[a-3],0!==s.prevLevel3?eH(s.level3-s.prevLevel3)/s.prevLevel3*100:null]}}eJ.defaultOptions=e$(eq.defaultOptions),p().registerSeriesType("trix",eJ);let eQ=p().seriesTypes["ema"],{extend:e0,merge:e1,error:e2}=i();class e3 extends eQ{getValues(e,t){let s,a,o=t.periods,i=t.index,r=[],n=[],l=[];if(2!==o.length||o[1]<=o[0])e2('Error: "APO requires two periods. Notice, first period should be lower than the second one."');else{var p=super.getValues.call(this,e,{index:i,period:o[0]}),u=super.getValues.call(this,e,{index:i,period:o[1]});if(p&&u){var h=o[1]-o[0];for(a=0;a<u.yData.length;a++)s=p.yData[a+h]-u.yData[a],r.push([u.xData[a],s]),n.push(u.xData[a]),l.push(s);return{values:r,xData:n,yData:l}}}}}e3.defaultOptions=e1(eQ.defaultOptions,{params:{period:void 0,periods:[10,20]}}),e0(e3.prototype,{nameBase:"APO",nameComponents:["periods"]}),p().registerSeriesType("apo",e3);let e4=t.default.dataGrouping.approximations;var e5=a.n(e4);let e6=e.default.Color,e8=a.n(e6)()["parse"],e9=p().seriesTypes["sma"],{defined:e7,extend:te,isArray:tt,isNumber:ts,getClosestDistance:ta,merge:to,objectEach:ti}=i();function tn(e){return{high:e.reduce(function(e,t){return Math.max(e,t[1])},-1/0),low:e.reduce(function(e,t){return Math.min(e,t[2])},1/0)}}function tr(e){let t=e.indicator;t.points=e.points,t.nextPoints=e.nextPoints,t.color=e.color,t.options=to(e.options.senkouSpan.styles,e.gap),t.graph=e.graph,t.fillGraph=!0,p().seriesTypes.sma.prototype.drawGraph.call(t)}class tl extends e9{constructor(){super(...arguments),this.data=[],this.options={},this.points=[],this.graphCollection=[]}init(){super.init.apply(this,arguments),this.options=to({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:e8(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:e8(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:e8(this.color).setOpacity(.2).get()}}},this.options)}toYData(e){return[e.tenkanSen,e.kijunSen,e.chikouSpan,e.senkouSpanA,e.senkouSpanB]}translate(){for(var e of(p().seriesTypes.sma.prototype.translate.apply(this),this.points))for(var t of this.pointArrayMap){var s=e[t];ts(s)&&(e["plot"+t]=this.yAxis.toPixels(s,!0),e.plotY=e["plot"+t],e.tooltipPos=[e.plotX,e["plot"+t]],e.isNull=!1)}}drawGraph(){let s=this,e=s.points,a=s.options,t=s.graph,o=s.color,i={options:{gapSize:a.gapSize}},r=s.pointArrayMap.length,n=[[],[],[],[],[],[]],l={tenkanLine:n[0],kijunLine:n[1],chikouLine:n[2],senkouSpanA:n[3],senkouSpanB:n[4],senkouSpan:n[5]},u=[],h=s.options.senkouSpan,d=h.color||h.styles.fill,c=h.negativeColor,m=[[],[]],g=[[],[]],y=e.length,f=0,x,v,D,A,S,b,C,T,P,M,V,L,O;for(s.ikhMap=l;y--;){for(D=0,v=e[y];D<r;D++)e7(v[x=s.pointArrayMap[D]])&&n[D].push({plotX:v.plotX,plotY:v["plot"+x],isNull:!1});var k,E;c&&y!==e.length-1&&(k=l.senkouSpanB.length-1,(E=function(e,t,s,a){if(e&&t&&s&&a){var o=t.plotX-e.plotX,t=t.plotY-e.plotY,i=a.plotX-s.plotX,a=a.plotY-s.plotY,r=e.plotX-s.plotX,s=e.plotY-s.plotY,n=(-t*r+o*s)/(-i*t+o*a),s=(i*s-a*r)/(-i*t+o*a);if(0<=n&&n<=1&&0<=s&&s<=1)return{plotX:e.plotX+s*o,plotY:e.plotY+s*t}}}(l.senkouSpanA[k-1],l.senkouSpanA[k],l.senkouSpanB[k-1],l.senkouSpanB[k]))&&(E={plotX:E.plotX,plotY:E.plotY,isNull:!1,intersectPoint:!0},l.senkouSpanA.splice(k,0,E),l.senkouSpanB.splice(k,0,E),u.push(k)))}if(ti(l,(e,t)=>{a[t]&&"senkouSpan"!==t&&(s.points=n[f],s.options=to(a[t].styles,i),s.graph=s["graph"+t],s.fillGraph=!1,s.color=o,p().seriesTypes.sma.prototype.drawGraph.call(s),s["graph"+t]=s.graph),f++}),s.graphCollection)for(var I of s.graphCollection)s[I].destroy(),delete s[I];if(s.graphCollection=[],c&&l.senkouSpanA[0]&&l.senkouSpanB[0]){for(u.unshift(0),u.push(l.senkouSpanA.length-1),L=0;L<u.length-1;L++)if(A=u[L],S=u[L+1],b=l.senkouSpanB.slice(A,S+1),C=l.senkouSpanA.slice(A,S+1),1<=Math.floor(b.length/2)){var N=Math.floor(b.length/2);if(b[N].plotY===C[N].plotY){for(O=0,T=0,P=0;O<b.length;O++)T+=b[O].plotY,P+=C[O].plotY;m[V=T>P?0:1]=m[V].concat(b),g[V]=g[V].concat(C)}else m[V=b[N].plotY>C[N].plotY?0:1]=m[V].concat(b),g[V]=g[V].concat(C)}else m[V=b[0].plotY>C[0].plotY?0:1]=m[V].concat(b),g[V]=g[V].concat(C);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(e,t){m[t].length&&g[t].length&&(M=0===t?d:c,tr({indicator:s,points:m[t],nextPoints:g[t],color:M,options:a,gap:i,graph:s[e]}),s[e]=s.graph,s.graphCollection.push(e))})}else tr({indicator:s,points:l.senkouSpanB,nextPoints:l.senkouSpanA,color:d,options:a,gap:i,graph:s.graphsenkouSpan}),s.graphsenkouSpan=s.graph;delete s.nextPoints,delete s.fillGraph,s.points=e,s.options=a,s.graph=t,s.color=o}getGraphPath(e){let t=[],s,a;if(e=e||this.points,this.fillGraph&&this.nextPoints){if((s=p().seriesTypes.sma.prototype.getGraphPath.call(this,this.nextPoints))&&s.length){s[0][0]="L",t=p().seriesTypes.sma.prototype.getGraphPath.call(this,e);for(let e=(a=s.slice(0,t.length)).length-1;0<=e;e--)t.push(a[e])}}else t=p().seriesTypes.sma.prototype.getGraphPath.apply(this,arguments);return t}getValues(e,t){let s,a,o,i,r,n,l,p,u,h,d=t.period,c=t.periodTenkan,m=t.periodSenkouSpanB,g=e.xData,y=e.yData,f=e.xAxis,x=y&&y.length||0,v=ta(f.series.map(e=>e.getColumn("x"))),D=[],A=[];if(!(g.length<=d)&&tt(y[0])&&4===y[0].length){var S=g[0]-d*v;for(r=0;r<d;r++)A.push(S+r*v);for(r=0;r<x;r++)r>=c&&(n=((a=tn(y.slice(r-c,r))).high+a.low)/2),r>=d&&(u=(n+(l=((o=tn(y.slice(r-d,r))).high+o.low)/2))/2),r>=m&&(h=((i=tn(y.slice(r-m,r))).high+i.low)/2),p=y[r][3],s=g[r],void 0===D[r]&&(D[r]=[]),void 0===D[r+d-1]&&(D[r+d-1]=[]),D[r+d-1][0]=n,D[r+d-1][1]=l,(D[r+d-1][2]=void 0)===D[r+1]&&(D[r+1]=[]),D[r+1][2]=p,r<=d&&(D[r+d-1][3]=void 0,D[r+d-1][4]=void 0),void 0===D[r+2*d-2]&&(D[r+2*d-2]=[]),D[r+2*d-2][3]=u,D[r+2*d-2][4]=h,A.push(s);for(r=1;r<=d;r++)A.push(s+r*v);return{values:D,xData:A,yData:D}}}}tl.defaultOptions=to(e9.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}}),te(tl.prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),e5()["ichimoku-averages"]=function(){let s,a=[];return[].forEach.call(arguments,function(e,t){a.push(e5().average(e)),s=!s&&void 0===a[t]}),s?void 0:a},p().registerSeriesType("ikh",tl);let tp=p().seriesTypes["sma"],{correctFloat:tu,extend:th,merge:td}=i();class tc extends tp{init(){p().seriesTypes.sma.prototype.init.apply(this,arguments),this.options=td({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)}getValues(e,t){let s,a,o,i,r,n,l,u=t.period,h=t.periodATR,d=t.multiplierATR,c=t.index,m=e.yData,g=m?m.length:0,y=[],f=p().seriesTypes.ema.prototype.getValues(e,{period:u,index:c}),x=p().seriesTypes.atr.prototype.getValues(e,{period:h}),v=[],D=[];if(!(g<u)){for(l=u;l<=g;l++)r=f.values[l-u],n=x.values[l-h],i=r[0],a=tu(r[1]+d*n[1]),o=tu(r[1]-d*n[1]),s=r[1],y.push([i,a,s,o]),v.push(i),D.push([a,s,o]);return{values:y,xData:v,yData:D}}}}tc.defaultOptions=td(tp.defaultOptions,{params:{index:0,period:20,periodATR:10,multiplierATR:2},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b><br/>Upper Channel: {point.top}<br/>EMA({series.options.params.period}): {point.middle}<br/>Lower Channel: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"},lineWidth:1}),th(tc.prototype,{nameBase:"Keltner Channels",areaLinesNames:["top","bottom"],nameComponents:["period","periodATR","multiplierATR"],linesApiNames:["topLine","bottomLine"],pointArrayMap:["top","middle","bottom"],pointValKey:"middle"}),X.compose(tc),p().registerSeriesType("keltnerchannels",tc);let{ema:tm,sma:tg}=p().seriesTypes,{correctFloat:ty,error:tf,extend:tx,isArray:tD,merge:tv}=i();class tA extends tg{calculateTrend(e,t){return e[t][1]+e[t][2]+e[t][3]>e[t-1][1]+e[t-1][2]+e[t-1][3]?1:-1}isValidData(e){let t=this.chart,s=this.options,a=this.linkedParent,o=tD(e)&&4===e.length,i=this.volumeSeries||(this.volumeSeries=t.get(s.params.volumeSeriesID));return i||tf("Series "+s.params.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,a.chart),!(![a,i].every(function(e){return e&&e.dataTable.rowCount>=s.params.slowAvgPeriod})||!o)}getCM(e,t,s,a,o){return ty(t+(s===a?e:o))}getDM(e,t){return ty(e-t)}getVolumeForce(e){let t=[],s,a,o=1,i=0,r=e[0][1]-e[0][2],n=0,l;for(;o<e.length;o++)l=this.calculateTrend(e,o),a=this.getDM(e[o][1],e[o][2]),s=this.getCM(i,a,l,n,r),t.push([this.volumeSeries.getColumn("y")[o]*l*Math.abs(2*(a/s-1))*100]),n=l,i=s,r=a;return t}getEMA(e,t,s,a,o,i,r){return tm.prototype.calculateEma(r||[],e,void 0===i?1:i,a,t,void 0===o?-1:o,s)}getSMA(e,t,s){return tm.prototype.accumulatePeriodPoints(e,t,s)/e}getValues(e,t){let s=[],a=e.xData,o=e.yData,i=[],r=[],n=[],l,p=0,u=0,h,d,c,m=null;if(this.isValidData(o[0])){for(var g=this.getVolumeForce(o),y=this.getSMA(t.fastAvgPeriod,0,g),f=this.getSMA(t.slowAvgPeriod,0,g),x=2/(t.fastAvgPeriod+1),v=2/(t.slowAvgPeriod+1);p<o.length;p++)p>=t.fastAvgPeriod&&(d=u=this.getEMA(g,d,y,x,0,p,a)[1]),p>=t.slowAvgPeriod&&(c=h=this.getEMA(g,c,f,v,0,p,a)[1],n.push(l=ty(u-h)),n.length>=t.signalPeriod&&(m=n.slice(-t.signalPeriod).reduce((e,t)=>e+t)/t.signalPeriod),s.push([a[p],l,m]),i.push(a[p]),r.push([l,m]));return{values:s,xData:i,yData:r}}}}tA.defaultOptions=tv(tg.defaultOptions,{params:{fastAvgPeriod:34,slowAvgPeriod:55,signalPeriod:13,volumeSeriesID:"volume"},signalLine:{styles:{lineWidth:1,lineColor:"#ff0000"}},dataGrouping:{approximation:"averages"},tooltip:{pointFormat:'<span style="color: {point.color}">●</span><b> {series.name}</b><br/><span style="color: {point.color}">Klinger</span>: {point.y}<br/><span style="color: {point.series.options.signalLine.styles.lineColor}">Signal</span>: {point.signal}<br/>'}}),tx(tA.prototype,{areaLinesNames:[],linesApiNames:["signalLine"],nameBase:"Klinger",nameComponents:["fastAvgPeriod","slowAvgPeriod"],pointArrayMap:["y","signal"],parallelArrays:["x","y","signal"],pointValKey:"y"}),X.compose(tA),p().registerSeriesType("klinger",tA);let tS=i()["noop"],{column:tb,sma:tT}=p().seriesTypes,{extend:tC,correctFloat:tP,defined:tM,merge:tV}=i();class tL extends tT{init(){p().seriesTypes.sma.prototype.init.apply(this,arguments);var e=this.color;this.options&&(tM(this.colorIndex)&&(this.options.signalLine&&this.options.signalLine.styles&&!this.options.signalLine.styles.lineColor&&(this.options.colorIndex=this.colorIndex+1,this.getCyclic("color",void 0,this.chart.options.colors),this.options.signalLine.styles.lineColor=this.color),this.options.macdLine&&this.options.macdLine.styles&&!this.options.macdLine.styles.lineColor&&(this.options.colorIndex=this.colorIndex+1,this.getCyclic("color",void 0,this.chart.options.colors),this.options.macdLine.styles.lineColor=this.color)),this.macdZones={zones:this.options.macdLine.zones,startIndex:0},this.signalZones={zones:this.macdZones.zones.concat(this.options.signalLine.zones),startIndex:this.macdZones.zones.length}),this.color=e}toYData(e){return[e.y,e.signal,e.MACD]}translate(){let a=this,o=["plotSignal","plotMACD"];i().seriesTypes.column.prototype.translate.apply(a),a.points.forEach(function(s){[s.signal,s.MACD].forEach(function(e,t){null!==e&&(s[o[t]]=a.yAxis.toPixels(e,!0))})})}destroy(){this.graph=null,this.graphmacd=this.graphmacd&&this.graphmacd.destroy(),this.graphsignal=this.graphsignal&&this.graphsignal.destroy(),p().seriesTypes.sma.prototype.destroy.apply(this,arguments)}drawGraph(){let s=this,e=s.points,a=s.options,t=s.zones,o={options:{gapSize:a.gapSize}},i=[[],[]],r,n=e.length;for(;n--;)tM((r=e[n]).plotMACD)&&i[0].push({plotX:r.plotX,plotY:r.plotMACD,isNull:!tM(r.plotMACD)}),tM(r.plotSignal)&&i[1].push({plotX:r.plotX,plotY:r.plotSignal,isNull:!tM(r.plotMACD)});["macd","signal"].forEach((e,t)=>{s.points=i[t],s.options=tV(a[e+"Line"]?.styles||{},o),s.graph=s["graph"+e],s.zones=(s[e+"Zones"].zones||[]).slice(s[e+"Zones"].startIndex||0),p().seriesTypes.sma.prototype.drawGraph.call(s),s["graph"+e]=s.graph}),s.points=e,s.options=a,s.zones=t}applyZones(){var e=this.zones;this.zones=this.signalZones.zones,p().seriesTypes.sma.prototype.applyZones.call(this),this.graphmacd&&this.options.macdLine.zones.length&&this.graphmacd.hide(),this.zones=e}getValues(e,t){let s=t.longPeriod-t.shortPeriod,a=[],o=[],i=[],r,n,l,u=0,h;if(!(e.xData.length<t.longPeriod+t.signalPeriod)){for(l=0,r=p().seriesTypes.ema.prototype.getValues(e,{period:t.shortPeriod,index:t.index}),n=p().seriesTypes.ema.prototype.getValues(e,{period:t.longPeriod,index:t.index}),r=r.values,n=n.values;l<=r.length;l++)tM(n[l])&&tM(n[l][1])&&tM(r[l+s])&&tM(r[l+s][0])&&a.push([r[l+s][0],0,null,r[l+s][1]-n[l][1]]);for(l=0;l<a.length;l++)o.push(a[l][0]),i.push([0,null,a[l][3]]);for(l=0,h=p().seriesTypes.ema.prototype.getValues({xData:o,yData:i},{period:t.signalPeriod,index:2}).values;l<a.length;l++)a[l][0]>=h[0][0]&&(a[l][2]=h[u][1],i[l]=[0,h[u][1],a[l][3]],null===a[l][3]?(a[l][1]=0,i[l][0]=0):(a[l][1]=tP(a[l][3]-h[u][1]),i[l][0]=tP(a[l][3]-h[u][1])),u++);return{values:a,xData:o,yData:i}}}}tL.defaultOptions=tV(tT.defaultOptions,{params:{shortPeriod:12,longPeriod:26,signalPeriod:9,period:26},signalLine:{zones:[],styles:{lineWidth:1,lineColor:void 0}},macdLine:{zones:[],styles:{lineWidth:1,lineColor:void 0}},threshold:0,groupPadding:.1,pointPadding:.1,crisp:!1,states:{hover:{halo:{size:0}}},tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Value: {point.MACD}<br/>Signal: {point.signal}<br/>Histogram: {point.y}<br/>'},dataGrouping:{approximation:"averages"},minPointLength:0}),tC(tL.prototype,{nameComponents:["longPeriod","shortPeriod","signalPeriod"],pointArrayMap:["y","signal","MACD"],parallelArrays:["x","y","signal","MACD"],pointValKey:"y",markerAttribs:tS,getColumnMetrics:i().seriesTypes.column.prototype.getColumnMetrics,crispCol:i().seriesTypes.column.prototype.crispCol,drawPoints:i().seriesTypes.column.prototype.drawPoints}),p().registerSeriesType("macd",tL);let tk=p().seriesTypes["sma"],{extend:tO,merge:tE,error:tw,isArray:tI}=i();function tN(e){return e.reduce(function(e,t){return e+t})}function tB(e){return(e[1]+e[2]+e[3])/3}class tG extends tk{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=t.decimals,n=e.chart.get(t.volumeSeriesID),l=n?.getColumn("y")||[],p=[],u=[],h=[],d=[],c=[],m,g,y,f,x,v,D=!1,A=1;if(n){if(!(a.length<=s)&&tI(o[0])&&4===o[0].length&&l){for(m=tB(o[A]);A<s+1;)g=m,D=(m=tB(o[A]))>=g,y=m*l[A],d.push(D?y:0),c.push(D?0:y),A++;for(v=A-1;v<i;v++){var S;v>A-1&&(d.shift(),c.shift(),g=m,D=(m=tB(o[v]))>g,y=m*l[v],d.push(D?y:0),c.push(D?0:y)),f=tN(c),S=100-100/(1+tN(d)/f),x=parseFloat(S.toFixed(r)),p.push([a[v],x]),u.push(a[v]),h.push(x)}return{values:p,xData:u,yData:h}}}else tw("Series "+t.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}}tG.defaultOptions=tE(tk.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume",decimals:4}}),tO(tG.prototype,{nameBase:"Money Flow Index"}),p().registerSeriesType("mfi",tG);let tW=p().seriesTypes["sma"],{extend:tz,isArray:tY,merge:tF}=i();function tX(e,t,s,a,o){t=t[s-1][o]-t[s-a-1][o];return[e[s-1],t]}class tR extends tW{getValues(e,t){let s,a,o=t.period,i=t.index,r=e.xData,n=e.yData,l=n?n.length:0,p=[],u=[],h=[];if(!(r.length<=o)&&tY(n[0])){for(s=o+1;s<l;s++)a=tX(r,n,s,o,i),p.push(a),u.push(a[0]),h.push(a[1]);return a=tX(r,n,s,o,i),p.push(a),u.push(a[0]),h.push(a[1]),{values:p,xData:u,yData:h}}}}tR.defaultOptions=tF(tW.defaultOptions,{params:{index:3}}),tz(tR.prototype,{nameBase:"Momentum"}),p().registerSeriesType("momentum",tR);let tK=p().seriesTypes["atr"],tU=i()["merge"];class tZ extends tK{getValues(e,t){let s=super.getValues.apply(this,arguments),a=s.values.length,o=e.yData,i=0,r=t.period-1;if(s){for(;i<a;i++)s.yData[i]=s.values[i][1]/o[r][3]*100,s.values[i][1]=s.yData[i],r++;return s}}}tZ.defaultOptions=tU(tK.defaultOptions,{tooltip:{valueSuffix:"%"}}),p().registerSeriesType("natr",tZ);let tj=p().seriesTypes["sma"],{isNumber:t_,error:tq,extend:tH,merge:t$}=i();class tJ extends tj{getValues(e,t){let s=e.chart.get(t.volumeSeriesID),a=e.xData,o=e.yData,i=[],r=[],n=[],l=!t_(o[0]),p,u=1,h=0,d,c=0,m,g;if(s){for(g=s.getColumn("y"),p=[a[0],h],c=l?o[0][3]:o[0],i.push(p),r.push(a[0]),n.push(p[1]);u<o.length;u++)d=(m=l?o[u][3]:o[u])>c?h+g[u]:m===c?h:h-g[u],p=[a[u],d],h=d,c=m,i.push(p),r.push(a[u]),n.push(p[1]);return{values:i,xData:r,yData:n}}tq("Series "+t.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}}tJ.defaultOptions=t$(tj.defaultOptions,{marker:{enabled:!1},params:{index:void 0,period:void 0,volumeSeriesID:"volume"},tooltip:{valueDecimals:0}}),tH(tJ.prototype,{nameComponents:void 0}),p().registerSeriesType("obv",tJ);let tQ=p().seriesTypes.sma.prototype.pointClass;function t0(e,t){let s=e.series.pointArrayMap,a,o=s.length;for(p().seriesTypes.sma.prototype.pointClass.prototype[t].call(e);o--;)e[a="dataLabel"+s[o]]&&e[a].element&&e[a].destroy(),e[a]=null}let t1=p().seriesTypes["sma"],{merge:t2,extend:t3,defined:t4,isArray:t5}=i();class t6 extends t1{toYData(e){return[e.P]}translate(){let s=this;super.translate.apply(s),s.points.forEach(function(t){s.pointArrayMap.forEach(function(e){t4(t[e])&&(t["plot"+e]=s.yAxis.toPixels(t[e],!0))})}),s.plotEndPoint=s.xAxis.toPixels(s.endPoint,!0)}getGraphPath(e){let t=this,s=[[],[],[],[],[],[],[],[],[]],a=t.pointArrayMap.length,o=t.plotEndPoint,i=[],r,n,l=e.length,p;for(;l--;){for(p=0,n=e[l];p<a;p++)t4(n[r=t.pointArrayMap[p]])&&s[p].push({plotX:n.plotX,plotY:n["plot"+r],isNull:!1},{plotX:o,plotY:n["plot"+r],isNull:!1},{plotX:o,plotY:null,isNull:!0});o=n.plotX}return s.forEach(e=>{i=i.concat(super.getGraphPath.call(t,e))}),i}drawDataLabels(){let s,a,o,i,r=this,n=r.pointArrayMap;r.options.dataLabels.enabled&&(a=r.points.length,n.concat([!1]).forEach((e,t)=>{for(i=a;i--;)o=r.points[i],e?(o.y=o[e],o.pivotLine=e,o.plotY=o["plot"+e],s=o["dataLabel"+e],t&&(o["dataLabel"+n[t-1]]=o.dataLabel),o.dataLabels||(o.dataLabels=[]),o.dataLabels[0]=o.dataLabel=s=s&&s.element?s:null):o["dataLabel"+n[t-1]]=o.dataLabel;super.drawDataLabels.call(r)}))}getValues(e,t){let s,a,o,i,r,n,l,p=t.period,u=e.xData,h=e.yData,d=h?h.length:0,c=this[t.algorithm+"Placement"],m=[],g=[],y=[];if(!(u.length<p)&&t5(h[0])&&4===h[0].length){for(l=p+1;l<=d+p;l+=p)o=u.slice(l-p-1,l),i=h.slice(l-p-1,l),a=o.length,s=o[a-1],n=c(this.getPivotAndHLC(i)),r=m.push([s].concat(n)),g.push(s),y.push(m[r-1].slice(1));return this.endPoint=o[0]+(s-o[0])/a*p,{values:m,xData:g,yData:y}}}getPivotAndHLC(e){let t=e[e.length-1][3],s=-1/0,a=1/0;return e.forEach(function(e){s=Math.max(s,e[1]),a=Math.min(a,e[2])}),[(s+a+t)/3,s,a,t]}standardPlacement(e){var t=e[1]-e[2];return[null,null,e[0]+t,2*e[0]-e[2],e[0],2*e[0]-e[1],e[0]-t,null,null]}camarillaPlacement(e){var t=e[1]-e[2];return[e[3]+1.5*t,e[3]+1.25*t,e[3]+1.1666*t,e[3]+1.0833*t,e[0],e[3]-1.0833*t,e[3]-1.1666*t,e[3]-1.25*t,e[3]-1.5*t]}fibonacciPlacement(e){var t=e[1]-e[2];return[null,e[0]+t,e[0]+.618*t,e[0]+.382*t,e[0],e[0]-.382*t,e[0]-.618*t,e[0]-t,null]}}t6.defaultOptions=t2(t1.defaultOptions,{params:{index:void 0,period:28,algorithm:"standard"},marker:{enabled:!1},enableMouseTracking:!1,dataLabels:{enabled:!0,format:"{point.pivotLine}"},dataGrouping:{approximation:"averages"}}),t3(t6.prototype,{nameBase:"Pivot Points",pointArrayMap:["R4","R3","R2","R1","P","S1","S2","S3","S4"],pointValKey:"P",pointClass:class extends tQ{destroyElements(){t0(this,"destroyElements")}destroy(){t0(this,"destroyElements")}}}),p().registerSeriesType("pivotpoints",t6);let t8=p().seriesTypes["ema"],{correctFloat:t9,extend:t7,merge:se,error:st}=i();class ss extends t8{getValues(e,t){let s,a,o=t.periods,i=t.index,r=[],n=[],l=[];if(2!==o.length||o[1]<=o[0])st('Error: "PPO requires two periods. Notice, first period should be lower than the second one."');else{var p=super.getValues.call(this,e,{index:i,period:o[0]}),u=super.getValues.call(this,e,{index:i,period:o[1]});if(p&&u){var h=o[1]-o[0];for(a=0;a<u.yData.length;a++)s=t9((p.yData[a+h]-u.yData[a])/u.yData[a]*100),r.push([u.xData[a],s]),n.push(u.xData[a]),l.push(s);return{values:r,xData:n,yData:l}}}}}ss.defaultOptions=se(t8.defaultOptions,{params:{period:void 0,periods:[12,26]}}),t7(ss.prototype,{nameBase:"PPO",nameComponents:["periods"]}),p().registerSeriesType("ppo",ss);let sa={getArrayExtremes:function(e,s,a){return e.reduce((e,t)=>[Math.min(e[0],t[s]),Math.max(e[1],t[a])],[Number.MAX_VALUE,-Number.MAX_VALUE])}},so=["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],si=p().seriesTypes["sma"],{merge:sn,extend:sr}=i();class sl extends si{getValues(e,t){let s,a,o,i,r,n,l,p=t.period,u=e.xData,h=e.yData,d=h?h.length:0,c=[],m=[],g=[];if(!(d<p)){for(l=p;l<=d;l++)i=u[l-1],r=h.slice(l-p,l),s=((a=(n=sa.getArrayExtremes(r,2,1))[1])+(o=n[0]))/2,c.push([i,a,s,o]),m.push(i),g.push([a,s,o]);return{values:c,xData:m,yData:g}}}}sl.defaultOptions=sn(si.defaultOptions,{params:{index:void 0,period:20},lineWidth:1,topLine:{styles:{lineColor:"#00e272",lineWidth:1}},bottomLine:{styles:{lineColor:"#feb56a",lineWidth:1}},dataGrouping:{approximation:"averages"}}),sr(sl.prototype,{areaLinesNames:["top","bottom"],nameBase:"Price Channel",nameComponents:["period"],linesApiNames:["topLine","bottomLine"],pointArrayMap:["top","middle","bottom"],pointValKey:"middle"}),X.compose(sl),p().registerSeriesType("pc",sl);let sp=p().seriesTypes["sma"],{extend:su,isArray:sh,merge:sd}=i();class sc extends sp{init(){super.init.apply(this,arguments),this.options=sd({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)}getValues(e,t){let s,a,o,i,r,n,l,p,u=t.period,h=t.topBand,d=t.bottomBand,c=e.xData,m=e.yData,g=m?m.length:0,y=[],f=[],x=[];if(!(c.length<u)&&sh(m[0])&&4===m[0].length){for(p=u;p<=g;p++)r=c.slice(p-u,p),n=m.slice(p-u,p),i=(l=super.getValues({xData:r,yData:n},t)).xData[0],a=(s=l.yData[0])*(1+h),o=s*(1-d),y.push([i,a,s,o]),f.push(i),x.push([a,s,o]);return{values:y,xData:f,yData:x}}}}sc.defaultOptions=sd(sp.defaultOptions,{marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},params:{period:20,topBand:.1,bottomBand:.1},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}}),su(sc.prototype,{areaLinesNames:["top","bottom"],linesApiNames:["topLine","bottomLine"],nameComponents:["period","topBand","bottomBand"],nameBase:"Price envelopes",pointArrayMap:["top","middle","bottom"],parallelArrays:["x","y","top","bottom"],pointValKey:"middle"}),X.compose(sc),p().registerSeriesType("priceenvelopes",sc);let sm=p().seriesTypes["sma"],sg=i()["merge"];function sy(e,t){return parseFloat(e.toFixed(t))}class sf extends sm{constructor(){super(...arguments),this.nameComponents=void 0}getValues(e,t){let s=e.xData,a=e.yData,o=t.maxAccelerationFactor,i=t.increment,G=t.initialAccelerationFactor,r=t.decimals,n=t.index,l=[],p=[],u=[],h=t.initialAccelerationFactor,d,c=a[0][1],m,g,y,f=1,x,v,D,A,S=a[0][2],b,C,T,P;if(!(n>=a.length)){for(P=0;P<n;P++)c=Math.max(a[P][1],c),S=Math.min(a[P][2],sy(S,r));for(d=a[P][1]>S?1:-1,m=c-S,g=(h=t.initialAccelerationFactor)*m,l.push([s[n],S]),p.push(s[n]),u.push(sy(S,r)),P=n+1;P<a.length;P++){var M,V,L,O,k,E,I,N,w;x=a[P-1][2],v=a[P-2][2],D=a[P-1][1],A=a[P-2][1],C=a[P][1],T=a[P][2],null!==v&&null!==A&&null!==x&&null!==D&&null!==C&&null!==T&&(M=d,V=f,L=S,O=g,k=v,E=x,I=D,N=A,w=c,S=M===V?1===M?L+O<Math.min(k,E)?L+O:Math.min(k,E):L+O>Math.max(N,I)?L+O:Math.max(N,I):w,V=d,M=c,b=1===V?M<C?C:M:T<M?T:M,k=f,E=S,y=1===k&&E<T||-1===k&&E<C?1:-1,L=d,O=c,N=h,I=G,g=(h=y===L?1==y&&O<b||-1==y&&b<O?N===o?o:sy(N+i,2):N:I)*(b-S),l.push([s[P],sy(S,r)]),p.push(s[P]),u.push(sy(S,r)),f=d,d=y,c=b)}return{values:l,xData:p,yData:u}}}}sf.defaultOptions=sg(sm.defaultOptions,{lineWidth:0,marker:{enabled:!0},states:{hover:{lineWidthPlus:0}},params:{period:void 0,initialAccelerationFactor:.02,maxAccelerationFactor:.2,increment:.02,index:2,decimals:4}}),p().registerSeriesType("psar",sf);let sx=p().seriesTypes["sma"],{isArray:sD,merge:sv,extend:sA}=i();class sS extends sx{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=[],n=[],l=[],p,u=-1,h;if(!(a.length<=s)){for(sD(o[0])&&(u=t.index),p=s;p<i;p++)h=function(e,t,s,a,o){let i,r;return r=o<0?(i=t[s-a])?(t[s]-i)/i*100:null:(i=t[s-a][o])?(t[s][o]-i)/i*100:null,[e[s],r]}(a,o,p,s,u),r.push(h),n.push(h[0]),l.push(h[1]);return{values:r,xData:n,yData:l}}}}sS.defaultOptions=sv(sx.defaultOptions,{params:{index:3,period:9}}),sA(sS.prototype,{nameBase:"Rate of Change"}),p().registerSeriesType("roc",sS);let sb=p().seriesTypes["sma"],{isNumber:sT,merge:sC}=i();function sP(e,t){return parseFloat(e.toFixed(t))}class sM extends sb{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=t.decimals,n=[],l=[],p=[],u=0,h=0,d=t.index,c=1,m,g,y,f,x,v;if(!(a.length<s)){for(v=sT(o[0])?o:(d=Math.min(d,o[0].length-1),o.map(e=>e[d]));c<s;)0<(g=sP(v[c]-v[c-1],r))?u+=g:h+=Math.abs(g),c++;for(y=sP(u/(s-1),r),f=sP(h/(s-1),r),x=c;x<i;x++)h=0<(g=sP(v[x]-v[x-1],r))?(u=g,0):(u=0,Math.abs(g)),y=sP((y*(s-1)+u)/s,r),m=0===(f=sP((f*(s-1)+h)/s,r))?100:0===y?0:sP(100-100/(1+y/f),r),n.push([a[x],m]),l.push(a[x]),p.push(m);return{values:n,xData:l,yData:p}}}}sM.defaultOptions=sC(sb.defaultOptions,{params:{decimals:4,index:3}}),p().registerSeriesType("rsi",sM);let sV=p().seriesTypes["sma"],{extend:sL,isArray:sk,merge:sO}=i();class sE extends sV{init(){super.init.apply(this,arguments),this.options=sO({smoothedLine:{styles:{lineColor:this.color}}},this.options)}getValues(e,t){let s=t.periods[0],a=t.periods[1],o=e.xData,i=e.yData,r=i?i.length:0,n=[],l=[],p=[],u,h,d,c=null,m,g;if(!(r<s)&&sk(i[0])&&4===i[0].length){let e=!0,t=0;for(g=s-1;g<r;g++){var y;(u=i.slice(g-s+1,g+1),h=(m=sa.getArrayExtremes(u,2,1))[0],isNaN(d=(i[g][3]-h)/(m[1]-h)*100)&&e)?t++:(e&&!isNaN(d)&&(e=!1),y=l.push(o[g]),isNaN(d)?p.push([p[y-2]&&"number"==typeof p[y-2][0]?p[y-2][0]:null,null]):p.push([d,null]),g>=t+(s-1)+(a-1)&&(c=super.getValues({xData:l.slice(-a),yData:p.slice(-a)},{period:a}).yData[0]),n.push([o[g],d,c]),p[y-1][1]=c)}return{values:n,xData:l,yData:p}}}}sE.defaultOptions=sO(sV.defaultOptions,{params:{index:void 0,period:void 0,periods:[14,3]},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">●</span><b> {series.name}</b><br/>%K: {point.y}<br/>%D: {point.smoothed}<br/>'},smoothedLine:{styles:{lineWidth:1,lineColor:void 0}},dataGrouping:{approximation:"averages"}}),sL(sE.prototype,{areaLinesNames:[],nameComponents:["periods"],nameBase:"Stochastic",pointArrayMap:["y","smoothed"],parallelArrays:["x","y","smoothed"],pointValKey:"y",linesApiNames:["smoothedLine"]}),X.compose(sE),p().registerSeriesType("stochastic",sE);let{sma:sw,stochastic:sI}=p().seriesTypes,{extend:sN,merge:sB}=i();class sG extends sI{getValues(e,t){let s=t.periods,a=super.getValues.call(this,e,t),o={values:[],xData:[],yData:[]};if(a){o.xData=a.xData.slice(s[1]-1);var i=a.yData.slice(s[1]-1),r=sw.prototype.getValues.call(this,{xData:o.xData,yData:i},{index:1,period:s[2]});if(r){for(let e=0,t=o.xData.length;e<t;e++)o.yData[e]=[i[e][1],r.yData[e-s[2]+1]||null],o.values[e]=[o.xData[e],i[e][1],r.yData[e-s[2]+1]||null];return o}}}}sG.defaultOptions=sB(sI.defaultOptions,{params:{periods:[14,3,3]}}),sN(sG.prototype,{nameBase:"Slow Stochastic"}),p().registerSeriesType("slowstochastic",sG);let{atr:sW,sma:sz}=p().seriesTypes,{addEvent:sY,correctFloat:sF,isArray:sX,isNumber:sR,extend:sK,merge:sU,objectEach:sZ}=i();function sj(e,t){return{index:t,close:e.getColumn("close")[t],x:e.getColumn("x")[t]}}class s_ extends sz{init(){let t=this,e=(super.init.apply(t,arguments),sY(this.chart.constructor,"afterLinkSeries",()=>{if(t.options){let e=t.options;e.cropThreshold=t.linkedParent.options.cropThreshold-(e.params.period-1)}e()},{order:1}))}drawGraph(){let s=this,e=s.options,t=s.linkedParent,a=t.getColumn("x"),o=t?t.points:[],i=s.points,r=s.graph,n=o.length-i.length,l=0<n?n:0,p={options:{gapSize:e.gapSize}},u={top:[],bottom:[],intersect:[]},h={top:{styles:{lineWidth:e.lineWidth,lineColor:e.fallingTrendColor||e.color,dashStyle:e.dashStyle}},bottom:{styles:{lineWidth:e.lineWidth,lineColor:e.risingTrendColor||e.color,dashStyle:e.dashStyle}},intersect:e.changeTrendLine},d,c,m,g,y,f,x,v,D,A=i.length;for(;A--;)d=i[A],c=i[A-1],m=o[A-1+l],g=o[A-2+l],y=o[A+l],f=o[A+l+1],x=d.options.color,v={x:d.x,plotX:d.plotX,plotY:d.plotY,isNull:!1},!g&&m&&sR(a[m.index-1])&&(g=sj(t,m.index-1)),!f&&y&&sR(a[y.index+1])&&(f=sj(t,y.index+1)),!m&&g&&sR(a[g.index+1])?m=sj(t,g.index+1):!m&&y&&sR(a[y.index-1])&&(m=sj(t,y.index-1)),d&&m&&y&&g&&d.x!==m.x&&(d.x===y.x?(g=m,m=y):d.x===g.x?(m=g,g={close:t.getColumn("close")[m.index-1],x:a[m.index-1]}):f&&d.x===f.x&&(m=f,g=y)),c&&g&&m?(D={x:c.x,plotX:c.plotX,plotY:c.plotY,isNull:!1},d.y>=m.close&&c.y>=g.close?(d.color=x||e.fallingTrendColor||e.color,u.top.push(v)):d.y<m.close&&c.y<g.close?(d.color=x||e.risingTrendColor||e.color,u.bottom.push(v)):(u.intersect.push(v),u.intersect.push(D),u.intersect.push(sU(D,{isNull:!0})),d.y>=m.close&&c.y<g.close?(d.color=x||e.fallingTrendColor||e.color,c.color=x||e.risingTrendColor||e.color,u.top.push(v),u.top.push(sU(D,{isNull:!0}))):d.y<m.close&&c.y>=g.close&&(d.color=x||e.risingTrendColor||e.color,c.color=x||e.fallingTrendColor||e.color,u.bottom.push(v),u.bottom.push(sU(D,{isNull:!0}))))):m&&(d.y>=m.close?(d.color=x||e.fallingTrendColor||e.color,u.top.push(v)):(d.color=x||e.risingTrendColor||e.color,u.bottom.push(v)));sZ(u,function(e,t){s.points=e,s.options=sU(h[t].styles,p),s.graph=s["graph"+t+"Line"],sz.prototype.drawGraph.call(s),s["graph"+t+"Line"]=s.graph}),s.points=i,s.options=e,s.graph=r}getValues(e,t){let s=t.period,a=t.multiplier,o=e.xData,i=e.yData,r=[],n=[],l=[],p=0===s?0:s-1,u=[],h=[],d,c,m,g,y,f,x,v,D,A;if(!(o.length<=s)&&sX(i[0])&&4===i[0].length&&!(s<0)){for(A=0,d=sW.prototype.getValues.call(this,e,{period:s}).yData;A<d.length;A++)D=i[p+A],v=i[p+A-1]||[],y=u[A-1],f=h[A-1],x=l[A-1],0===A&&(y=f=x=0),c=sF((D[1]+D[2])/2+a*d[A]),m=sF((D[1]+D[2])/2-a*d[A]),c<y||v[3]>y?u[A]=c:u[A]=y,m>f||v[3]<f?h[A]=m:h[A]=f,x===y&&D[3]<u[A]||x===f&&D[3]<h[A]?g=u[A]:(x===y&&D[3]>u[A]||x===f&&D[3]>h[A])&&(g=h[A]),r.push([o[p+A],g]),n.push(o[p+A]),l.push(g);return{values:r,xData:n,yData:l}}}}s_.defaultOptions=sU(sz.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),sK(s_.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),p().registerSeriesType("supertrend",s_);let{prototype:{pointClass:sq}}=p().seriesTypes["sma"],sH=class extends sq{destroy(){this.negativeGraphic&&(this.negativeGraphic=this.negativeGraphic.destroy()),super.destroy.apply(this,arguments)}},s$=i()["animObject"],sJ=i()["noop"],{column:{prototype:sQ},sma:s0}=p().seriesTypes,{addEvent:s1,arrayMax:s2,arrayMin:s3,correctFloat:s4,defined:s5,error:s6,extend:s8,isArray:s9,merge:s7}=i(),ae=Math.abs;class at extends s0{init(s,e){let a=this,o=(delete e.data,super.init.apply(a,arguments),s1(this.chart.constructor,"afterLinkSeries",function(){var e,t;a.options&&(t=a.options.params,e=a.linkedParent,t=s.get(t.volumeSeriesID),a.addCustomEvents(e,t)),o()},{order:1}));return a}addCustomEvents(e,t){let s=this,a=()=>{s.chart.redraw(),s.setData([]),s.zoneStarts=[],s.zoneLinesSVG&&(s.zoneLinesSVG=s.zoneLinesSVG.destroy())};return s.dataEventsToUnbind.push(s1(e,"remove",function(){a()})),t&&s.dataEventsToUnbind.push(s1(t,"remove",function(){a()})),s}animate(e){let s=this,t=s.chart.inverted,a=s.group,o={};!e&&a&&(e=t?s.yAxis.top:s.xAxis.left,t?(a["forceAnimate:translateY"]=!0,o.translateY=e):(a["forceAnimate:translateX"]=!0,o.translateX=e),a.animate(o,s8(s$(s.options.animation),{step:function(e,t){s.group.attr({scaleX:Math.max(.001,t.pos)})}})))}drawPoints(){this.options.volumeDivision.enabled&&(this.posNegVolume(!0,!0),sQ.drawPoints.apply(this,arguments),this.posNegVolume(!1,!1)),sQ.drawPoints.apply(this,arguments)}posNegVolume(e,t){let s=t?["positive","negative"]:["negative","positive"],a=this.options.volumeDivision,o=this.points.length,i=[],r=[],n=0,l,p,u,h;for(e?(this.posWidths=i,this.negWidths=r):(i=this.posWidths,r=this.negWidths);n<o;n++)(h=this.points[n])[s[0]+"Graphic"]=h.graphic,h.graphic=h[s[1]+"Graphic"],e&&(l=h.shapeArgs.width,(u=(p=this.priceZones[n]).wholeVolumeData)?(i.push(l/u*p.positiveVolumeData),r.push(l/u*p.negativeVolumeData)):(i.push(0),r.push(0))),h.color=t?a.styles.positiveColor:a.styles.negativeColor,h.shapeArgs.width=(t?this.posWidths:this.negWidths)[n],h.shapeArgs.x=t?h.shapeArgs.x:this.posWidths[n]}translate(){let s=this,e=s.options,t=s.chart,a=s.yAxis,o=a.min,i=s.options.zoneLines,r=s.priceZones,n=0,l,p,u,h,d,c,m,g,y,f,x=(sQ.translate.apply(s),s.points);x.length&&(m=e.pointPadding<.5?e.pointPadding:.1,l=s2(s.volumeDataArray),p=t.plotWidth/2,g=t.plotTop,u=ae(a.toPixels(o)-a.toPixels(o+s.rangeStep)),d=ae(a.toPixels(o)-a.toPixels(o+s.rangeStep)),m&&(h=ae(u*(1-2*m)),n=ae((u-h)/2),u=ae(h)),x.forEach(function(e,t){y=e.barX=e.plotX=0,f=e.plotY=a.toPixels(r[t].start)-g-(a.reversed?u-d:u)-n,e.pointWidth=c=s4(p*r[t].wholeVolumeData/l),e.shapeArgs=s.crispCol.apply(s,[0,f,c,u]),e.volumeNeg=r[t].negativeVolumeData,e.volumePos=r[t].positiveVolumeData,e.volumeAll=r[t].wholeVolumeData}),i.enabled&&s.drawZones(t,a,s.zoneStarts,i.styles))}getExtremes(){let e,t=this.options.compare,s=this.options.cumulative;return this.options.compare?(this.options.compare=void 0,e=super.getExtremes(),this.options.compare=t):this.options.cumulative?(this.options.cumulative=!1,e=super.getExtremes(),this.options.cumulative=s):e=super.getExtremes(),e}getValues(e,t){let s=e.getColumn("x",!0),a=e.processedYData,o=this.chart,i=t.ranges,r=[],n=[],l=[],p=o.get(t.volumeSeriesID);if(e.chart){var u;if(!p||!p.getColumn("x",!0).length)return u=p&&!p.getColumn("x",!0).length?" does not contain any data.":" not found! Check `volumeSeriesID`.",void s6("Series "+t.volumeSeriesID+u,!0,o);t=s9(a[0]);return t&&4!==a[0].length?void s6("Type of "+e.name+" series is different than line, OHLC or candlestick.",!0,o):((this.priceZones=this.specifyZones(t,s,a,i,p)).forEach(function(e,t){r.push([e.x,e.end]),n.push(r[t][0]),l.push(r[t][1])}),{values:r,xData:n,yData:l})}s6("Base series not found! In case it has been removed, add a new one.",!0,o)}specifyZones(e,t,s,a,o){let i=!!e&&function(e){let t=e.length,s=e[0][3],a=s,o=1,i;for(;o<t;o++)(i=e[o][3])<s&&(s=i),i>a&&(a=i);return{min:s,max:a}}(s),r=this.zoneStarts=[],n=[],l=i?i.min:s3(s),p=i?i.max:s2(s),u=0,h=1,d=this.linkedParent;if(!this.options.compareToMain&&d.dataModify&&(l=d.dataModify.modifyValue(l),p=d.dataModify.modifyValue(p)),!s5(l)||!s5(p))return this.points.length&&(this.setData([]),this.zoneStarts=[],this.zoneLinesSVG&&(this.zoneLinesSVG=this.zoneLinesSVG.destroy())),[];var c=this.rangeStep=s4(p-l)/a;for(r.push(l);u<a-1;u++)r.push(s4(r[u]+c));r.push(p);for(var m=r.length;h<m;h++)n.push({index:h-1,x:t[0],start:r[h-1],end:r[h]});return this.volumePerZone(e,n,o,t,s)}volumePerZone(s,e,t,a,o){let i,r,n,l,p,u=this,h=t.getColumn("x",!0),d=t.getColumn("y",!0),c=e.length-1,m=o.length,g=d.length;return ae(m-g)&&(a[0]!==h[0]&&d.unshift(0),a[m-1]!==h[g-1]&&d.push(0)),u.volumeDataArray=[],e.forEach(function(t){for(p=0,t.wholeVolumeData=0,t.positiveVolumeData=0,t.negativeVolumeData=0;p<m;p++){r=!1,n=!1,l=s?o[p][3]:o[p],i=p?s?o[p-1][3]:o[p-1]:l;let e=u.linkedParent;!u.options.compareToMain&&e.dataModify&&(l=e.dataModify.modifyValue(l),i=e.dataModify.modifyValue(i)),l<=t.start&&0===t.index&&(r=!0),l>=t.end&&t.index===c&&(n=!0),(l>t.start||r)&&(l<t.end||n)&&(t.wholeVolumeData+=d[p],i>l?t.negativeVolumeData+=d[p]:t.positiveVolumeData+=d[p])}u.volumeDataArray.push(t.wholeVolumeData)}),e}drawZones(t,s,e,a){let o=t.renderer,i=t.plotWidth,r=t.plotTop,n=this.zoneLinesSVG,l=[],p;e.forEach(function(e){p=s.toPixels(e)-r,l=l.concat(t.renderer.crispLine([["M",0,p],["L",i,p]],a.lineWidth))}),n?n.animate({d:l}):n=this.zoneLinesSVG=o.path(l).attr({"stroke-width":a.lineWidth,stroke:a.color,dashstyle:a.dashStyle,zIndex:this.group.zIndex+.1}).add(this.group)}}at.defaultOptions=s7(s0.defaultOptions,{params:{index:void 0,period:void 0,ranges:12,volumeSeriesID:"volume"},zoneLines:{enabled:!0,styles:{color:"#0A9AC9",dashStyle:"LongDash",lineWidth:1}},volumeDivision:{enabled:!0,styles:{positiveColor:"rgba(144, 237, 125, 0.8)",negativeColor:"rgba(244, 91, 91, 0.8)"}},animationLimit:1e3,enableMouseTracking:!1,pointPadding:0,zIndex:-1,crisp:!0,dataGrouping:{enabled:!1},dataLabels:{align:"left",allowOverlap:!0,enabled:!0,format:"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}",padding:0,style:{fontSize:"0.5em"},verticalAlign:"top"}}),s8(at.prototype,{nameBase:"Volume by Price",nameComponents:["ranges"],calculateOn:{chart:"render",xAxis:"afterSetExtremes"},pointClass:sH,markerAttribs:sJ,drawGraph:sJ,getColumnMetrics:sQ.getColumnMetrics,crispCol:sQ.crispCol}),p().registerSeriesType("vbp",at);let as=p().seriesTypes["sma"],{error:aa,isArray:ao,merge:ai}=i();class an extends as{getValues(e,t){let s=e.chart,a=e.xData,o=e.yData,i=t.period,r=!0,n;return(n=s.get(t.volumeSeriesID))?(ao(o[0])||(r=!1),this.calculateVWAPValues(r,a,o,n,i)):void aa("Series "+t.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,s)}calculateVWAPValues(e,t,s,a,o){let i,r,n,l,p,u,h=a.getColumn("y"),d=h.length,c=t.length,m=[],g=[],y=[],f=[],x=[];for(p=0,i=c<=d?c:d,u=0;p<i;p++)r=(e?(s[p][1]+s[p][2]+s[p][3])/3:s[p])*h[p],n=u?m[p-1]+r:r,l=u?g[p-1]+h[p]:h[p],m.push(n),g.push(l),x.push([t[p],n/l]),y.push(x[p][0]),f.push(x[p][1]),++u===o&&(u=0);return{values:x,xData:y,yData:f}}}an.defaultOptions=ai(as.defaultOptions,{params:{index:void 0,period:30,volumeSeriesID:"volume"}}),p().registerSeriesType("vwap",an);let ar=p().seriesTypes["sma"],{extend:al,isArray:ap,merge:au}=i();class ah extends ar{getValues(e,t){let s,a,o,i,r,n,l=t.period,p=e.xData,u=e.yData,h=u?u.length:0,d=[],c=[],m=[];if(!(p.length<l)&&ap(u[0])&&4===u[0].length){for(n=l-1;n<h;n++)s=u.slice(n-l+1,n+1),r=(a=sa.getArrayExtremes(s,2,1))[0],o=-((i=a[1])-u[n][3])/(i-r)*100,p[n]&&(d.push([p[n],o]),c.push(p[n]),m.push(o));return{values:d,xData:c,yData:m}}}}ah.defaultOptions=au(ar.defaultOptions,{params:{index:void 0,period:14}}),al(ah.prototype,{nameBase:"Williams %R"}),p().registerSeriesType("williamsr",ah);let ad=p().seriesTypes["sma"],{isArray:ac,merge:am}=i();function ag(e,t,s,a,o){t=t[a],s=o<0?s[a]:s[a][o];e.push([t,s])}function ay(e,t,s,a){var o=e.length,o=e.reduce(function(e,t,s){return[null,e[1]+t[1]*(s+1)]})[1]/((o+1)/2*o),t=t[a-1];return e.shift(),[t,o]}class af extends ad{getValues(e,t){let s=t.period,a=e.xData,o=e.yData,i=o?o.length:0,r=a[0],n=[],l=[],p=[],u=1,h=-1,d,c,m=o[0];if(!(a.length<s)){ac(o[0])&&(h=t.index,m=o[0][h]);for(var g=[[r,m]];u!==s;)ag(g,a,o,u,h),u++;for(d=u;d<i;d++)n.push(c=ay(g,a,o,d)),l.push(c[0]),p.push(c[1]),ag(g,a,o,d,h);return n.push(c=ay(g,a,o,d)),l.push(c[0]),p.push(c[1]),{values:n,xData:l,yData:p}}}}af.defaultOptions=am(ad.defaultOptions,{params:{index:3,period:9}}),p().registerSeriesType("wma",af);let ax=p().seriesTypes["sma"],{merge:aD,extend:av}=i();class aA extends ax{getValues(e,t){let s=t.lowIndex,a=t.highIndex,o=t.deviation/100,i=1+o,r=1-o,n=e.xData,l=e.yData,p=l?l.length:0,u=[],h=[],d=[],c,m,g,y,f=!1,x=!1;if(!(!n||n.length<=1||p&&(void 0===l[0][s]||void 0===l[0][a]))){var v=l[0][s],D=l[0][a];for(c=1;c<p;c++)l[c][s]<=D*r?(u.push([n[0],D]),g=[n[c],l[c][s]],y=!0,f=!0):l[c][a]>=v*i&&(u.push([n[0],v]),g=[n[c],l[c][a]],y=!1,f=!0),f&&(h.push(u[0][0]),d.push(u[0][1]),m=c++,c=p);for(c=m;c<p;c++)y?(l[c][s]<=g[1]&&(g=[n[c],l[c][s]]),l[c][a]>=g[1]*i&&(x=a)):(l[c][a]>=g[1]&&(g=[n[c],l[c][a]]),l[c][s]<=g[1]*r&&(x=s)),!1!==x&&(u.push(g),h.push(g[0]),d.push(g[1]),g=[n[c],l[c][x]],y=!y,x=!1);t=u.length;return 0!==t&&u[t-1][0]<n[p-1]&&(u.push(g),h.push(g[0]),d.push(g[1])),{values:u,xData:h,yData:d}}}}aA.defaultOptions=aD(ax.defaultOptions,{params:{index:void 0,period:void 0,lowIndex:2,highIndex:1,deviation:1}}),av(aA.prototype,{nameComponents:["deviation"],nameSuffixes:["%"],nameBase:"Zig Zag"}),p().registerSeriesType("zigzag",aA);let aS=p().seriesTypes["sma"],{isArray:ab,extend:aT,merge:aC}=i();class aP extends aS{getRegressionLineParameters(e,t){function s(e,t){return ab(e)?e[t]:e}let a=this.options.params.index,o=e.reduce(function(e,t){return t+e},0),i=t.reduce(function(e,t){return s(t,a)+e},0),r=o/e.length,n=i/t.length,l,p,u=0,h=0;for(p=0;p<e.length;p++)u+=(l=e[p]-r)*(s(t[p],a)-n),h+=Math.pow(l,2);var d=h?u/h:0;return{slope:d,intercept:n-d*r}}getEndPointY(e,t){return e.slope*t+e.intercept}transformXData(e,t){let s=e[0];return e.map(function(e){return(e-s)/t})}findClosestDistance(e){let t,s,a;for(a=1;a<e.length-1;a++)0<(t=e[a]-e[a-1])&&(void 0===s||t<s)&&(s=t);return s}getValues(e,t){let s,a,o,i,r,n,l,p,u,h=e.xData,d=e.yData,c=t.period,m={xData:[],yData:[],values:[]},g=this.options.params.xAxisUnit||this.findClosestDistance(h);for(a=c-1;a<=h.length-1;a++)o=a-c+1,i=a+1,r=h[a],l=h.slice(o,i),p=d.slice(o,i),u=this.transformXData(l,g),s=this.getRegressionLineParameters(u,p),n=this.getEndPointY(s,u[u.length-1]),m.values.push({regressionLineParameters:s,x:r,y:n}),ab(m.xData)&&m.xData.push(r),ab(m.yData)&&m.yData.push(n);return m}}aP.defaultOptions=aC(aS.defaultOptions,{params:{xAxisUnit:null},tooltip:{valueDecimals:4}}),aT(aP.prototype,{nameBase:"Linear Regression Indicator"}),p().registerSeriesType("linearRegression",aP);let aM=p().seriesTypes["linearRegression"],{extend:aV,merge:aL}=i();class ak extends aM{getEndPointY(e){return e.slope}}ak.defaultOptions=aL(aM.defaultOptions),aV(ak.prototype,{nameBase:"Linear Regression Slope Indicator"}),p().registerSeriesType("linearRegressionSlope",ak);let aO=p().seriesTypes["linearRegression"],{extend:aE,merge:aw}=i();class aI extends aO{getEndPointY(e){return e.intercept}}aI.defaultOptions=aw(aO.defaultOptions),aE(aI.prototype,{nameBase:"Linear Regression Intercept Indicator"}),p().registerSeriesType("linearRegressionIntercept",aI);let aN=p().seriesTypes["linearRegression"],{extend:aB,merge:aG}=i();class aW extends aN{slopeToAngle(e){return 180/Math.PI*Math.atan(e)}getEndPointY(e){return this.slopeToAngle(e.slope)}}aW.defaultOptions=aG(aN.defaultOptions,{tooltip:{pointFormat:'<span style="color:{point.color}">●</span>{series.name}: <b>{point.y}°</b><br/>'}}),aB(aW.prototype,{nameBase:"Linear Regression Angle Indicator"}),p().registerSeriesType("linearRegressionAngle",aW);let az=p().seriesTypes["sma"],{correctFloat:aY,extend:aF,merge:aX}=i();class aR extends az{getValues(e,t){let s,a,o,i,r,n,l,p,u,h,d,c=t.period,m=t.factor,g=t.index,y=e.xData,f=e.yData,x=f?f.length:0,v=[],D=[],A=[],S=[],b=[];if(!(x<c)){for(d=0;d<=x;d++){var C,T;d<x&&(C=f[d][2],T=f[d][1],r=aY(T-C)/(aY(T+C)/2)*1e3*m,v.push(f[d][1]*aY(1+2*r)),D.push(f[d][2]*aY(1-2*r))),d>=c&&(u=y.slice(d-c,d),h=f.slice(d-c,d),l=super.getValues.call(this,{xData:u,yData:v.slice(d-c,d)},{period:c}),p=super.getValues.call(this,{xData:u,yData:D.slice(d-c,d)},{period:c}),i=(n=super.getValues.call(this,{xData:u,yData:h},{period:c,index:g})).xData[0],a=l.yData[0],o=p.yData[0],s=n.yData[0],A.push([i,a,s,o]),S.push(i),b.push([a,s,o]))}return{values:A,xData:S,yData:b}}}}aR.defaultOptions=aX(az.defaultOptions,{params:{period:20,factor:.001,index:3},lineWidth:1,topLine:{styles:{lineWidth:1}},bottomLine:{styles:{lineWidth:1}},dataGrouping:{approximation:"averages"}}),aF(aR.prototype,{areaLinesNames:["top","bottom"],linesApiNames:["topLine","bottomLine"],nameBase:"Acceleration Bands",nameComponents:["period","factor"],pointArrayMap:["top","middle","bottom"],pointValKey:"middle"}),X.compose(aR),p().registerSeriesType("abands",aR);let aK=p().seriesTypes["sma"],{extend:aU,merge:aZ,isArray:aj}=i();class a_ extends aK{constructor(){super(...arguments),this.updateAllPoints=!0}getValues(e,t){let s=e.xData,a=e.yData,o=[],i=[],r=[],n=[],l=t.index,p=0,u=0,h=0,d=0,c=0;for(let e=0;e<s.length;e++)0!==e&&s[e]===s[e-1]||c++,o.push(c);for(let e=0;e<o.length;e++)h+=o[e],d+=aj(a[e])?a[e][l]:a[e];var m,g,y=h/o.length,f=d/a.length;for(let e=0;e<o.length;e++){var x=aj(a[e])?a[e][l]:a[e];p+=(o[e]-y)*(x-f),u+=Math.pow(o[e]-y,2)}for(let e=0;e<o.length;e++)s[e]!==r[r.length-1]&&(m=s[e],g=f+p/u*(o[e]-y),i.push([m,g]),r.push(m),n.push(g));return{xData:r,yData:n,values:i}}}a_.defaultOptions=aZ(aK.defaultOptions,{params:{period:void 0,index:3}}),aU(a_.prototype,{nameBase:"Trendline",nameComponents:void 0}),p().registerSeriesType("trendline",a_);let aq=p().seriesTypes["sma"],{correctFloat:aH,defined:a$,extend:aJ,isArray:aQ,merge:a0}=i();class a1 extends aq{init(){var e=arguments,t=e[1].params,t=t&&t.average?t.average:void 0;this.averageIndicator=p().seriesTypes[t]||aq,this.averageIndicator.prototype.init.apply(this,e)}calculateDisparityIndex(e,t){return aH(e-t)/t*100}getValues(e,t){let s=t.index,a=e.xData,o=e.yData,i=o?o.length:0,r=[],n=[],l=[],p=this.averageIndicator,u=aQ(o[0]),h=p.prototype.getValues(e,t),d=h.yData,c=a.indexOf(h.xData[0]);if(d&&0!==d.length&&a$(s)&&!(o.length<=c)){for(let e=c;e<i;e++){var m=this.calculateDisparityIndex(u?o[e][s]:o[e],d[e-c]);r.push([a[e],m]),n.push(a[e]),l.push(m)}return{values:r,xData:n,yData:l}}}}a1.defaultOptions=a0(aq.defaultOptions,{params:{average:"sma",index:3},marker:{enabled:!1},dataGrouping:{approximation:"averages"}}),aJ(a1.prototype,{nameBase:"Disparity Index",nameComponents:["period","average"]}),p().registerSeriesType("disparityindex",a1),a.d({},{});let a2=i(),a3=(a2.MultipleLinesComposition=a2.MultipleLinesComposition||X,i());export{a3 as default};
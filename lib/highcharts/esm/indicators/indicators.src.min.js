import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";import*as __WEBPACK_EXTERNAL_MODULE__modules_stock_src_js_b3d80146__ from"../modules/stock.src.js";var __webpack_require__={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},d:(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject);const external_highcharts_src_js_default_Chart_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.Chart;var external_highcharts_src_js_default_Chart_default=__webpack_require__.n(external_highcharts_src_js_default_Chart_namespaceObject);const external_highcharts_src_js_default_SeriesRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SeriesRegistry;var MultipleLinesComposition,external_highcharts_src_js_default_SeriesRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_SeriesRegistry_namespaceObject);const LineSeries=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes["line"],{addEvent,fireEvent,error,extend,isArray,merge,pick}=external_highcharts_src_js_default_default(),tableToMultiYData=(t,a)=>{const e=[],r=t.pointArrayMap,i=a&&t.dataTable.modified||t.dataTable;if(!r)return t.getColumn("y",a);const s=r.map(e=>t.getColumn(e,a));for(let a=0;a<i.rowCount;a++){var n=r.map((e,t)=>s[t]?.[a]||0);e.push(n)}return e};class SMAIndicator extends LineSeries{destroy(){this.dataEventsToUnbind.forEach(function(e){e()}),super.destroy.apply(this,arguments)}getName(){const a=[];let e=this.name;return e||((this.nameComponents||[]).forEach(function(e,t){a.push(this.options.params[e]+pick(this.nameSuffixes[t],""))},this),e=(this.nameBase||this.type.toUpperCase())+(this.nameComponents?" ("+a.join(", ")+")":"")),e}getValues(e,t){const a=t.period,r=e.xData||[],i=e.yData,s=i.length,n=[],o=[],l=[];let _,c=-1,p=0,d,h=0;if(!(r.length<a)){for(isArray(i[0])&&(c=t.index||0);p<a-1;)h+=c<0?i[p]:i[p][c],p++;for(_=p;_<s;_++)h+=c<0?i[_]:i[_][c],d=[r[_],h/a],n.push(d),o.push(d[0]),l.push(d[1]),h-=c<0?i[_-p]:i[_-p][c];return{values:n,xData:o,yData:l}}}init(a,e){const r=this;super.init.call(r,a,e);e=addEvent(external_highcharts_src_js_default_Chart_default(),"afterLinkSeries",function({isUpdating:e}){if(!e){e=!!r.dataEventsToUnbind.length;if(!r.linkedParent)return error("Series "+r.options.linkedTo+" not found! Check `linkedTo`.",!1,a);if(e||(r.dataEventsToUnbind.push(addEvent(r.linkedParent,"updatedData",function(){r.recalculateValues()})),r.calculateOn.xAxis&&r.dataEventsToUnbind.push(addEvent(r.linkedParent.xAxis,r.calculateOn.xAxis,function(){r.recalculateValues()}))),"init"===r.calculateOn.chart)r.closestPointRange||r.recalculateValues();else if(!e){const t=addEvent(r.chart,r.calculateOn.chart,function(){r.recalculateValues(),t()})}}},{order:0});r.dataEventsToUnbind=[],r.eventsToUnbind.push(e)}recalculateValues(){const e=[],t=this,a=this.dataTable,r=t.points||[],i=t.dataTable.rowCount,s={values:[],xData:[],yData:[]};let n=!0,o,l,_,c;var p=t.linkedParent.yData,d=t.linkedParent.processedYData;t.linkedParent.xData=t.linkedParent.getColumn("x"),t.linkedParent.yData=tableToMultiYData(t.linkedParent),t.linkedParent.processedYData=tableToMultiYData(t.linkedParent,!0);const h=t.linkedParent.options&&t.linkedParent.dataTable.rowCount&&t.getValues(t.linkedParent,t.options.params)||s,u=(delete t.linkedParent.xData,t.linkedParent.yData=p,t.linkedParent.processedYData=d,t.pointArrayMap||["y"]),f={};if(h.yData.forEach(r=>{u.forEach((e,t)=>{const a=f[e]||[];a.push(isArray(r)?r[t]:r),f[e]||(f[e]=a)})}),i&&!t.hasGroupedData&&t.visible&&t.points)if(t.cropped){t.xAxis&&(_=t.xAxis.min,c=t.xAxis.max);var m=t.cropData(a,_,c);const x=["x",...t.pointArrayMap||["y"]];for(let t=0;t<(m.modified?.rowCount||0);t++){var g=x.map(e=>this.getColumn(e)[t]||0);e.push(g)}p=t.getColumn("x");o=h.xData.indexOf(p[0]),l=h.xData.indexOf(p[p.length-1]),-1===o&&l===h.xData.length-2&&e[0][0]===r[0].x&&e.shift(),t.updateData(e)}else(t.updateAllPoints||h.xData.length!==i-1&&h.xData.length!==i+1)&&(n=!1,t.updateData(h.values));n&&(a.setColumns({...f,x:h.xData}),t.options.data=h.values),t.calculateOn.xAxis&&t.getColumn("x",!0).length&&(t.isDirty=!0,t.redraw()),t.isDirtyData=!!t.linkedSeries.length,fireEvent(t,"updatedData")}processData(){var e=this,t=e.options.compareToMain,a=e.linkedParent;super.processData.apply(e,arguments),e.dataModify&&a&&a.dataModify&&a.dataModify.compareValue&&t&&(e.dataModify.compareValue=a.dataModify.compareValue)}}SMAIndicator.defaultOptions=merge(LineSeries.defaultOptions,{name:void 0,tooltip:{valueDecimals:4},linkedTo:void 0,compareToMain:!1,params:{index:3,period:14}}),extend(SMAIndicator.prototype,{calculateOn:{chart:"init"},hasDerivedData:!0,nameComponents:["period"],nameSuffixes:[],useCommonDataGrouping:!0}),external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("sma",SMAIndicator);const SMA_SMAIndicator=null,EMAIndicator_SMAIndicator=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes["sma"],{correctFloat,isArray:EMAIndicator_isArray,merge:EMAIndicator_merge}=external_highcharts_src_js_default_default();class EMAIndicator extends EMAIndicator_SMAIndicator{accumulatePeriodPoints(e,t,a){let r=0,i=0,s;for(;i<e;)s=t<0?a[i]:a[i][t],r+=s,i++;return r}calculateEma(e,t,a,r,i,s,n){e=e[a-1],t=s<0?t[a-1]:t[a-1][s];return[e,void 0===i?n:correctFloat(t*r+i*(1-r))]}getValues(e,t){const a=t.period,r=e.xData,i=e.yData,s=i?i.length:0,n=2/(a+1),o=[],l=[],_=[];let c,p,d,h=-1,u;if(!(s<a)){for(EMAIndicator_isArray(i[0])&&(h=t.index||0),u=this.accumulatePeriodPoints(a,h,i)/a,d=a;d<s+1;d++)p=this.calculateEma(r,i,d,n,c,h,u),o.push(p),l.push(p[0]),_.push(p[1]),c=p[1];return{values:o,xData:l,yData:_}}}}EMAIndicator.defaultOptions=EMAIndicator_merge(EMAIndicator_SMAIndicator.defaultOptions,{params:{index:3,period:9}}),external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("ema",EMAIndicator);const EMA_EMAIndicator=null,{prototype:smaProto}=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes["sma"],{defined,error:MultipleLinesComposition_error,merge:MultipleLinesComposition_merge}=external_highcharts_src_js_default_default(),Indicators_MultipleLinesComposition=(!function(e){const a=["bottomLine"],r=["top","bottom"],i=["top"];function f(e){return"plot"+e.charAt(0).toUpperCase()+e.slice(1)}function m(e,t){const a=[];return(e.pointArrayMap||[]).forEach(e=>{e!==t&&a.push(f(e))}),a}function s(){const a=this,e=a.pointValKey,t=a.linesApiNames,r=a.areaLinesNames,i=a.points,s=a.options,n=a.graph,o={options:{gapSize:s.gapSize}},l=[],_=m(a,e);let c=i.length,p;var d,h,u;_.forEach((e,t)=>{for(l[t]=[];c--;)p=i[c],l[t].push({x:p.x,plotX:p.plotX,plotY:p[e],isNull:!defined(p[e])});c=i.length}),a.userOptions.fillColor&&r.length&&(d=_.indexOf(f(r[0])),d=l[d],h=1===r.length?i:l[_.indexOf(f(r[1]))],u=a.color,a.points=h,a.nextPoints=d,a.color=a.userOptions.fillColor,a.options=MultipleLinesComposition_merge(i,o),a.graph=a.area,a.fillGraph=!0,smaProto.drawGraph.call(a),a.area=a.graph,delete a.nextPoints,delete a.fillGraph,a.color=u),t.forEach((e,t)=>{l[t]?(a.points=l[t],s[e]?a.options=MultipleLinesComposition_merge(s[e].styles,o):MultipleLinesComposition_error('Error: "There is no '+e+' in DOCS options declared. Check if linesApiNames are consistent with your DOCS line names."'),a.graph=a["graph"+e],smaProto.drawGraph.call(a),a["graph"+e]=a.graph):MultipleLinesComposition_error('Error: "'+e+" doesn't have equivalent in pointArrayMap. To many elements in linesApiNames relative to pointArrayMap.\"")}),a.points=i,a.options=s,a.graph=n,smaProto.drawGraph.call(a)}function n(e){let t,a=[],r;if(e=e||this.points,this.fillGraph&&this.nextPoints){if((t=smaProto.getGraphPath.call(this,this.nextPoints))&&t.length){t[0][0]="L",a=smaProto.getGraphPath.call(this,e);for(let e=(r=t.slice(0,a.length)).length-1;0<=e;e--)a.push(r[e])}}else a=smaProto.getGraphPath.apply(this,arguments);return a}function o(t){const a=[];return(this.pointArrayMap||[]).forEach(e=>{a.push(t[e])}),a}function l(){const e=this.pointArrayMap;let r,i;r=m(this),smaProto.translate.apply(this,arguments),this.points.forEach(a=>{e.forEach((e,t)=>{i=a[e],null!==(i=this.dataModify?this.dataModify.modifyValue(i):i)&&(a[r[t]]=this.yAxis.toPixels(i,!0))})})}e.compose=function(e){const t=e.prototype;return t.linesApiNames=t.linesApiNames||a.slice(),t.pointArrayMap=t.pointArrayMap||r.slice(),t.pointValKey=t.pointValKey||"top",t.areaLinesNames=t.areaLinesNames||i.slice(),t.drawGraph=s,t.getGraphPath=n,t.toYData=o,t.translate=l,e}}(MultipleLinesComposition=MultipleLinesComposition||{}),MultipleLinesComposition);var x=e=>{var t={};return __webpack_require__.d(t,e),t},y=e=>()=>e;const stock_src_js_namespaceObject=x({}),G=external_highcharts_src_js_default_default(),indicators_src=(G.MultipleLinesComposition=G.MultipleLinesComposition||Indicators_MultipleLinesComposition,external_highcharts_src_js_default_default());export{indicators_src as default};
import*as e from"../highcharts.js";import"./stock.js";var t={n:e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};let s=e.default;var i=t.n(s);let{addEvent:o,clamp:r,isNumber:n,relativeLength:h}=i();class a{constructor(e){this.init(e)}init(e,t){this.axis=e,this.options=e.options.resize||{},this.render(),t||this.addMouseEvents()}render(){let e=this.axis,t=e.chart,s=this.options,i=s.x||0,o=s.y,n=r(e.top+e.height+o,t.plotTop,t.plotTop+t.plotHeight),a={};t.styledMode||(a={cursor:s.cursor,stroke:s.lineColor,"stroke-width":s.lineWidth,dashstyle:s.lineDashStyle}),this.lastPos=n-o,this.controlLine||(this.controlLine=t.renderer.path().addClass("highcharts-axis-resizer")),this.controlLine.add(e.axisGroup);var h=t.styledMode?this.controlLine.strokeWidth():s.lineWidth;a.d=t.renderer.crispLine([["M",e.left+i,n],["L",e.left+e.width+i,n]],h),this.controlLine.attr(a)}addMouseEvents(){let e,t,s,i=this,r=i.controlLine.element,n=i.axis.chart.container,a=[];i.mouseMoveHandler=e=e=>i.onMouseMove(e),i.mouseUpHandler=t=e=>i.onMouseUp(e),i.mouseDownHandler=s=()=>i.onMouseDown(),a.push(o(n,"mousemove",e),o(n.ownerDocument,"mouseup",t),o(r,"mousedown",s),o(n,"touchmove",e),o(n.ownerDocument,"touchend",t),o(r,"touchstart",s)),i.eventsToUnbind=a}onMouseMove(t){if(!t.touches||0!==t.touches[0].pageX){let e=this.axis.chart.pointer;this.grabbed&&e&&(this.hasDragged=!0,this.updateAxes(e.normalize(t).chartY-(this.options.y||0)))}}onMouseUp(e){let t=this.axis.chart.pointer;this.hasDragged&&t&&this.updateAxes(t.normalize(e).chartY-(this.options.y||0)),this.grabbed=this.hasDragged=this.axis.chart.activeResizer=void 0}onMouseDown(){this.axis.chart.pointer?.reset(!1,0),this.grabbed=this.axis.chart.activeResizer=!0}updateAxes(a){let l=this.axis.chart,e=this.options.controlledAxis,d=0===e.next.length?[l.yAxis.indexOf(this.axis)+1]:e.next,t=[this.axis].concat(e.prev),p=[],c=l.plotTop,u=l.plotHeight,x=c+u,v=e=>100*e/u+"%",f=(e,t,s)=>Math.round(r(e,t,s)),g=!1,y=(a=r(a,c,x))-this.lastPos;if(!(y*y<1)){let r=!0;for(var m of[t,d])for(var z of m){let e,t,s=n(z)?l.yAxis[z]:r?z:l.get(z),i=s&&s.options,o={};var M;!i||i.isInternal?r=!1:(t=s.top,z=Math.round(h(i.minLength||NaN,u)),M=Math.round(h(i.maxLength||NaN,u)),r||m!==d?((e=f(a-t,z,M))===M&&(g=!0),a=t+e,p.push({axis:s,options:{height:v(e)}})):(y=a-this.lastPos,e=f(s.len-y,z,M),(t=s.top+y)+e>x&&(a+=M=x-e-t,t+=M),(e=t<c&&(t=c)+e>x?u:e)===z&&(g=!0),p.push({axis:s,options:{top:v(t-c),height:v(e)}})),r=!1,o.height=e)}if(!g){for(var s of p)s.axis.update(s.options,!1);l.redraw(!1)}}}destroy(){let e=this.axis;for(var t of(delete e.resizer,this.eventsToUnbind&&this.eventsToUnbind.forEach(e=>e()),this.controlLine.destroy(),Object.keys(this)))this[t]=null}}a.resizerOptions={minLength:"10%",maxLength:"100%",resize:{controlledAxis:{next:[],prev:[]},enabled:!1,cursor:"ns-resize",lineColor:"#cccccc",lineDashStyle:"Solid",lineWidth:4,x:0,y:0}};let l=i()["defaultOptions"],{addEvent:c,merge:d,wrap:p}=i();function u(){let e=this.resizer,t=this.options.resize;var s;t&&(s=!1!==t.enabled,e?s?e.init(this,!0):e.destroy():s&&(this.resizer=new a(this)))}function x(e){!e.keepEvents&&this.resizer&&this.resizer.destroy()}function f(e){this.chart.activeResizer||e.apply(this,[].slice.call(arguments,1))}function g(e){this.chart.activeResizer||e.apply(this,[].slice.call(arguments,1))}t.d({},{});let y=i(),m=(y.AxisResizer=a,function(e,t){e.keepProps.includes("resizer")||(d(!0,l.yAxis,a.resizerOptions),e.keepProps.push("resizer"),c(e,"afterRender",u),c(e,"destroy",x),p(t.prototype,"runPointActions",g),p(t.prototype,"drag",f))}(y.Axis,y.Pointer),i());export{m as default};
import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";var __webpack_require__={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},d:(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var ColumnUtils,external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject);const{addEvent,fireEvent,merge}=external_highcharts_src_js_default_default();class DataModifier{benchmark(e,t){const r=[],o=this,n=()=>{o.modifyTable(e),o.emit({type:"afterBenchmarkIteration"})};const s=merge({iterations:1},t)["iterations"],a=(o.on("afterBenchmarkIteration",()=>{r.length===s?o.emit({type:"afterBenchmark",results:r}):n()}),{startTime:0,endTime:0});return o.on("modify",()=>{a.startTime=window.performance.now()}),o.on("afterModify",()=>{a.endTime=window.performance.now(),r.push(a.endTime-a.startTime)}),n(),r}emit(e){fireEvent(this,e.type,e)}modify(r,o){const n=this;return new Promise((e,t)=>{r.modified===r&&(r.modified=r.clone(!1,o));try{e(n.modifyTable(r,o))}catch(e){n.emit({type:"error",detail:o,table:r}),t(e)}})}modifyCell(e,t,r,o,n){return this.modifyTable(e)}modifyColumns(e,t,r,o){return this.modifyTable(e)}modifyRows(e,t,r,o){return this.modifyTable(e)}on(e,t){return addEvent(this,e,t)}}!function(r){r.types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)}}(DataModifier=DataModifier||{});const Modifiers_DataModifier=DataModifier,Data_ColumnUtils=(!function(e){e.setLength=function(e,t,r){return Array.isArray(e)?(e.length=t,e):e[r?"subarray":"slice"](0,t)},e.splice=function(e,t,r,o,n=[]){if(Array.isArray(e))return Array.isArray(n)||(n=Array.from(n)),{removed:e.splice(t,r,...n),array:e};const s=Object.getPrototypeOf(e).constructor;var o=e[o?"subarray":"slice"](t,t+r),a=e.length-r+n.length;const i=new s(a);return i.set(e.subarray(0,t),0),i.set(n,t),i.set(e.subarray(t+r),t+n.length),{removed:o,array:i}}}(ColumnUtils=ColumnUtils||{}),ColumnUtils),{setLength,splice}=Data_ColumnUtils,{fireEvent:DataTableCore_fireEvent,objectEach,uniqueKey}=external_highcharts_src_js_default_default();class DataTableCore{constructor(e={}){this.autoId=!e.id,this.columns={},this.id=e.id||uniqueKey(),(this.modified=this).rowCount=0,this.versionTag=uniqueKey();let r=0;objectEach(e.columns||{},(e,t)=>{this.columns[t]=e.slice(),r=Math.max(r,e.length)}),this.applyRowCount(r)}applyRowCount(r){this.rowCount=r,objectEach(this.columns,(e,t)=>{e.length!==r&&(this.columns[t]=setLength(e,r))})}deleteRows(o,n=1){if(0<n&&o<this.rowCount){let r=0;objectEach(this.columns,(e,t)=>{this.columns[t]=splice(e,o,n).array,r=e.length}),this.rowCount=r}DataTableCore_fireEvent(this,"afterDeleteRows",{rowIndex:o,rowCount:n}),this.versionTag=uniqueKey()}getColumn(e,t){return this.columns[e]}getColumns(e,t){return(e||Object.keys(this.columns)).reduce((e,t)=>(e[t]=this.columns[t],e),{})}getRow(t,e){return(e||Object.keys(this.columns)).map(e=>this.columns[e]?.[t])}setColumn(e,t=[],r=0,o){this.setColumns({[e]:t},r,o)}setColumns(e,t,r){let o=this.rowCount;objectEach(e,(e,t)=>{this.columns[t]=e.slice(),o=e.length}),this.applyRowCount(o),r?.silent||(DataTableCore_fireEvent(this,"afterSetColumns"),this.versionTag=uniqueKey())}setRow(e,o=this.rowCount,n,s){const a=this["columns"],i=n?this.rowCount+1:o+1;objectEach(e,(e,t)=>{let r=a[t]||!1!==s?.addColumns&&new Array(i);r&&(n?r=splice(r,o,0,!0,[e]).array:r[o]=e,a[t]=r)}),i>this.rowCount&&this.applyRowCount(i),s?.silent||(DataTableCore_fireEvent(this,"afterSetRows"),this.versionTag=uniqueKey())}}const Data_DataTableCore=DataTableCore,{addEvent:DataTable_addEvent,defined,extend,fireEvent:DataTable_fireEvent,isNumber,uniqueKey:DataTable_uniqueKey}=external_highcharts_src_js_default_default();class DataTable extends Data_DataTableCore{static isNull(r){if(r===DataTable.NULL)return!0;if(r instanceof Array){if(!r.length)return!1;for(let e=0,t=r.length;e<t;++e)if(null!==r[e])return!1}else{var o=Object.keys(r);if(!o.length)return!1;for(let e=0,t=o.length;e<t;++e)if(null!==r[o[e]])return!1}return!0}constructor(e={}){super(e),this.modified=this}clone(e,t){const r=this,o={},n=(r.emit({type:"cloneTable",detail:t}),e||(o.columns=r.columns),r.autoId||(o.id=r.id),new DataTable(o));return e||(n.versionTag=r.versionTag,n.originalRowIndexes=r.originalRowIndexes,n.localRowIndexes=r.localRowIndexes),r.emit({type:"afterCloneTable",detail:t,tableClone:n}),n}deleteColumns(n,e){const t=this,s=t.columns,a={},i={},r=t.modifier,l=t.rowCount;if((n=n||Object.keys(s)).length){t.emit({type:"deleteColumns",columnNames:n,detail:e});for(let e=0,t=n.length,r,o;e<t;++e)o=n[e],(r=s[o])&&(a[o]=r,i[o]=new Array(l)),delete s[o];return Object.keys(s).length||(t.rowCount=0,this.deleteRowIndexReferences()),r&&r.modifyColumns(t,i,0,e),t.emit({type:"afterDeleteColumns",columns:a,columnNames:n,detail:e}),a}}deleteRowIndexReferences(){delete this.originalRowIndexes,delete this.localRowIndexes}deleteRows(s,a=1,e){const i=this,l=[],u=[],t=i.modifier;if(i.emit({type:"deleteRows",detail:e,rowCount:a,rowIndex:s||0}),void 0===s&&(s=0,a=i.rowCount),0<a&&s<i.rowCount){const m=i.columns,d=Object.keys(m);for(let r=0,e=d.length,t,o,n;r<e;++r){n=d[r],t=m[n];var c=Data_ColumnUtils.splice(t,s,a);o=c.removed,m[n]=t=c.array,r||(i.rowCount=t.length);for(let e=0,t=o.length;e<t;++e)l[e]=l[e]||[],l[e][r]=o[e];u.push(new Array(e))}}return t&&t.modifyRows(i,u,s||0,e),i.emit({type:"afterDeleteRows",detail:e,rowCount:a,rowIndex:s||0,rows:l}),l}emit(e){["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)&&(this.versionTag=DataTable_uniqueKey()),DataTable_fireEvent(this,e.type,e)}getCell(e,t){e=this.columns[e];if(e)return e[t]}getCellAsBoolean(e,t){e=this.columns[e];return!(!e||!e[t])}getCellAsNumber(e,t,r){e=this.columns[e];let o=e&&e[t];switch(typeof o){case"boolean":return o?1:0;case"number":return isNaN(o)&&!r?null:o}return o=parseFloat(""+(o??"")),isNaN(o)&&!r?null:o}getCellAsString(e,t){e=this.columns[e];return""+(e&&e[t])}getColumn(e,t){return this.getColumns([e],t)[e]}getColumnAsNumbers(t,e){const r=this.columns[t],o=[];if(r){var n=r.length;if(e)for(let e=0;e<n;++e)o.push(this.getCellAsNumber(t,e,!0));else{for(let e=0,t;e<n;++e){if("number"==typeof(t=r[e]))return r.slice();if(null!=t)break}for(let e=0;e<n;++e)o.push(this.getCellAsNumber(t,e))}}return o}getColumnNames(){return Object.keys(this.columns)}getColumns(n,s,a){const i=this.columns,l={};for(let e=0,t=(n=n||Object.keys(i)).length,r,o;e<t;++e)o=n[e],(r=i[o])&&(s?l[o]=r:a&&!Array.isArray(r)?l[o]=Array.from(r):l[o]=r.slice());return l}getLocalRowIndex(e){var t=this["localRowIndexes"];return t?t[e]:e}getModifier(){return this.modifier}getOriginalRowIndex(e){var t=this["originalRowIndexes"];return t?t[e]:e}getRow(e,t){return this.getRows(e,1,t)[0]}getRowCount(){return this.rowCount}getRowIndexBy(e,t,r){const o=this.columns[e];if(o){let e=-1;if(-1!==(e=Array.isArray(o)||isNumber(t)?o.indexOf(t,r):e))return e}}getRowObject(e,t){return this.getRowObjects(e,1,t)[0]}getRowObjects(s=0,a=this.rowCount-s,i){const l=this.columns,u=new Array(a);i=i||Object.keys(l);for(let e=s,t=0,r=Math.min(this.rowCount,s+a),o,n;e<r;++e,++t){n=u[t]={};for(const c of i)o=l[c],n[c]=o?o[e]:void 0}return u}getRows(s=0,a=this.rowCount-s,i){const l=this.columns,u=new Array(a);i=i||Object.keys(l);for(let e=s,t=0,r=Math.min(this.rowCount,s+a),o,n;e<r;++e,++t){n=u[t]=[];for(const c of i)o=l[c],n.push(o?o[e]:void 0)}return u}getVersionTag(){return this.versionTag}hasColumns(r){var o=this.columns;for(let e=0,t=r.length;e<t;++e)if(!o[r[e]])return!1;return!0}hasRowWith(e,t){const r=this.columns[e];return Array.isArray(r)?-1!==r.indexOf(t):!(!defined(t)||!Number.isFinite(t))&&-1!==r.indexOf(+t)}on(e,t){return DataTable_addEvent(this,e,t)}renameColumn(e,t){const r=this.columns;return!!r[e]&&(e!==t&&(r[t]=r[e],delete r[e]),!0)}setCell(e,t,r,o){const n=this,s=n.columns,a=n.modifier;let i=s[e];i&&i[t]===r||(n.emit({type:"setCell",cellValue:r,columnName:e,detail:o,rowIndex:t}),i=i||(s[e]=new Array(n.rowCount)),t>=n.rowCount&&(n.rowCount=t+1),i[t]=r,a&&a.modifyCell(n,e,t,r),n.emit({type:"afterSetCell",cellValue:r,columnName:e,detail:o,rowIndex:t}))}setColumns(a,i,e,l){const t=this,u=t.columns,r=t.modifier,c=Object.keys(a);let m=t.rowCount;if(t.emit({type:"setColumns",columns:a,columnNames:c,detail:e,rowIndex:i}),defined(i)||l){for(let e=0,t=c.length,r,o,n,s;e<t;++e){r=a[n=c[e]],o=u[n],s=Object.getPrototypeOf(o&&l?o:r).constructor,o?s===Array?Array.isArray(o)||(o=Array.from(o)):o.length<m&&(o=new s(m)).set(u[n]):o=new s(m),u[n]=o;for(let e=i||0,t=r.length;e<t;++e)o[e]=r[e];m=Math.max(m,r.length)}this.applyRowCount(m)}else super.setColumns(a,i,extend(e,{silent:!0}));r&&r.modifyColumns(t,a,i||0),t.emit({type:"afterSetColumns",columns:a,columnNames:c,detail:e,rowIndex:i})}setModifier(t,r){const o=this;let e;return o.emit({type:"setModifier",detail:r,modifier:t,modified:o.modified}),(o.modified=o).modifier=t,(e=t?t.modify(o):Promise.resolve(o)).then(e=>(e.emit({type:"afterSetModifier",detail:r,modifier:t,modified:e.modified}),e)).catch(e=>{throw o.emit({type:"setModifierError",error:e,modifier:t,modified:o.modified}),e})}setOriginalRowIndexes(o,e=!1){if(this.originalRowIndexes=o,!e){const n=this.localRowIndexes=[];for(let e=0,t=o.length,r;e<t;++e)r=o[e],defined(r)&&(n[r]=e)}}setRow(e,t,r,o){this.setRows([e],t,r,o)}setRows(t,n=this.rowCount,s,e){const r=this,a=r.columns,i=Object.keys(a),o=r.modifier,l=t.length;r.emit({type:"setRows",detail:e,rowCount:l,rowIndex:n,rows:t});for(let e=0,r=n,o;e<l;++e,++r)if((o=t[e])===DataTable.NULL)for(let e=0,t=i.length;e<t;++e){const m=a[i[e]];s?a[i[e]]=Data_ColumnUtils.splice(m,r,0,!0,[null]).array:m[r]=null}else if(o instanceof Array)for(let e=0,t=i.length;e<t;++e)a[i[e]][r]=o[e];else super.setRow(o,r,void 0,{silent:!0});var u=s?l+t.length:n+l;if(u>r.rowCount){r.rowCount=u;for(let e=0,t=i.length;e<t;++e){var c=i[e];a[c]=Data_ColumnUtils.setLength(a[c],u)}}o&&o.modifyRows(r,t,n),r.emit({type:"afterSetRows",detail:e,rowCount:l,rowIndex:n,rows:t})}}DataTable.NULL={},DataTable.version="1.0.0";const Data_DataTable=DataTable,{addEvent:DataConnector_addEvent,fireEvent:DataConnector_fireEvent,merge:DataConnector_merge,pick}=external_highcharts_src_js_default_default();class DataConnector{constructor(e={},r=[]){this.dataTables={},this.loaded=!1,this.metadata=e.metadata||{columns:{}};let o=0;if(0<r?.length)for(let e=0,t=r.length;e<t;++e){var n=r[e],s=n?.key;this.dataTables[s??o]=new Data_DataTable(n),s||o++}else this.dataTables[0]=new Data_DataTable(e.dataTable)}get polling(){return!!this._polling}get table(){return this.getTable()}describeColumn(e,t){const r=this.metadata.columns;r[e]=DataConnector_merge(r[e]||{},t)}describeColumns(e){const t=Object.keys(e);for(var r;"string"==typeof(r=t.pop());)this.describeColumn(r,e[r])}emit(e){DataConnector_fireEvent(this,e.type,e)}getColumnOrder(e){const r=this.metadata.columns,t=Object.keys(r||{});if(t.length)return t.sort((e,t)=>pick(r[e].index,0)-pick(r[t].index,0))}getTable(e){return e?this.dataTables[e]:Object.values(this.dataTables)[0]}getSortedColumns(e){return this.table.getColumns(this.getColumnOrder(e))}load(){return DataConnector_fireEvent(this,"afterLoad",{table:this.table}),Promise.resolve(this)}on(e,t){return DataConnector_addEvent(this,e,t)}save(){return DataConnector_fireEvent(this,"saveError",{table:this.table}),Promise.reject(new Error("Not implemented"))}setColumnOrder(r){for(let e=0,t=r.length;e<t;++e)this.describeColumn(r[e],{index:e})}async setModifierOptions(e,t){for(const[o,n]of Object.entries(this.dataTables)){var r=t?.find(e=>e.key===o),r=DataConnector_merge(r?.dataModifier,e);const s=r&&Modifiers_DataModifier.types[r.type];await n.setModifier(s?new s(r):void 0)}return this}startPolling(e=1e3){const t=this,r=t.dataTables;this.pollingController=new AbortController,window.clearTimeout(t._polling),t._polling=window.setTimeout(()=>t.load().catch(e=>t.emit({type:"loadError",error:e,tables:r})).then(()=>{t._polling&&t.startPolling(e)}),e)}stopPolling(){this.polling&&(this?.pollingController?.abort(),window.clearTimeout(this._polling),delete this._polling)}whatIs(e){return this.metadata.columns[e]}initConverters(e,t,r){let o=0;for(var[n,s]of Object.entries(this.dataTables)){const a=t(n,s);r(a,e),s.deleteColumns(),s.setColumns(a.getTable().getColumns()),0===o&&(this.converter=a),o++}}}!function(r){r.types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)}}(DataConnector=DataConnector||{});const Connectors_DataConnector=DataConnector,{addEvent:DataConverter_addEvent,fireEvent:DataConverter_fireEvent,isNumber:DataConverter_isNumber,merge:DataConverter_merge}=external_highcharts_src_js_default_default();class DataConverter{constructor(e){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(e){return e?Date.UTC(+e[1],e[3]-1,+e[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[3]-1,+e[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(e){return e?Date.UTC(+e[4],e[1]-1,+e[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){const t=new Date;if(!e)return NaN;let r=+e[4];return r>t.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,e[3]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(e){return e?Date.UTC(+e[4]+2e3,e[1]-1,+e[3]):NaN}}};e=DataConverter_merge(DataConverter.defaultOptions,e);let t=e.decimalPoint;"."!==t&&","!==t||(t="."===t?"\\.":",",this.decimalRegExp=new RegExp("^(-?[0-9]+)"+t+"([0-9]+)$")),this.options=e}asBoolean(e){return"boolean"==typeof e?e:"string"==typeof e?""!==e&&"0"!==e&&"false"!==e:!!this.asNumber(e)}asDate(e){let t;if("string"==typeof e)t=this.parseDate(e);else if("number"==typeof e)t=e;else{if(e instanceof Date)return e;t=this.parseDate(this.asString(e))}return new Date(t)}asGuessedType(e){const t=this,r={number:t.asNumber,Date:t.asDate,string:t.asString};return r[t.guessType(e)].call(t,e)}asNumber(e){if("number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;if("string"!=typeof e)return e instanceof Date?e.getDate():e?e.getRowCount():NaN;{const t=this.decimalRegExp;if(-1<e.indexOf(" ")&&(e=e.replace(/\s+/g,"")),t){if(!t.test(e))return NaN;e=e.replace(t,"$1.$2")}return parseFloat(e)}}asString(e){return""+e}deduceDateFormat(e,t,r){const o=[],n=[];let s="YYYY/mm/dd",a,i=[],l=0,u=!1,c,m;for((!t||t>e.length)&&(t=e.length);l<t;l++)if(void 0!==e[l]&&e[l]&&e[l].length)for(a=e[l].trim().replace(/[\-\.\/]/g," ").split(" "),i=["","",""],m=0;m<a.length;m++)m<i.length&&(c=parseInt(a[m],10))&&(n[m]=!n[m]||n[m]<c?c:n[m],void 0!==o[m]?o[m]!==c&&(o[m]=!1):o[m]=c,31<c?i[m]=c<100?"YY":"YYYY":12<c&&c<=31?(i[m]="dd",u=!0):i[m].length||(i[m]="mm"));if(u){for(m=0;m<o.length;m++)!1!==o[m]?12<n[m]&&"YY"!==i[m]&&"YYYY"!==i[m]&&(i[m]="YY"):12<n[m]&&"mm"===i[m]&&(i[m]="dd");3===i.length&&"dd"===i[1]&&"dd"===i[2]&&(i[2]="YY"),s=i.join("/")}return r&&(this.options.dateFormat=s),s}emit(e){DataConverter_fireEvent(this,e.type,e)}export(e,t){throw this.emit({type:"exportError",columns:[],headers:[]}),new Error("Not implemented")}getTable(){throw new Error("Not implemented")}guessType(t){let r="string";if("string"==typeof t){const n=this.trim(""+t),s=this.decimalRegExp;let e=this.trim(n,!0);s&&(e=s.test(e)?e.replace(s,"$1.$2"):"");var o=parseFloat(e);+e===o?t=o:(o=this.parseDate(t),r=DataConverter_isNumber(o)?"Date":"string")}return r="number"==typeof t?31536e6<t?"Date":"number":r}on(e,t){return DataConverter_addEvent(this,e,t)}parse(e){throw this.emit({type:"parseError",columns:[],headers:[]}),new Error("Not implemented")}parseDate(e,t){const r=this,o=r.options;let n=t||o.dateFormat,s=NaN,a,i,l;if(o.parseDate)s=o.parseDate(e);else{if(n)i=(i=r.dateFormats[n])||r.dateFormats["YYYY/mm/dd"],(l=e.match(i.regex))&&(s=i.parser(l));else for(a in r.dateFormats)if(i=r.dateFormats[a],l=e.match(i.regex)){n=a,s=i.parser(l);break}l||("object"==typeof(l=Date.parse(e))&&null!==l&&l.getTime?s=l.getTime()-6e4*l.getTimezoneOffset():DataConverter_isNumber(l)&&(s=l-6e4*new Date(l).getTimezoneOffset(),-1===e.indexOf("2001")&&2001===new Date(s).getFullYear()&&(s=NaN)))}return s}trim(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[\d\s]+$/.test(e)&&(e=e.replace(/\s/g,""))),e}}DataConverter.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},function(r){r.types={},r.registerType=function(e,t){return!!e&&!r.types[e]&&!!(r.types[e]=t)},r.getTableFromColumns=function(r=[],o=[]){const n=new Data_DataTable;for(let e=0,t=Math.max(o.length,r.length);e<t;++e)n.setColumn(o[e]||""+e,r[e]);return n}}(DataConverter=DataConverter||{});const Converters_DataConverter=DataConverter;class DataCursor{constructor(e={}){this.emittingRegister=[],this.listenerMap={},this.stateMap=e}addListener(e,t,r){const o=this.listenerMap[e]=this.listenerMap[e]||{},n=o[t]=o[t]||[];return n.push(r),this}buildEmittingTag(e){return("position"===e.cursor.type?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")}emitCursor(e,t,r,o){const n=e.id,s=t.state,a=this.listenerMap[n]&&this.listenerMap[n][s];if(a){const i=this.stateMap[n]=this.stateMap[n]??{},l=i[t.state]||[],u=(o&&(l.length||(i[t.state]=l),-1===DataCursor.getIndex(t,l)&&l.push(t)),{cursor:t,cursors:l,table:e}),c=(r&&(u.event=r),this.emittingRegister),m=this.buildEmittingTag(u);if(0<=c.indexOf(m))return this;try{this.emittingRegister.push(m);for(let e=0,t=a.length;e<t;++e)a[e].call(this,u)}finally{o=this.emittingRegister.indexOf(m);0<=o&&this.emittingRegister.splice(o,1)}}return this}remitCursor(e,t){const r=this.stateMap[e]&&this.stateMap[e][t.state];return r&&0<=(e=DataCursor.getIndex(t,r))&&r.splice(e,1),this}removeListener(e,t,r){const o=this.listenerMap[e]&&this.listenerMap[e][t];return o&&0<=(e=o.indexOf(r))&&o.splice(e,1),this}}DataCursor.version="1.0.0",function(e){function n(e,t){if("range"===e.type)return e;const r={type:"range",firstRow:e.row??(t&&t.firstRow)??0,lastRow:e.row??(t&&t.lastRow)??Number.MAX_VALUE,state:e.state};return void 0!==e.column&&(r.columns=[e.column]),r}e.getIndex=function(o,n){if("position"===o.type){for(let e,t=0,r=n.length;t<r;++t)if("position"===(e=n[t]).type&&e.state===o.state&&e.column===o.column&&e.row===o.row)return t}else{var s=JSON.stringify(o.columns);for(let e,t=0,r=n.length;t<r;++t)if("range"===(e=n[t]).type&&e.state===o.state&&e.firstRow===o.firstRow&&e.lastRow===o.lastRow&&JSON.stringify(e.columns)===s)return t}return-1},e.isEqual=function(e,t){return"position"===e.type&&"position"===t.type?e.column===t.column&&e.row===t.row&&e.state===t.state:"range"===e.type&&"range"===t.type&&(e.firstRow===t.firstRow&&e.lastRow===t.lastRow&&JSON.stringify(e.columns)===JSON.stringify(t.columns))},e.isInRange=function(e,t){"position"===t.type&&(t=n(t));const r=(e="position"===e.type?n(e,t):e).columns,o=t.columns;return e.firstRow>=t.firstRow&&e.lastRow<=t.lastRow&&(!r||!o||r.every(e=>0<=o.indexOf(e)))},e.toPositions=function(t){if("position"===t.type)return[t];var o=t.columns||[];const n=[];var s=t.state;for(let r=t.firstRow,e=t.lastRow;r<e;++r)if(o.length)for(let e=0,t=o.length;e<t;++e)n.push({type:"position",column:o[e],row:r,state:s});else n.push({type:"position",row:r,state:s});return n},e.toRange=n}(DataCursor=DataCursor||{});const Data_DataCursor=DataCursor,DataPoolDefaults={connectors:[]},Data_DataPoolDefaults=DataPoolDefaults;class DataPool{constructor(e=Data_DataPoolDefaults){e.connectors=e.connectors||[],this.connectors={},this.options=e,this.waiting={}}emit(e){external_highcharts_src_js_default_default().fireEvent(this,e.type,e)}getConnector(e){var t=this.connectors[e];if(t?.loaded)return Promise.resolve(t);let o=this.waiting[e];if(!o){o=this.waiting[e]=[];t=this.getConnectorOptions(e);if(!t)throw new Error(`Connector '${e}' not found.`);this.loadConnector(t).then(r=>{delete this.waiting[e];for(let e=0,t=o.length;e<t;++e)o[e][0](r)}).catch(r=>{delete this.waiting[e];for(let e=0,t=o.length;e<t;++e)o[e][1](r)})}return new Promise((e,t)=>{o.push([e,t])})}getConnectorIds(){const r=this.options.connectors,o=[];for(let e=0,t=r.length;e<t;++e)o.push(r[e].id);return o}getConnectorOptions(r){var o=this.options.connectors;for(let e=0,t=o.length;e<t;++e)if(o[e].id===r)return o[e]}getConnectorTable(e){return this.getConnector(e).then(e=>e.table)}isNewConnector(e){return!this.connectors[e]}loadConnector(n){return new Promise((r,e)=>{this.emit({type:"load",options:n});const t=Connectors_DataConnector.types[n.type];if(!t)throw new Error(`Connector type not found. (${n.type})`);const o=this.connectors[n.id]=new t(n.options,n.dataTables);o.load().then(({converter:e,dataTables:t})=>{o.dataTables=t,o.converter=e,o.loaded=!0,this.emit({type:"afterLoad",options:n}),r(o)}).catch(e)})}cancelPendingRequests(){const e=this["connectors"];for(const t of Object.keys(e))e[t].stopPolling()}on(e,t){return external_highcharts_src_js_default_default().addEvent(this,e,t)}setConnectorOptions(r){const o=this.options.connectors,e=this.connectors;this.emit({type:"setConnectorOptions",options:r});for(let e=0,t=o.length;e<t;++e)if(o[e].id===r.id){o.splice(e,1);break}e[r.id]&&(e[r.id].stopPolling(),delete e[r.id]),o.push(r),this.emit({type:"afterSetConnectorOptions",options:r})}}DataPool.version="1.0.0";const Data_DataPool=DataPool,booleanRegExp=/^(?:FALSE|TRUE)/,decimal1RegExp=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/,decimal2RegExp=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/,functionRegExp=/^([A-Z][A-Z\d\.]*)\(/,operatorRegExp=/^(?:[+\-*\/^<=>]|<=|=>)/,rangeA1RegExp=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,rangeR1C1RegExp=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,referenceA1RegExp=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,referenceR1C1RegExp=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function extractParantheses(n){let s=0;for(let e=0,t=n.length,r,o=1;e<t;++e)if("("===(r=n[e]))s||(o=e+1),++s;else if(")"===r&&!--s)return n.substring(o,e);if(0<s){const e=new Error("Incomplete parantheses.");throw e.name="FormulaParseError",e}return""}function extractString(n){let s=-1;for(let e=0,t=n.length,r,o=!1;e<t;++e)if("\\"===(r=n[e]))o=!o;else if(o)o=!1;else if('"'===r){if(!(s<0))return n.substring(s+1,e);s=e}const e=new Error("Incomplete string.");throw e.name="FormulaParseError",e}function parseArgument(e,t){let r;if(r=e.match(rangeR1C1RegExp)){var o=""===r[2]||"["===r[2][0],n=""===r[1]||"["===r[1][0],s=""===r[4]||"["===r[4][0],a=""===r[3]||"["===r[3][0];const i={type:"range",beginColumn:o?parseInt(r[2].substring(1,-1)||"0",10):parseInt(r[2],10)-1,beginRow:n?parseInt(r[1].substring(1,-1)||"0",10):parseInt(r[1],10)-1,endColumn:s?parseInt(r[4].substring(1,-1)||"0",10):parseInt(r[4],10)-1,endRow:a?parseInt(r[3].substring(1,-1)||"0",10):parseInt(r[3],10)-1};return o&&(i.beginColumnRelative=!0),n&&(i.beginRowRelative=!0),s&&(i.endColumnRelative=!0),a&&(i.endRowRelative=!0),i}if(r=e.match(rangeA1RegExp)){o="$"!==r[1][0],n="$"!==r[2][0],s="$"!==r[3][0],a="$"!==r[4][0];const l={type:"range",beginColumn:parseReferenceColumn(o?r[1]:r[1].substring(1))-1,beginRow:parseInt(n?r[2]:r[2].substring(1),10)-1,endColumn:parseReferenceColumn(s?r[3]:r[3].substring(1))-1,endRow:parseInt(a?r[4]:r[4].substring(1),10)-1};return o&&(l.beginColumnRelative=!0),n&&(l.beginRowRelative=!0),s&&(l.endColumnRelative=!0),a&&(l.endRowRelative=!0),l}o=parseFormula(e,t);return 1===o.length&&"string"!=typeof o[0]?o[0]:o}function parseArguments(o,n){const s=[],a=n?";":",";let i=0,l="";for(let e=0,t=o.length,r;e<t;++e){var u;(r=o[e])===a&&!i&&l?(s.push(parseArgument(l,n)),l=""):'"'!==r||i||l?" "!==r&&(l+=r,"("===r?++i:")"===r&&--i):(u=extractString(o.substring(e)),s.push(u),e+=u.length+1)}return!i&&l&&s.push(parseArgument(l,n)),s}function parseFormula(e,t){const r=t?decimal2RegExp:decimal1RegExp,o=[];let n,s=("="===e[0]?e.substring(1):e).trim();for(;s;)if(n=s.match(referenceR1C1RegExp)){var a=""===n[2]||"["===n[2][0],i=""===n[1]||"["===n[1][0];const u={type:"reference",column:a?parseInt(n[2].substring(1,-1)||"0",10):parseInt(n[2],10)-1,row:i?parseInt(n[1].substring(1,-1)||"0",10):parseInt(n[1],10)-1};a&&(u.columnRelative=!0),i&&(u.rowRelative=!0),o.push(u),s=s.substring(n[0].length).trim()}else if(n=s.match(referenceA1RegExp)){a="$"!==n[1][0],i="$"!==n[2][0];const c={type:"reference",column:parseReferenceColumn(a?n[1]:n[1].substring(1))-1,row:parseInt(i?n[2]:n[2].substring(1),10)-1};a&&(c.columnRelative=!0),i&&(c.rowRelative=!0),o.push(c),s=s.substring(n[0].length).trim()}else if(n=s.match(operatorRegExp))o.push(n[0]),s=s.substring(n[0].length).trim();else if(n=s.match(booleanRegExp))o.push("TRUE"===n[0]),s=s.substring(n[0].length).trim();else if(n=s.match(r))o.push(parseFloat(n[0])),s=s.substring(n[0].length).trim();else if('"'===s[0]){const m=extractString(s);o.push(m.substring(1,-1)),s=s.substring(m.length+2).trim()}else{if(!(n=s.match(functionRegExp))){if("("===s[0]){var l=extractParantheses(s);if(l){o.push(parseFormula(l,t)),s=s.substring(l.length+2).trim();continue}}const d=e.length-s.length,f=new Error("Unexpected character `"+e.substring(d,1+d)+"` at position "+(1+d)+". (`..."+e.substring(d-5,6+d)+"...`)");throw f.name="FormulaParseError",f}l=extractParantheses(s=s.substring(n[1].length).trim());o.push({type:"function",name:n[1],args:parseArguments(l,t)}),s=s.substring(l.length+2).trim()}return o}function parseReferenceColumn(n){let s=0;for(let e=0,t=n.length,r,o=n.length-1;e<t;++e)65<=(r=n.charCodeAt(e))&&r<=90&&(s+=(r-64)*Math.pow(26,o)),--o;return s}const FormulaParser={parseFormula:parseFormula},Formula_FormulaParser=FormulaParser,operators=["+","-","*","/","^","=","<","<=",">",">="];function isFormula(e){return e instanceof Array}function isFunction(e){return"object"==typeof e&&!(e instanceof Array)&&"function"===e.type}function isOperator(e){return"string"==typeof e&&0<=operators.indexOf(e)}function isRange(e){return"object"==typeof e&&!(e instanceof Array)&&"range"===e.type}function isReference(e){return"object"==typeof e&&!(e instanceof Array)&&"reference"===e.type}function isValue(e){return"boolean"==typeof e||"number"==typeof e||"string"==typeof e}const MathFormula={isFormula:isFormula,isFunction:isFunction,isOperator:isOperator,isRange:isRange,isReference:isReference,isValue:isValue},FormulaTypes=MathFormula,{isFormula:FormulaProcessor_isFormula,isFunction:FormulaProcessor_isFunction,isOperator:FormulaProcessor_isOperator,isRange:FormulaProcessor_isRange,isReference:FormulaProcessor_isReference,isValue:FormulaProcessor_isValue}=FormulaTypes,asLogicalStringRegExp=/ */,MAX_FALSE=Number.MAX_VALUE/1.000000000001,MAX_STRING=Number.MAX_VALUE/1.000000000002,MAX_TRUE=Number.MAX_VALUE,operatorPriority={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},processorFunctions={},processorFunctionNameRegExp=/^[A-Z][A-Z\.]*$/;function asLogicalNumber(e){switch(typeof e){case"boolean":return e?MAX_TRUE:MAX_FALSE;case"string":return MAX_STRING;case"number":return e;default:return NaN}}function asLogicalString(e){return"string"==typeof e?e.toLowerCase().replace(asLogicalStringRegExp,"\0"):e}function asNumber(e){switch(typeof e){case"boolean":return e?1:0;case"string":return parseFloat(e.replace(",","."));case"number":return e;default:return NaN}}function basicOperation(e,t,r){switch(e){case"=":return asLogicalString(t)===asLogicalString(r);case"<":return typeof t==typeof r?asLogicalString(t)<asLogicalString(r):asLogicalNumber(t)<asLogicalNumber(r);case"<=":return typeof t==typeof r?asLogicalString(t)<=asLogicalString(r):asLogicalNumber(t)<=asLogicalNumber(r);case">":return typeof t==typeof r?asLogicalString(t)>asLogicalString(r):asLogicalNumber(t)>asLogicalNumber(r);case">=":return typeof t==typeof r?asLogicalString(t)>=asLogicalString(r):asLogicalNumber(t)>=asLogicalNumber(r)}t=asNumber(t),r=asNumber(r);let o;switch(e){case"+":o=t+r;break;case"-":o=t-r;break;case"*":o=t*r;break;case"/":o=t/r;break;case"^":o=Math.pow(t,r);break;default:return NaN}return o%1?Math.round(1e9*o)/1e9:o}function getArgumentValue(e,t){return FormulaProcessor_isValue(e)?e:FormulaProcessor_isRange(e)?t&&getRangeValues(e,t)||[]:FormulaProcessor_isFunction(e)?processFunction(e,t):processFormula(FormulaProcessor_isFormula(e)?e:[e],t)}function getArgumentsValues(r,o){const n=[];for(let e=0,t=r.length;e<t;++e)n.push(getArgumentValue(r[e],o));return n}function getRangeValues(n,s){const a=s.getColumnNames().slice(n.beginColumn,n.endColumn+1),i=[];for(let r=0,e=a.length,o;r<e;++r){var l=s.getColumn(a[r],!0)||[];for(let e=n.beginRow,t=n.endRow+1;e<t;++e)"string"==typeof(o=l[e])&&"="===o[0]&&s!==s.modified&&(o=s.modified.getCell(a[r],e)),i.push(FormulaProcessor_isValue(o)?o:NaN)}return i}function getReferenceValue(e,t){var r,o=t.getColumnNames()[e.column];return o?"string"==typeof(r=t.getCell(o,e.row))&&"="===r[0]&&t!==t.modified?(t=t.modified.getCell(o,e.row),FormulaProcessor_isValue(t)?t:NaN):FormulaProcessor_isValue(r)?r:NaN:NaN}function processFormula(a,i){let l;for(let e=0,t=a.length,r,o,n,s;e<t;++e)if(r=a[e],FormulaProcessor_isOperator(r))o=r;else if(FormulaProcessor_isValue(r)?s=r:FormulaProcessor_isFormula(r)?s=processFormula(a,i):FormulaProcessor_isFunction(r)?(n=processFunction(r,i),s=FormulaProcessor_isValue(n)?n:NaN):FormulaProcessor_isReference(r)&&(s=i&&getReferenceValue(r,i)),void 0!==s){if(void 0===l)l=o?basicOperation(o,0,s):s;else{if(!o)return NaN;var u=a[e+1];FormulaProcessor_isOperator(u)&&operatorPriority[u]>operatorPriority[o]&&(s=basicOperation(u,s,processFormula(a.slice(e+2))),e=t),l=basicOperation(o,l,s)}o=void 0,s=void 0}return FormulaProcessor_isValue(l)?l:NaN}function processFunction(e,t,r){const o=processorFunctions[e.name];if(o)try{return o(e.args,t)}catch{return NaN}const n=new Error(`Function "${e.name}" not found.`);throw n.name="FormulaProcessError",n}function registerProcessorFunction(e,t){return processorFunctionNameRegExp.test(e)&&!processorFunctions[e]&&!!(processorFunctions[e]=t)}function translateReferences(o,n=0,s=0){for(let e=0,t=o.length,r;e<t;++e)(r=o[e])instanceof Array?translateReferences(r,n,s):FormulaProcessor_isFunction(r)?translateReferences(r.args,n,s):FormulaProcessor_isRange(r)?(r.beginColumnRelative&&(r.beginColumn+=n),r.beginRowRelative&&(r.beginRow+=s),r.endColumnRelative&&(r.endColumn+=n),r.endRowRelative&&(r.endRow+=s)):FormulaProcessor_isReference(r)&&(r.columnRelative&&(r.column+=n),r.rowRelative&&(r.row+=s));return o}const FormulaProcessor={asNumber:asNumber,getArgumentValue:getArgumentValue,getArgumentsValues:getArgumentsValues,getRangeValues:getRangeValues,getReferenceValue:getReferenceValue,processFormula:processFormula,processorFunctions:processorFunctions,registerProcessorFunction:registerProcessorFunction,translateReferences:translateReferences},Formula_FormulaProcessor=FormulaProcessor,ABS_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function ABS(e,t){var o=ABS_getArgumentValue(e[0],t);switch(typeof o){case"number":return Math.abs(o);case"object":{const n=[];for(let e=0,t=o.length,r;e<t;++e){if("number"!=typeof(r=o[e]))return NaN;n.push(Math.abs(r))}return n}default:return NaN}}Formula_FormulaProcessor.registerProcessorFunction("ABS",ABS);const Functions_ABS=null,AND_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function AND(o,n){for(let e=0,t=o.length,r;e<t;++e)if(!(r=AND_getArgumentValue(o[e],n))||"object"==typeof r&&!AND(r,n))return!1;return!0}Formula_FormulaProcessor.registerProcessorFunction("AND",AND);const Functions_AND=null,AVERAGE_getArgumentsValues=Formula_FormulaProcessor["getArgumentsValues"];function AVERAGE(e,t){var r=AVERAGE_getArgumentsValues(e,t);let n=0,s=0;for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"number":isNaN(o)||(++n,s+=o);break;case"object":for(let e=0,t=o.length,r;e<t;++e)"number"!=typeof(r=o[e])||isNaN(r)||(++n,s+=r)}return n?s/n:0}Formula_FormulaProcessor.registerProcessorFunction("AVERAGE",AVERAGE);const Functions_AVERAGE=null,AVERAGEA_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function AVERAGEA(r,n){let s=0,a=0;for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=AVERAGEA_getArgumentValue(r[e],n))){case"boolean":++s,a+=o?1:0;continue;case"number":isNaN(o)||(++s,a+=o);continue;case"string":++s;continue;default:for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"boolean":++s,a+=r?1:0;continue;case"number":isNaN(r)||(++s,a+=r);continue;case"string":++s;continue}continue}return s?a/s:0}Formula_FormulaProcessor.registerProcessorFunction("AVERAGEA",AVERAGEA);const Functions_AVERAGEA=null;function COUNT(e,o){var n=Formula_FormulaProcessor.getArgumentsValues(e,o);let s=0;for(let e=0,t=n.length,r;e<t;++e)switch(typeof(r=n[e])){case"number":isNaN(r)||++s;break;case"object":s+=COUNT(r,o)}return s}Formula_FormulaProcessor.registerProcessorFunction("COUNT",COUNT);const Functions_COUNT=null;function COUNTA(e,o){var n=Formula_FormulaProcessor.getArgumentsValues(e,o);let s=0;for(let e=0,t=n.length,r;e<t;++e){switch(typeof(r=n[e])){case"number":if(isNaN(r))continue;break;case"object":s+=COUNTA(r,o);continue;case"string":if(r)break;continue}++s}return s}Formula_FormulaProcessor.registerProcessorFunction("COUNTA",COUNTA);const Functions_COUNTA=null,IF_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function IF(e,t){return IF_getArgumentValue(e[0],t)?IF_getArgumentValue(e[1],t):IF_getArgumentValue(e[2],t)}Formula_FormulaProcessor.registerProcessorFunction("IF",IF);const Functions_IF=null,ISNA_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function ISNA(e,t){e=ISNA_getArgumentValue(e[0],t);return"number"!=typeof e||isNaN(e)}Formula_FormulaProcessor.registerProcessorFunction("ISNA",ISNA);const Functions_ISNA=null,MAX_getArgumentsValues=Formula_FormulaProcessor["getArgumentsValues"];function MAX(e,t){var o=MAX_getArgumentsValues(e,t);let n=Number.NEGATIVE_INFINITY;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":r>n&&(n=r);break;case"object":(r=MAX(r))>n&&(n=r)}return isFinite(n)?n:0}Formula_FormulaProcessor.registerProcessorFunction("MAX",MAX);const Functions_MAX=null;function MEDIAN(e,t){const n=[],r=Formula_FormulaProcessor.getArgumentsValues(e,t);for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"number":isNaN(o)||n.push(o);break;case"object":for(let e=0,t=o.length,r;e<t;++e)"number"!=typeof(r=o[e])||isNaN(r)||n.push(r)}e=n.length;if(!e)return NaN;t=Math.floor(e/2);return e%2?n[t]:(n[t-1]+n[t])/2}Formula_FormulaProcessor.registerProcessorFunction("MEDIAN",MEDIAN);const Functions_MEDIAN=null,MIN_getArgumentsValues=Formula_FormulaProcessor["getArgumentsValues"];function MIN(e,t){var o=MIN_getArgumentsValues(e,t);let n=Number.POSITIVE_INFINITY;for(let e=0,t=o.length,r;e<t;++e)switch(typeof(r=o[e])){case"number":r<n&&(n=r);break;case"object":(r=MIN(r))<n&&(n=r)}return isFinite(n)?n:0}Formula_FormulaProcessor.registerProcessorFunction("MIN",MIN);const Functions_MIN=null,MOD_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function MOD(e,t){let r=MOD_getArgumentValue(e[0],t),o=MOD_getArgumentValue(e[1],t);return"object"==typeof r&&(r=r[0]),"object"==typeof o&&(o=o[0]),"number"!=typeof r||"number"!=typeof o||0===o?NaN:r%o}Formula_FormulaProcessor.registerProcessorFunction("MOD",MOD);const Functions_MOD=null;function getModeMap(e,t){const n={},r=Formula_FormulaProcessor.getArgumentsValues(e,t);for(let e=0,t=r.length,o;e<t;++e)switch(typeof(o=r[e])){case"number":isNaN(o)||(n[o]=(n[o]||0)+1);break;case"object":for(let e=0,t=o.length,r;e<t;++e)"number"!=typeof(r=o[e])||isNaN(r)||(n[r]=(n[r]||0)+1)}return n}function MULT(e,t){var n=getModeMap(e,t),s=Object.keys(n);if(!s.length)return NaN;let a=[parseFloat(s[0])],i=n[s[0]];for(let e=1,t=s.length,r,o;e<t;++e)o=n[r=s[e]],i<o?(a=[parseFloat(r)],i=o):i===o&&a.push(parseFloat(r));return 1<i?a:NaN}function SNGL(e,t){var s=getModeMap(e,t),a=Object.keys(s);if(!a.length)return NaN;let i=parseFloat(a[0]),l=s[a[0]];for(let e=1,t=a.length,r,o,n;e<t;++e)n=s[r=a[e]],l<n?(i=parseFloat(r),l=n):l===n&&(o=parseFloat(r),i>o&&(i=o,l=n));return 1<l?i:NaN}Formula_FormulaProcessor.registerProcessorFunction("MODE",SNGL),Formula_FormulaProcessor.registerProcessorFunction("MODE.MULT",MULT),Formula_FormulaProcessor.registerProcessorFunction("MODE.SNGL",SNGL);const MODE={MULT:MULT,SNGL:SNGL},Functions_MODE=null,NOT_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function NOT(e,t){let r=NOT_getArgumentValue(e[0],t);switch(typeof(r="object"==typeof r?r[0]:r)){case"boolean":case"number":return!r}return NaN}Formula_FormulaProcessor.registerProcessorFunction("NOT",NOT);const Functions_NOT=null,OR_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function OR(o,n){for(let e=0,t=o.length,r;e<t;++e)if("object"==typeof(r=OR_getArgumentValue(o[e],n))){if(OR(r,n))return!0}else if(r)return!0;return!1}Formula_FormulaProcessor.registerProcessorFunction("OR",OR);const Functions_OR=null,PRODUCT_getArgumentsValues=Formula_FormulaProcessor["getArgumentsValues"];function PRODUCT(e,o){var n=PRODUCT_getArgumentsValues(e,o);let s=1,a=!1;for(let e=0,t=n.length,r;e<t;++e)switch(typeof(r=n[e])){case"number":isNaN(r)||(a=!0,s*=r);break;case"object":a=!0,s*=PRODUCT(r,o)}return a?s:0}Formula_FormulaProcessor.registerProcessorFunction("PRODUCT",PRODUCT);const Functions_PRODUCT=null;function SUM(e,o){var n=Formula_FormulaProcessor.getArgumentsValues(e,o);let s=0;for(let e=0,t=n.length,r;e<t;++e)switch(typeof(r=n[e])){case"number":isNaN(r)||(s+=r);break;case"object":s+=SUM(r,o)}return s}Formula_FormulaProcessor.registerProcessorFunction("SUM",SUM);const Functions_SUM=null,XOR_getArgumentValue=Formula_FormulaProcessor["getArgumentValue"];function XOR(r,s){for(let e=0,t=r.length,o,n;e<t;++e)switch(typeof(n=XOR_getArgumentValue(r[e],s))){case"boolean":case"number":if(void 0===o)o=!!n;else if(!!n!==o)return!0;break;case"object":for(let e=0,t=n.length,r;e<t;++e)switch(typeof(r=n[e])){case"boolean":case"number":if(void 0===o)o=!!r;else if(!!r!==o)return!0}}return!1}Formula_FormulaProcessor.registerProcessorFunction("XOR",XOR);const Functions_XOR=null,Formula={...Formula_FormulaParser,...Formula_FormulaProcessor,...FormulaTypes},Formula_Formula=Formula,CSVConverter_merge=external_highcharts_src_js_default_default()["merge"];class CSVConverter extends Converters_DataConverter{constructor(e){e=CSVConverter_merge(CSVConverter.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.dataTypes=[],this.options=e}export(e,t=this.options){var{useLocalDecimalPoint:r,lineDelimiter:o}=t,n=!1!==this.options.firstRowAsNames;let{decimalPoint:s,itemDelimiter:a}=t;s=s||(","!==a&&r?1.1.toLocaleString()[1]:"."),a=a||(","===s?";":",");const i=e.getSortedColumns(t.usePresentationOrder),l=Object.keys(i),u=[],c=l.length,m=[];n&&u.push(l.map(e=>`"${e}"`).join(a));for(let o=0;o<c;o++){var d=l[o],f=i[d],g=f.length,d=e.whatIs(d);let r;d&&(r=d.dataType);for(let t=0;t<g;t++){let e=f[t];if(m[t]||(m[t]=[]),"string"===r?e='"'+e+'"':"number"==typeof e?e=String(e).replace(".",s):"string"==typeof e&&(e=`"${e}"`),m[t][o]=e,o===c-1){let e=o;for(;2<m[t].length;){if(void 0!==m[t][e])break;m[t].pop(),e--}u.push(m[t].join(a))}}}return u.join(o)}parse(e,t){const o=this,r=o.dataTypes,n=CSVConverter_merge(this.options,e),{beforeParse:s,lineDelimiter:a,firstRowAsNames:i,itemDelimiter:l}=n;let u,c=0,{csv:m,startRow:d,endRow:f}=n,g;if(o.columns=[],o.emit({type:"parse",columns:o.columns,detail:t,headers:o.headers}),m=m&&s?s(m):m){if(u=m.replace(/\r\n|\r/g,"\n").split(a||"\n"),(!d||d<0)&&(d=0),(!f||f>=u.length)&&(f=u.length-1),l||(o.guessedItemDelimiter=o.guessDelimiter(u)),i){const h=u[0].split(l||o.guessedItemDelimiter||",");for(let e=0;e<h.length;e++)h[e]=h[e].trim().replace(/^["']|["']$/g,"");o.headers=h,d++}let e=0;for(c=d;c<=f;c++)"#"===u[c][0]?e++:o.parseCSVRow(u[c],c-d-e);r.length&&r[0].length&&"date"===r[0][1]&&!o.options.dateFormat&&o.deduceDateFormat(o.columns[0],null,!0);for(let r=0,e=o.columns.length;r<e;++r)for(let t=0,e=(g=o.columns[r]).length;t<e;++t)if(g[t]&&"string"==typeof g[t]){let e=o.asGuessedType(g[t]);e instanceof Date&&(e=e.getTime()),o.columns[r][t]=e}}o.emit({type:"afterParse",columns:o.columns,detail:t,headers:o.headers})}parseCSVRow(t,r){const o=this,n=o.columns||[],s=o.dataTypes,{startColumn:a,endColumn:i}=o.options,e=o.options.itemDelimiter||o.guessedItemDelimiter;let l=o.options["decimalPoint"],u=(l&&l!==e||(l=o.guessedDecimalPoint||"."),0),c="",m="",d=0,f=0;var g=e=>{c=t[e]};const h=e=>{s.length<f+1&&s.push([e]),s[f][s[f].length-1]!==e&&s[f].push(e)};var p=()=>{if(a>d||d>i)return++d,void(m="");var e;"string"==typeof m?!isNaN(parseFloat(m))&&isFinite(m)?(m=parseFloat(m),h("number")):isNaN(Date.parse(m))?h("string"):(m=m.replace(/\//g,"-"),h("date")):h("number"),n.length<f+1&&n.push([]),"number"!=typeof m&&"number"!==o.guessType(m)&&l&&(m=(e=m).replace(l,"."),"number"!==o.guessType(m)&&(m=e)),n[f][r]=m,m="",++f,++d};if(t.trim().length&&"#"!==t.trim()[0]){for(;u<t.length;u++){if(g(u),"#"===c&&!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(t.substring(u)))return void p();if('"'===c)for(g(++u);u<t.length&&'"'!==c;)m+=c,g(++u);else c===e?p():m+=c}p()}}guessDelimiter(a){let i=0,l=0,e;const u={",":0,";":0,"\t":0},t=a.length;for(let e=0;e<t;e++){let t=!1,r,o,n,s="";if(13<e)break;var c=a[e];for(let e=0;e<c.length&&(r=c[e],o=c[e+1],n=c[e-1],"#"!==r);e++){if('"'===r)if(t){if('"'!==n&&'"'!==o){for(;" "===o&&e<c.length;)o=c[++e];void 0!==u[o]&&u[o]++,t=!1}}else t=!0;else void 0!==u[r]?(s=s.trim(),isNaN(Date.parse(s))&&!isNaN(Number(s))&&isFinite(Number(s))||u[r]++,s=""):s+=r;","===r&&l++,"."===r&&i++}}return e=u[";"]>u[","]?";":(u[","],u[";"],","),i>l?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e}getTable(){return Converters_DataConverter.getTableFromColumns(this.columns,this.headers)}}CSVConverter.defaultOptions={...Converters_DataConverter.defaultOptions,lineDelimiter:"\n"},Converters_DataConverter.registerType("CSV",CSVConverter);const Converters_CSVConverter=CSVConverter,{merge:CSVConnector_merge,defined:CSVConnector_defined}=external_highcharts_src_js_default_default();class CSVConnector extends Connectors_DataConnector{constructor(e,t){e=CSVConnector_merge(CSVConnector.defaultOptions,e);super(e,t),this.options=CSVConnector_defined(t)?CSVConnector_merge(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const r=this,o=r.dataTables,{csv:e,csvURL:n,dataModifier:s,dataTables:a}=r.options;return r.emit({type:"load",csv:e,detail:t,tables:o}),Promise.resolve(n?fetch(n,{signal:r?.pollingController?.signal}).then(e=>e.text()):e||"").then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=a?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new Converters_CSVConverter(CSVConnector_merge(this.options,r))},(e,t)=>{e.parse({csv:t})}),r.setModifierOptions(s,a).then(()=>e))).then(e=>(r.emit({type:"afterLoad",csv:e,detail:t,tables:o}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:o}),e})}}CSVConnector.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},Connectors_DataConnector.registerType("CSV",CSVConnector);const Connectors_CSVConnector=null,{error,isArray,merge:JSONConverter_merge,objectEach:JSONConverter_objectEach}=external_highcharts_src_js_default_default();class JSONConverter extends Converters_DataConverter{constructor(e){e=JSONConverter_merge(JSONConverter.defaultOptions,e);super(e),this.columns=[],this.headers=[],this.options=e,this.table=new Data_DataTable}parse(e,t){var o=this;const{beforeParse:r,orientation:n,firstRowAsNames:s,columnNames:a}=e=JSONConverter_merge(o.options,e);let i=e.data;if(i){if(o.columns=[],o.emit({type:"parse",columns:o.columns,detail:t,headers:o.headers}),i=(i=r?r(i):i).slice(),"columns"===n)for(let e=0,t=i.length;e<t;e++){const l=i[e];if(!(l instanceof Array))return;o.headers instanceof Array?(s?o.headers.push(""+l.shift()):a&&a instanceof Array&&o.headers.push(a[e]),o.table.setColumn(o.headers[e]||e.toString(),l)):error("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===n){s?o.headers=i.shift():a&&(o.headers=a);for(let e=0,t=i.length;e<t;e++){let r=i[e];if(isArray(r))for(let e=0,t=r.length;e<t;e++)o.columns.length<e+1&&o.columns.push([]),o.columns[e].push(r[e]),o.headers instanceof Array?this.table.setColumn(o.headers[e]||e.toString(),o.columns[e]):error("JSONConverter: Invalid `columnNames` option.",!1);else{const a=o.headers;if(a&&!(a instanceof Array)){const u={};JSONConverter_objectEach(a,(e,t)=>{u[t]=e.reduce((e,t)=>e[t],r)}),r=u}this.table.setRows([r],e)}}}o.emit({type:"afterParse",columns:o.columns,detail:t,headers:o.headers})}}getTable(){return this.table}}JSONConverter.defaultOptions={...Converters_DataConverter.defaultOptions,data:[],orientation:"rows"},Converters_DataConverter.registerType("JSON",JSONConverter);const Converters_JSONConverter=JSONConverter,{merge:JSONConnector_merge,defined:JSONConnector_defined}=external_highcharts_src_js_default_default();class JSONConnector extends Connectors_DataConnector{constructor(e,t){e=JSONConnector_merge(JSONConnector.defaultOptions,e);super(e,t),this.options=JSONConnector_defined(t)?JSONConnector_merge(e,{dataTables:t}):e,e.enablePolling&&this.startPolling(1e3*Math.max(e.dataRefreshRate||0,1))}load(t){const r=this,o=r.dataTables,{data:e,dataUrl:n,dataModifier:s,dataTables:a}=r.options;return r.emit({type:"load",data:e,detail:t,tables:o}),Promise.resolve(n?fetch(n,{signal:r?.pollingController?.signal}).then(e=>e.json()).catch(e=>{r.emit({type:"loadError",detail:t,error:e,tables:o}),console.warn(`Unable to fetch data from ${n}.`)}):e||[]).then(e=>(e&&this.initConverters(e,t=>{var e=this.options,r=a?.find(e=>e.key===t),r={dataTableKey:t,columnNames:r?.columnNames??e.columnNames,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,orientation:r?.orientation??e.orientation,beforeParse:r?.beforeParse??e.beforeParse};return new Converters_JSONConverter(JSONConnector_merge(this.options,r))},(e,t)=>{e.parse({data:t})}),r.setModifierOptions(s,a).then(()=>e))).then(e=>(r.emit({type:"afterLoad",data:e,detail:t,tables:o}),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:o}),e})}}JSONConnector.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},Connectors_DataConnector.registerType("JSON",JSONConnector);const Connectors_JSONConnector=null,{merge:GoogleSheetsConverter_merge,uniqueKey:GoogleSheetsConverter_uniqueKey}=external_highcharts_src_js_default_default();class GoogleSheetsConverter extends Converters_DataConverter{constructor(e){e=GoogleSheetsConverter_merge(GoogleSheetsConverter.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const o=this,n=GoogleSheetsConverter_merge(o.options,e);let s=(n.json?.values||[]).map(e=>e.slice());if(0===s.length)return!1;o.header=[],o.columns=[],o.emit({type:"parse",columns:o.columns,detail:t,headers:o.header});const{beforeParse:r,json:a}=n;r&&a&&(s=r(a.values));let i;for(let r=0,e=(o.columns=s).length;r<e;r++){i=s[r],o.header[r]=n.firstRowAsNames?""+i.shift():GoogleSheetsConverter_uniqueKey();for(let t=0,e=i.length;t<e;++t)if(i[t]&&"string"==typeof i[t]){let e=o.asGuessedType(i[t]);e instanceof Date&&(e=e.getTime()),o.columns[r][t]=e}}o.emit({type:"afterParse",columns:o.columns,detail:t,headers:o.header})}getTable(){return Converters_DataConverter.getTableFromColumns(this.columns,this.header)}}GoogleSheetsConverter.defaultOptions={...Converters_DataConverter.defaultOptions},Converters_DataConverter.registerType("GoogleSheets",GoogleSheetsConverter);const Converters_GoogleSheetsConverter=GoogleSheetsConverter,{merge:GoogleSheetsConnector_merge,pick:GoogleSheetsConnector_pick,defined:GoogleSheetsConnector_defined}=external_highcharts_src_js_default_default();function isGoogleError(e){return"object"==typeof e&&e&&"object"==typeof e.error&&e.error&&"number"==typeof e.error.code&&"string"==typeof e.error.message&&"string"==typeof e.error.status}class GoogleSheetsConnector extends Connectors_DataConnector{constructor(e,t){e=GoogleSheetsConnector_merge(GoogleSheetsConnector.defaultOptions,e);super(e,t),this.options=GoogleSheetsConnector_defined(t)?GoogleSheetsConnector_merge(e,{dataTables:t}):e}load(t){const r=this,o=r.dataTables,{dataModifier:n,dataRefreshRate:e,enablePolling:s,googleAPIKey:a,googleSpreadsheetKey:i,dataTables:l}=r.options,u=GoogleSheetsConnector.buildFetchURL(a,i,r.options);if(r.emit({type:"load",detail:t,tables:o,url:u}),URL.canParse(u))return fetch(u,{signal:r?.pollingController?.signal}).then(e=>e.json()).then(e=>{if(isGoogleError(e))throw new Error(e.error.message);return this.initConverters(e,t=>{var e=this.options,r=l?.find(e=>e.key===t),r={dataTableKey:t,firstRowAsNames:r?.firstRowAsNames??e.firstRowAsNames,beforeParse:r?.beforeParse??e.beforeParse};return new Converters_GoogleSheetsConverter(GoogleSheetsConnector_merge(this.options,r))},(e,t)=>{e.parse({json:t})}),r.setModifierOptions(n,l)}).then(()=>(r.emit({type:"afterLoad",detail:t,tables:o,url:u}),s&&setTimeout(()=>r.load(),1e3*Math.max(e||0,1)),r)).catch(e=>{throw r.emit({type:"loadError",detail:t,error:e,tables:o}),e});throw new Error("Invalid URL: "+u)}}GoogleSheetsConnector.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},function(e){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function a(e={}){var{endColumn:e,endRow:t,googleSpreadsheetRange:r,startColumn:o,startRow:n}=e;return r||(s[o||0]||"A")+(Math.max(n||0,0)+1)+":"+(s[GoogleSheetsConnector_pick(e,25)]||"Z")+(t?Math.max(t,0):"Z")}e.buildFetchURL=function(e,t,r={}){const o=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/`),n=(t=r.onlyColumnNames?"A1:Z1":a(r),o.pathname+=t,o.searchParams);return n.set("alt","json"),r.onlyColumnNames||(n.set("dateTimeRenderOption","FORMATTED_STRING"),n.set("majorDimension","COLUMNS"),n.set("valueRenderOption","UNFORMATTED_VALUE")),n.set("prettyPrint","false"),n.set("key",e),o.href},e.buildQueryRange=a}(GoogleSheetsConnector=GoogleSheetsConnector||{}),Connectors_DataConnector.registerType("GoogleSheets",GoogleSheetsConnector);const Connectors_GoogleSheetsConnector=null,HTMLTableConverter_merge=external_highcharts_src_js_default_default()["merge"];function isRowEqual(e,t){let r=e.length;if(t.length!==r)return!1;for(;--r;)if(e[r]!==t[r])return!1;return!0}class HTMLTableConverter extends Converters_DataConverter{constructor(e){e=HTMLTableConverter_merge(HTMLTableConverter.defaultOptions,e);super(e),this.columns=[],this.headers=[],(this.options=e).tableElement&&(this.tableElement=e.tableElement,this.tableElementID=e.tableElement.id)}export(e,t=this.options){var r=!1!==t.firstRowAsNames,o=t.useMultiLevelHeaders;const n=e.getSortedColumns(t.usePresentationOrder),s=Object.keys(n),a=[],i=s.length,l=[];let u="";if(r){const h=[];if(o){for(const p of s){let e=n[p];var c=((e=Array.isArray(e)?e:Array.from(e)).shift()||"").toString();n[p]=e,h.push(c)}u=this.getTableHeaderHTML(s,h,t)}else u=this.getTableHeaderHTML(void 0,s,t)}for(let r=0;r<i;r++){var m=s[r],d=n[m],f=d.length;for(let t=0;t<f;t++){let e=d[t];l[t]||(l[t]=[]),"string"!=typeof e&&"number"!=typeof e&&void 0!==e&&(e=(e||"").toString()),l[t][r]=this.getCellHTMLFromValue(r?"td":"th",null,r?"":'scope="row"',e),r===i-1&&a.push("<tr>"+l[t].join("")+"</tr>")}}let g="";return"<table>"+(g=t.tableCaption?'<caption class="highcharts-table-caption">'+t.tableCaption+"</caption>":g)+u+"<tbody>"+a.join("")+"</tbody></table>"}getCellHTMLFromValue(e,t,r,o,n){let s=o,a="text"+(t?" "+t:"");return"number"==typeof s?(s=s.toString(),","===n&&(s=s.replace(".",n)),a="number"):o||(s="",a="empty"),"<"+e+(r?" "+r:"")+' class="'+a+'">'+s+"</"+e+">"}getTableHeaderHTML(e=[],t=[],r=this.options){var{useMultiLevelHeaders:r,useRowspanHeaders:o}=r;let n="<thead>",s=0,a=t&&t.length,i,l=0,u;if(r&&e&&t&&!isRowEqual(e,t)){for(n+="<tr>";s<a;++s)(i=e[s])===e[s+1]?++l:l?(n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(l+1)+'"',i),l=0):(i===t[s]?o?(u=2,delete t[s]):(u=1,t[s]=""):u=1,n+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(1<u?' valign="top" rowspan="'+u+'"':""),i));n+="</tr>"}if(t){for(n+="<tr>",s=0,a=t.length;s<a;++s)void 0!==t[s]&&(n+=this.getCellHTMLFromValue("th",null,'scope="col"',t[s]));n+="</tr>"}return n+="</thead>"}parse(e,t){const s=this,a=[],i=[],l=HTMLTableConverter_merge(s.options,e),{endRow:u,startColumn:c,endColumn:m,firstRowAsNames:d}=l,f=l.tableElement||this.tableElement;if(f instanceof HTMLElement){s.tableElement=f,s.tableElementID=f.id,this.emit({type:"parse",columns:s.columns,detail:t,headers:s.headers});var g=f.getElementsByTagName("tr"),h=g.length;let r=0,o,n=l["startRow"];if(d&&h){var p=g[0].children,C=p.length;for(let e=c;e<C&&!(e>m);e++)"TD"!==(o=p[e]).tagName&&"TH"!==o.tagName||i.push(o.innerHTML);n++}for(;r<h;){if(r>=n&&r<=u){var _=g[r].children,b=_.length;let e=0;for(;e<b;){const y=e-c,w=a[y];if(("TD"===(o=_[e]).tagName||"TH"===o.tagName)&&e>=c&&e<=m){a[y]||(a[y]=[]);let e=s.asGuessedType(o.innerHTML),t=(e instanceof Date&&(e=e.getTime()),a[y][r-n]=e,1);for(;r-n>=t&&void 0===w[r-n-t];)w[r-n-t]=null,t++}e++}}r++}this.columns=a,this.headers=i,this.emit({type:"afterParse",columns:a,detail:t,headers:i})}else s.emit({type:"parseError",columns:a,detail:t,headers:i,error:"Not a valid HTML Table"})}getTable(){return Converters_DataConverter.getTableFromColumns(this.columns,this.headers)}}HTMLTableConverter.defaultOptions={...Converters_DataConverter.defaultOptions,useRowspanHeaders:!0,useMultiLevelHeaders:!0},Converters_DataConverter.registerType("HTMLTable",HTMLTableConverter);const Converters_HTMLTableConverter=HTMLTableConverter,win=external_highcharts_src_js_default_default()["win"],HTMLTableConnector_merge=external_highcharts_src_js_default_default()["merge"];class HTMLTableConnector extends Connectors_DataConnector{constructor(e){e=HTMLTableConnector_merge(HTMLTableConnector.defaultOptions,e);super(e),this.converter=new Converters_HTMLTableConverter(e),this.options=e}load(e){const t=this,r=t.converter,o=t.table,{dataModifier:n,table:s}=t.options;t.emit({type:"load",detail:e,tables:{table:o},tableElement:t.tableElement});let a;var i;return"string"==typeof s?(t.tableID=s,a=win.document.getElementById(s)):(a=s,t.tableID=a.id),t.tableElement=a||void 0,t.tableElement?(r.parse(HTMLTableConnector_merge({tableElement:t.tableElement},t.options),e),o.deleteColumns(),o.setColumns(r.getTable().getColumns()),t.setModifierOptions(n).then(()=>(t.emit({type:"afterLoad",detail:e,tables:{table:o},tableElement:t.tableElement}),t))):(t.emit({type:"loadError",detail:e,error:i="HTML table not provided, or element with ID not found",tables:{table:o}}),Promise.reject(new Error(i)))}}HTMLTableConnector.defaultOptions={table:""},Connectors_DataConnector.registerType("HTMLTable",HTMLTableConnector);const Connectors_HTMLTableConnector=null,ChainModifier_merge=external_highcharts_src_js_default_default()["merge"];class ChainModifier extends Modifiers_DataModifier{constructor(e,...n){super(),this.chain=n,this.options=ChainModifier_merge(ChainModifier.defaultOptions,e);var s=this.options.chain||[];for(let e=0,t=s.length,r,o;e<t;++e)(r=s[e]).type&&(o=Modifiers_DataModifier.types[r.type])&&n.push(new o(r))}add(e,t){this.emit({type:"addModifier",detail:t,modifier:e}),this.chain.push(e),this.emit({type:"addModifier",detail:t,modifier:e})}clear(e){this.emit({type:"clearChain",detail:e}),this.chain.length=0,this.emit({type:"afterClearChain",detail:e})}async modify(r,o){const n=this.options.reverse?this.chain.slice().reverse():this.chain.slice();r.modified===r&&(r.modified=r.clone(!1,o));let s=r;for(let e=0,t=n.length;e<t;++e){try{await n[e].modify(s,o)}catch(e){throw this.emit({type:"error",detail:o,table:r}),e}s=s.modified}return r.modified=s,r}modifyCell(e,o,n,s,a){const i=this.options.reverse?this.chain.reverse():this.chain;if(i.length){let r=e.clone();for(let e=0,t=i.length;e<t;++e)i[e].modifyCell(r,o,n,s,a),r=r.modified;e.modified=r}return e}modifyColumns(e,o,n,s){const a=this.options.reverse?this.chain.reverse():this.chain.slice();if(a.length){let r=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyColumns(r,o,n,s),r=r.modified;e.modified=r}return e}modifyRows(e,o,n,s){const a=this.options.reverse?this.chain.reverse():this.chain.slice();if(a.length){let r=e.clone();for(let e=0,t=a.length;e<t;++e)a[e].modifyRows(r,o,n,s),r=r.modified;e.modified=r}return e}modifyTable(e,o){var t=this,n=(t.emit({type:"modify",detail:o,table:e}),t.options.reverse?t.chain.reverse():t.chain.slice());let s=e.modified;for(let e=0,t=n.length,r;e<t;++e)r=n[e],s=r.modifyTable(s,o).modified;return e.modified=s,t.emit({type:"afterModify",detail:o,table:e}),e}remove(e,t){const r=this.chain;this.emit({type:"removeModifier",detail:t,modifier:e}),r.splice(r.indexOf(e),1),this.emit({type:"afterRemoveModifier",detail:t,modifier:e})}}ChainModifier.defaultOptions={type:"Chain"},Modifiers_DataModifier.registerType("Chain",ChainModifier);const Modifiers_ChainModifier=null,InvertModifier_merge=external_highcharts_src_js_default_default()["merge"];class InvertModifier extends Modifiers_DataModifier{constructor(e){super(),this.options=InvertModifier_merge(InvertModifier.defaultOptions,e)}modifyCell(e,t,r,o,n){const s=e.modified,a=s.getRowIndexBy("columnNames",t);return void 0===a?s.setColumns(this.modifyTable(e.clone()).getColumns(),void 0,n):s.setCell(""+r,a,o,n),e}modifyColumns(e,s,a,i){const l=e.modified,r=l.getColumn("columnNames")||[];let u=e.getColumnNames(),o=e.getRowCount()!==r.length;if(!o)for(let e=0,t=u.length;e<t;++e)if(u[e]!==r[e]){o=!0;break}if(o)return this.modifyTable(e,i);for(let e=0,t=(u=Object.keys(s)).length,o,r,n;e<t;++e){o=s[r=u[e]],n=l.getRowIndexBy("columnNames",r)||l.getRowCount();for(let e=0,t=a,r=o.length;e<r;++e,++t)l.setCell(""+t,n,o[e],i)}return e}modifyRows(e,n,s,a){const i=e.getColumnNames(),l=e.modified,r=l.getColumn("columnNames")||[];let o=e.getRowCount()!==r.length;if(!o)for(let e=0,t=i.length;e<t;++e)if(i[e]!==r[e]){o=!0;break}if(o)return this.modifyTable(e,a);for(let e=0,r=s,t=n.length,o;e<t;++e,++r)if((o=n[e])instanceof Array)l.setColumn(""+r,o);else for(let e=0,t=i.length;e<t;++e)l.setCell(""+r,e,o[i[e]],a);return e}modifyTable(o,e){this.emit({type:"modify",detail:e,table:o});const t=o.modified;if(o.hasColumns(["columnNames"])){const r=(o.deleteColumns(["columnNames"])||{}).columnNames||[],n={},s=[];for(let e=0,t=r.length;e<t;++e)s.push(""+r[e]);for(let e=0,t=o.getRowCount(),r;e<t;++e)(r=o.getRow(e))&&(n[s[e]]=r);t.deleteColumns(),t.setColumns(n)}else{const a={};for(let e=0,t=o.getRowCount(),r;e<t;++e)(r=o.getRow(e))&&(a[""+e]=r);a.columnNames=o.getColumnNames(),t.deleteColumns(),t.setColumns(a)}return this.emit({type:"afterModify",detail:e,table:o}),o}}InvertModifier.defaultOptions={type:"Invert"},Modifiers_DataModifier.registerType("Invert",InvertModifier);const Modifiers_InvertModifier=null;class MathModifier extends Modifiers_DataModifier{constructor(e){super(),this.options={...MathModifier.defaultOptions,...e}}modifyTable(n,e){var s=this;s.emit({type:"modify",detail:e,table:n});const a=s.options.alternativeSeparators,o=s.options.formulaColumns||n.getColumnNames(),i=n.modified;for(let e=0,t=o.length,r;e<t;++e)r=o[e],0<=o.indexOf(r)&&i.setColumn(r,s.processColumn(n,r));var l=s.options.columnFormulas||[];for(let e=0,t=l.length,r,o;e<t;++e)r=l[e],o=Formula_FormulaParser.parseFormula(r.formula,a),i.setColumn(r.column,s.processColumnFormula(o,n,r.rowStart,r.rowEnd));return s.emit({type:"afterModify",detail:e,table:n}),n}processColumn(n,e,t=0){const s=this.options.alternativeSeparators,a=(n.getColumn(e,!0)||[]).slice(0<t?t:0);for(let e=0,t=a.length,r=[],o;e<t;++e)if("string"==typeof(o=a[e])&&"="===o[0])try{r=""===o?r:Formula_FormulaParser.parseFormula(o.substring(1),s),a[e]=Formula_FormulaProcessor.processFormula(r,n)}catch{a[e]=NaN}return a}processColumnFormula(r,e,o=0,n=e.getRowCount()){o=0<=o?o:0,n=0<=n?n:e.getRowCount()+n;const s=[],a=e.modified;for(let e=0,t=n-o;e<t;++e)try{s[e]=Formula_FormulaProcessor.processFormula(r,a)}catch{s[e]=NaN}finally{r=Formula_FormulaProcessor.translateReferences(r,0,1)}return s}}MathModifier.defaultOptions={type:"Math",alternativeSeparators:!1},Modifiers_DataModifier.registerType("Math",MathModifier);const Modifiers_MathModifier=null,RangeModifier_merge=external_highcharts_src_js_default_default()["merge"];class RangeModifier extends Modifiers_DataModifier{constructor(e){super(),this.options=RangeModifier_merge(RangeModifier.defaultOptions,e)}modifyTable(u,e){this.emit({type:"modify",detail:e,table:u});let c=[];var{additive:m,ranges:r,strict:d}=this.options;if(r.length){const f=u.modified;let i=u.getColumns(),l=[];for(let e=0,t=r.length,s,a;e<t;++e)if(s=r[e],!d||typeof s.minValue==typeof s.maxValue){0<e&&!m&&(f.deleteRows(),f.setRows(l),f.setOriginalRowIndexes(c,!0),i=f.getColumns(),l=[],c=[]);for(let e=0,t=(a=i[s.column]||[]).length,r,o,n;e<t;++e){switch(typeof(r=a[e])){default:continue;case"boolean":case"number":case"string":}d&&typeof r!=typeof s.minValue||r>=s.minValue&&r<=s.maxValue&&(n=m?(o=u.getRow(e),u.getOriginalRowIndex(e)):(o=f.getRow(e),f.getOriginalRowIndex(e)),o&&(l.push(o),c.push(n)))}}f.deleteRows(),f.setRows(l),f.setOriginalRowIndexes(c)}return this.emit({type:"afterModify",detail:e,table:u}),u}}RangeModifier.defaultOptions={type:"Range",ranges:[]},Modifiers_DataModifier.registerType("Range",RangeModifier);const Modifiers_RangeModifier=null,SortModifier_merge=external_highcharts_src_js_default_default()["merge"];class SortModifier extends Modifiers_DataModifier{static ascending(e,t){return(e||0)<(t||0)?-1:(t||0)<(e||0)?1:0}static descending(e,t){return(t||0)<(e||0)?-1:(e||0)<(t||0)?1:0}constructor(e){super(),this.options=SortModifier_merge(SortModifier.defaultOptions,e)}getRowReferences(e){const r=e.getRows(),o=[];for(let e=0,t=r.length;e<t;++e)o.push({index:e,row:r[e]});return o}modifyCell(e,t,r,o,n){var{orderByColumn:s,orderInColumn:a}=this.options;return t===s&&(a?(e.modified.setCell(t,r,o),e.modified.setColumn(a,this.modifyTable(new Data_DataTable({columns:e.getColumns([s,a])})).modified.getColumn(a))):this.modifyTable(e,n)),e}modifyColumns(e,t,r,o){const{orderByColumn:n,orderInColumn:s}=this.options,a=Object.keys(t);return-1<a.indexOf(n)&&(s&&t[a[0]].length?(e.modified.setColumns(t,r),e.modified.setColumn(s,this.modifyTable(new Data_DataTable({columns:e.getColumns([n,s])})).modified.getColumn(s))):this.modifyTable(e,o)),e}modifyRows(e,t,r,o){var{orderByColumn:n,orderInColumn:s}=this.options;return s&&t.length?(e.modified.setRows(t,r),e.modified.setColumn(s,this.modifyTable(new Data_DataTable({columns:e.getColumns([n,s])})).modified.getColumn(s))):this.modifyTable(e,o),e}modifyTable(e,t){var r;this.emit({type:"modify",detail:t,table:e});const o=e.getColumnNames(),n=e.getRowCount(),s=this.getRowReferences(e),{direction:a,orderByColumn:i,orderInColumn:l}=this.options,u="asc"===a?SortModifier.ascending:SortModifier.descending,c=o.indexOf(i),m=e.modified;if(-1!==c&&s.sort((e,t)=>u(e.row[c],t.row[c])),l){const d=[];for(let e=0;e<n;++e)d[s[e].index]=e;m.setColumns({[l]:d})}else{const f=[],g=[];for(let e=0;e<n;++e)r=s[e],f.push(m.getOriginalRowIndex(r.index)),g.push(r.row);m.setRows(g,0),m.setOriginalRowIndexes(f)}return this.emit({type:"afterModify",detail:t,table:e}),e}}SortModifier.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},Modifiers_DataModifier.registerType("Sort",SortModifier);const Modifiers_SortModifier=null,G=external_highcharts_src_js_default_default(),data_tools_src=(G.DataConnector=G.DataConnector||Connectors_DataConnector,G.DataConverter=G.DataConverter||Converters_DataConverter,G.DataCursor=G.DataCursor||Data_DataCursor,G.DataModifier=G.DataModifier||Modifiers_DataModifier,G.DataPool=G.DataPool||Data_DataPool,G.DataTable=G.DataTable||Data_DataTable,G.Formula=G.Formula||Formula_Formula,external_highcharts_src_js_default_default());export{data_tools_src as default};
import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";import*as __WEBPACK_EXTERNAL_MODULE__sankey_src_js_3bb2850a__ from"./sankey.src.js";var __webpack_require__={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},d:(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject),x=e=>{var t={};return __webpack_require__.d(t,e),t},y=e=>()=>e;const external_sankey_src_js_namespaceObject=x({}),external_highcharts_src_js_default_SeriesRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SeriesRegistry;var NodesComposition,SankeyColumnComposition,external_highcharts_src_js_default_SeriesRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_SeriesRegistry_namespaceObject);const{prototype:seriesProto,prototype:{pointClass:{prototype:pointProto}}}=external_highcharts_src_js_default_SeriesRegistry_default()["series"],{defined,extend,find,merge,pick}=external_highcharts_src_js_default_default(),Series_NodesComposition=(!function(e){function i(){return this.data=[].concat(this.points||[],this.nodes),seriesProto.destroy.apply(this,arguments)}function r(){this.nodes&&(this.nodes.forEach(e=>{e.destroy()}),this.nodes.length=0),seriesProto.setData.apply(this,arguments)}function o(e){const t=arguments,s=this.isNode?this.linksTo.concat(this.linksFrom):[this.fromNode,this.toNode];"select"!==e&&s.forEach(e=>{e&&e.series&&(pointProto.setState.apply(e,t),e.isNode||(e.fromNode.graphic&&pointProto.setState.apply(e.fromNode,t),e.toNode&&e.toNode.graphic&&pointProto.setState.apply(e.toNode,t)))}),pointProto.setState.apply(this,t)}function n(e,t,s,a){const i=this.series.options.nodes,r=this.series.options.data,o=r?.length||0,n=r?.[this.index];pointProto.update.call(this,e,!this.isNode&&t,s,a),this.isNode&&(e=(i||[]).reduce((e,t,s)=>this.id===t.id?s:e,-1),a=merge(i&&i[e]||{},r?.[this.index]||{}),r&&(n?r[this.index]=n:r.length=o),i?0<=e?i[e]=a:i.push(a):this.series.options.nodes=[a],pick(t,!0)&&this.series.chart.redraw(s))}e.compose=function(e,t){const s=e.prototype,a=t.prototype;return s.setNodeState=o,s.setState=o,s.update=n,a.destroy=i,a.setData=r,t},e.createNode=function(e){const t=this.pointClass,s=(e,t)=>find(e,e=>e.id===t);let a=s(this.nodes,e),i;if(!a){i=this.options.nodes&&s(this.options.nodes,e);const r=new t(this,extend({className:"highcharts-node",isNode:!0,id:e,y:1},i));r.linksTo=[],r.linksFrom=[],r.getSum=function(){let t=0,s=0;return r.linksTo.forEach(e=>{t+=e.weight||0}),r.linksFrom.forEach(e=>{s+=e.weight||0}),Math.max(t,s)},r.offset=function(t,s){let a=0;for(let e=0;e<r[s].length;e++){if(r[s][e]===t)return a;a+=r[s][e].weight}},r.hasShape=function(){let t=0;return r.linksTo.forEach(e=>{e.outgoing&&t++}),!r.linksTo.length||t!==r.linksTo.length},r.index=this.nodes.push(r)-1,a=r}return a.formatPrefix="node",a.name=a.name||a.options.id||"",a.mass=pick(a.options.mass,a.options.marker&&a.options.marker.radius,this.options.marker&&this.options.marker.radius,4),a},e.destroy=i,e.generatePoints=function(){const t=this.chart,s={};seriesProto.generatePoints.call(this),this.nodes||(this.nodes=[]),this.colorCounter=0,this.nodes.forEach(e=>{e.linksFrom.length=0,e.linksTo.length=0,e.level=e.options.level}),this.points.forEach(e=>{defined(e.from)&&(s[e.from]||(s[e.from]=this.createNode(e.from)),s[e.from].linksFrom.push(e),e.fromNode=s[e.from],t.styledMode?e.colorIndex=pick(e.options.colorIndex,s[e.from].colorIndex):e.color=e.options.color||s[e.from].color),defined(e.to)&&(s[e.to]||(s[e.to]=this.createNode(e.to)),s[e.to].linksTo.push(e),e.toNode=s[e.to]),e.name=e.name||e.id},this),this.nodeLookup=s},e.setNodeState=o,e.updateNode=n}(NodesComposition=NodesComposition||{}),NodesComposition),{sankey:{prototype:{pointClass:SankeyPoint}}}=external_highcharts_src_js_default_SeriesRegistry_default()["seriesTypes"],ArcDiagramPoint_extend=external_highcharts_src_js_default_default()["extend"];class ArcDiagramPoint extends SankeyPoint{isValid(){return!0}}ArcDiagramPoint_extend(ArcDiagramPoint.prototype,{setState:Series_NodesComposition.setNodeState});const ArcDiagram_ArcDiagramPoint=ArcDiagramPoint,ArcDiagramSeriesDefaults={centeredLinks:!1,equalNodes:!1,dataLabels:{linkTextPath:{attributes:{startOffset:"25%"}}},marker:{fillOpacity:1,lineWidth:0,states:{},symbol:"circle"},offset:"100%",reversed:!1},ArcDiagram_ArcDiagramSeriesDefaults=ArcDiagramSeriesDefaults,{defined:SankeyColumnComposition_defined,getAlignFactor,relativeLength}=external_highcharts_src_js_default_default(),Sankey_SankeyColumnComposition=(!function(e){e.compose=function(e,t){const s=e;return s.sankeyColumn=new a(s,t),s};class a{constructor(e,t){this.points=e,this.series=t}getTranslationFactor(e){const t=this.points,s=t.slice(),a=e.chart,i=e.options.minLinkWidth||0;let r,o=0,n,h=(a.plotSizeY||0)-(e.options.borderWidth||0)-(t.length-1)*e.nodePadding;for(;t.length;){for(o=h/t.sankeyColumn.sum(),r=!1,n=t.length;n--;)t[n].getSum()*o<i&&(t.splice(n,1),h=Math.max(0,h-i),r=!0);if(!r)break}t.length=0;for(const l of s)t.push(l);return o}top(s){const a=this.series,i=a.nodePadding,e=this.points.reduce((e,t)=>{return 0<e&&(e+=i),e+=Math.max(t.getSum()*s,a.options.minLinkWidth||0)},0);return getAlignFactor(a.options.nodeAlignment||"center")*((a.chart.plotSizeY||0)-e)}left(s){const a=this.series,e=a.chart,i=a.options.equalNodes,r=e.inverted?e.plotHeight:e.plotWidth,o=a.nodePadding,t=this.points.reduce((e,t)=>{return 0<e&&(e+=o),e+=i?r/t.series.nodes.length-o:Math.max(t.getSum()*s,a.options.minLinkWidth||0)},0);return((e.plotSizeX||0)-Math.round(t))/2}sum(){return this.points.reduce((e,t)=>e+t.getSum(),0)}offset(t,s){const a=this.points,i=this.series,r=i.nodePadding;let o=0,n;if(i.is("organization")&&t.hangsFrom)return{absoluteTop:t.hangsFrom.nodeY};for(let e=0;e<a.length;e++){var h=a[e].getSum(),l=Math.max(h*s,i.options.minLinkWidth||0),d=t.options[i.chart.inverted?"offsetHorizontal":"offsetVertical"],_=t.options.offset||0;if(n=h?l+r:0,a[e]===t)return{relativeTop:o+(SankeyColumnComposition_defined(d)?relativeLength(d,l):relativeLength(_,n))};o+=n}}}e.SankeyColumnAdditions=a}(SankeyColumnComposition=SankeyColumnComposition||{}),SankeyColumnComposition),external_highcharts_src_js_default_Series_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.Series;var external_highcharts_src_js_default_Series_default=__webpack_require__.n(external_highcharts_src_js_default_Series_namespaceObject);const external_highcharts_src_js_default_SVGRenderer_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SVGRenderer;var external_highcharts_src_js_default_SVGRenderer_default=__webpack_require__.n(external_highcharts_src_js_default_SVGRenderer_namespaceObject);const external_highcharts_src_js_default_SVGElement_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SVGElement;var external_highcharts_src_js_default_SVGElement_default=__webpack_require__.n(external_highcharts_src_js_default_SVGElement_namespaceObject);const deg2rad=external_highcharts_src_js_default_default()["deg2rad"],{addEvent,merge:TextPath_merge,uniqueKey,defined:TextPath_defined,extend:TextPath_extend}=external_highcharts_src_js_default_default();function setTextPath(i,e){e=TextPath_merge(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e);const r=this.renderer.url,o=this.text||this,t=o.textPath,{attributes:n,enabled:h}=e;return i=i||t&&t.path,t&&t.undo(),i&&h?(e=addEvent(o,"afterModifyTree",t=>{if(i&&h){let e=i.attr("id");e||i.attr("id",e=uniqueKey());const a={x:0,y:0};TextPath_defined(n.dx)&&(a.dx=n.dx,delete n.dx),TextPath_defined(n.dy)&&(a.dy=n.dy,delete n.dy),o.attr(a),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());var s=t.nodes.slice(0);t.nodes.length=0,t.nodes[0]={tagName:"textPath",attributes:TextPath_extend(n,{"text-anchor":n.textAnchor,href:r+"#"+e}),children:s}}}),o.textPath={path:i,undo:e}):(o.attr({dx:0,dy:0}),delete o.textPath),this.added&&(o.textCache="",this.renderer.buildText(o)),this}function setPolygon(e){const t=e.bBox,i=this.element?.querySelector("textPath");if(i){const c=[],{b:p,h:s}=this.renderer.fontMetrics(this.element),u=s-p,m=new RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),g=i.innerHTML.replace(m,"").split(/<tspan class="highcharts-br"[^>]*>/),f=g.length;var a=(e,t)=>{var{x:t,y:s}=t,e=(i.getRotationOfChar(e)-90)*deg2rad,a=Math.cos(e),e=Math.sin(e);return[[t-u*a,s-u*e],[t+p*a,s+p*e]]};for(let t=0,s=0;s<f;s++){var r=g[s].length;for(let e=0;e<r;e+=5)try{var o=t+e+s,[n,h]=a(o,i.getStartPositionOfChar(o));0===e?(c.push(h),c.push(n)):(0===s&&c.unshift(h),s===f-1&&c.push(n))}catch(e){break}t+=r-1;try{var l=t+s,[d,_]=a(l,i.getEndPositionOfChar(l));c.unshift(_),c.unshift(d)}catch(e){break}}c.length&&c.push(c[0].slice()),t.polygon=c}return t}function drawTextPath(e){const t=e.labelOptions,s=e.point,a=t[s.formatPrefix+"TextPath"]||t.textPath;a&&!t.useHTML&&(this.setTextPath(s.getDataLabelPath?.(this)||s.graphic,a),s.dataLabelPath&&!a.enabled&&(s.dataLabelPath=s.dataLabelPath.destroy()))}function compose(e){addEvent(e,"afterGetBBox",setPolygon),addEvent(e,"beforeAddingDataLabel",drawTextPath);const t=e.prototype;t.setTextPath||(t.setTextPath=setTextPath)}const TextPath={compose:compose},Extensions_TextPath=TextPath,{symbols}=(Extensions_TextPath.compose(external_highcharts_src_js_default_SVGElement_default()),external_highcharts_src_js_default_SVGRenderer_default())["prototype"],{column:ColumnSeries,sankey:SankeySeries}=external_highcharts_src_js_default_SeriesRegistry_default()["seriesTypes"],{crisp,extend:ArcDiagramSeries_extend,merge:ArcDiagramSeries_merge,pick:ArcDiagramSeries_pick,relativeLength:ArcDiagramSeries_relativeLength}=external_highcharts_src_js_default_default();class ArcDiagramSeries extends SankeySeries{createNodeColumns(){const d=this,c=d.chart,p=Sankey_SankeyColumnComposition.compose([],d);return p.sankeyColumn.maxLength=c.inverted?c.plotHeight:c.plotWidth,p.sankeyColumn.getTranslationFactor=e=>{const t=p.slice(),s=this.options.minLinkWidth||0;let a,i=0,r,o,n=0,h=1,l=0,d=(c.plotSizeX||0)-(e.options.marker&&e.options.marker.lineWidth||0)-(p.length-1)*e.nodePadding;for(;p.length;){for(i=d/p.sankeyColumn.sum(),a=!1,r=p.length;r--;){o=p[r].getSum()*i*h;var _=Math.min(c.plotHeight,c.plotWidth);o>_?h=Math.min(_/o,h):o<s&&(p.splice(r,1),d-=s,o=s,a=!0),l+=o*(1-h)/2,n=Math.max(n,o)}if(!a)break}return p.length=0,t.forEach(e=>{e.scale=h,p.push(e)}),p.sankeyColumn.maxRadius=n,p.sankeyColumn.scale=h,p.sankeyColumn.additionalSpace=l,i},p.sankeyColumn.offset=function(t,s){var a=t.series.options.equalNodes,i=d.nodePadding,r=Math.min(c.plotWidth,c.plotHeight,(p.sankeyColumn.maxLength||0)/d.nodes.length-i);let o=p.sankeyColumn.additionalSpace||0,n;for(let e=0;e<p.length;e++){var h=p[e].getSum()*(p.sankeyColumn.scale||0),l=a?r:Math.max(h*s,d.options.minLinkWidth||0);if(n=h?l+i:0,p[e]===t)return{relativeLeft:o+ArcDiagramSeries_relativeLength(t.options.offset||0,n)};o+=n}},d.nodes.forEach(function(e){e.column=0,p.push(e)}),[p]}translateLink(s){const e=s.fromNode,t=s.toNode,a=this.chart,i=this.translationFactor,r=s.options,o=this.options,n=ArcDiagramSeries_pick(r.linkWeight,o.linkWeight,Math.max((s.weight||0)*i*e.scale,this.options.minLinkWidth||0)),h=s.series.options.centeredLinks,l=e.nodeY;var d=(e,t)=>{t=(e.offset(s,t)||0)*i;return Math.min(e.nodeX+t,e.nodeX+(e.shapeArgs&&e.shapeArgs.height||0)-n)};let _=h?e.nodeX+((e.shapeArgs.height||0)-n)/2:d(e,"linksFrom"),c=h?t.nodeX+((t.shapeArgs.height||0)-n)/2:d(t,"linksTo"),p=l;_>c&&([_,c]=[c,_]),o.reversed&&([_,c]=[c,_],p=(a.plotSizeY||0)-p),s.shapeType="path",s.linkBase=[_,_+n,c,c+n];d=(c+n-_)/Math.abs(c+n-_)*ArcDiagramSeries_pick(o.linkRadius,Math.min(Math.abs(c+n-_)/2,e.nodeY-Math.abs(n)));s.shapeArgs={d:[["M",_,p],["A",(c+n-_)/2,d,0,0,1,c+n,p],["L",c,p],["A",(c-_-n)/2,d-n,0,0,0,_+n,p],["Z"]]},s.dlBox={x:_+(c-_)/2,y:p-d,height:n,width:0},s.tooltipPos=a.inverted?[(a.plotSizeY||0)-s.dlBox.y-n/2,(a.plotSizeX||0)-s.dlBox.x]:[s.dlBox.x,s.dlBox.y+n/2],s.y=s.plotY=1,s.x=s.plotX=1,s.color||(s.color=e.color)}translateNode(t,s){var a=this.translationFactor,i=this.chart,r=i.inverted?i.plotWidth:i.plotHeight,o=this.options,r=Math.min(i.plotWidth,i.plotHeight,r/t.series.nodes.length-this.nodePadding),n=t.getSum()*(s.sankeyColumn.scale||0),r=o.equalNodes?r:Math.max(n*a,this.options.minLinkWidth||0),h=o.marker?.lineWidth||0,l=s.sankeyColumn.offset(t,a),a=crisp(ArcDiagramSeries_pick(l&&l.absoluteLeft,(s.sankeyColumn.left(a)||0)+(l&&l.relativeLeft||0)),h),l=ArcDiagramSeries_merge(o.marker,t.options.marker),d=l.symbol,_=l.radius,l=parseInt(o.offset,10)*((i.inverted?i.plotWidth:i.plotHeight)-(crisp(this.colDistance*(t.column||0)+(l.lineWidth||0)/2,h)+(s.sankeyColumn.scale||0)*(s.sankeyColumn.maxRadius||0)/2))/100;if(t.sum=n){t.nodeX=a,t.nodeY=l;h=a,s=t.options.width||o.width||r,n=t.options.height||o.height||r;let e=l;o.reversed&&(e=(i.plotSizeY||0)-l,i.inverted&&(e=(i.plotSizeY||0)-l)),this.mapOptionsToLevel&&(t.dlOptions=SankeySeries.getDLOptions({level:this.mapOptionsToLevel[t.level],optionsPoint:t.options})),t.plotX=1,t.plotY=1,t.tooltipPos=i.inverted?[(i.plotSizeY||0)-e-n/2,(i.plotSizeX||0)-h-s/2]:[h+s/2,e+n/2],t.shapeType="path",t.shapeArgs={d:symbols[d||"circle"](h,e-(_||n)/2,_||s,_||n),width:_||s,height:_||n},t.dlBox={x:h+s/2,y:e,height:0,width:0}}else t.dlOptions={enabled:!1}}drawDataLabels(){var e;this.options.dataLabels&&(e=this.options.dataLabels.textPath,ColumnSeries.prototype.drawDataLabels.call(this,this.nodes),this.options.dataLabels.textPath=this.options.dataLabels.linkTextPath,ColumnSeries.prototype.drawDataLabels.call(this,this.data),this.options.dataLabels.textPath=e)}pointAttribs(e,t){if(e&&e.isNode){const{...s}=external_highcharts_src_js_default_Series_default().prototype.pointAttribs.apply(this,arguments);return s}return super.pointAttribs.apply(this,arguments)}markerAttribs(e){return e.isNode?super.markerAttribs.apply(this,arguments):{}}}ArcDiagramSeries.defaultOptions=ArcDiagramSeries_merge(SankeySeries.defaultOptions,ArcDiagram_ArcDiagramSeriesDefaults),ArcDiagramSeries_extend(ArcDiagramSeries.prototype,{orderNodes:!1}),ArcDiagramSeries.prototype.pointClass=ArcDiagram_ArcDiagramPoint,external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("arcdiagram",ArcDiagramSeries);const ArcDiagram_ArcDiagramSeries=null,arc_diagram_src=external_highcharts_src_js_default_default();export{arc_diagram_src as default};
import*as t from"../highcharts.js";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var a in i)e.o(i,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:i[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let i=t.default;var o=e.n(i);let a={draw:function(e,t){let{animatableAttribs:i,onComplete:a,css:o,renderer:n}=t,r=e.series&&e.series.chart.hasRendered?void 0:e.series&&e.series.options.animation,l=e.graphic;if(t.attribs={...t.attribs,class:e.getClassName()},e.shouldDraw())l||(e.graphic=l="text"===t.shapeType?n.text():"image"===t.shapeType?n.image(t.imageUrl||"").attr(t.shapeArgs||{}):n[t.shapeType](t.shapeArgs||{}),l.add(t.group)),o&&l.css(o),l.attr(t.attribs).animate(i,!t.isNew&&r,a);else if(l){let t=()=>{e.graphic=l=l&&l.destroy(),"function"==typeof a&&a()};Object.keys(i).length?l.animate(i,void 0,()=>t()):t()}}},n=t.default.SeriesRegistry;var r=e.n(n);let{prototype:{pointClass:l}}=r().seriesTypes["column"],s=o()["extend"];class h extends l{isValid(){return!0}}s(h.prototype,{weight:1});let d=o()["deg2rad"],{extend:p,find:u,isNumber:g,isObject:c,merge:m}=o();function f(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function x(t){let e,o=t.axes||[];return o.length||(o=[],(e=t.concat([t[0]])).reduce((t,e)=>{a=e[0]-t[0];let i=[-(e[1]-t[1]),a];var a;return u(o,t=>t[0]===i[0]&&t[1]===i[1])||o.push(i),e}),t.axes=o),o}function y(t,i){t=t.map(t=>{var e=t[0],t=t[1];return e*i[0]+t*i[1]});return{min:Math.min.apply(this,t),max:Math.max.apply(this,t)}}function b(a,o){let t=x(a),e=x(o);return!u(t.concat(e),t=>{var e=o,i=y(a,t);return!!((e=y(e,t)).min>i.max||e.max<i.min)})}function M(t,e){let i=4*t,a=Math.ceil((Math.sqrt(i)-1)/2),o=2*a+1,n=Math.pow(o,2),r=!1;return--o,t<=1e4&&("boolean"==typeof r&&i>=n-o&&(r={x:a-(n-i),y:-a}),n-=o,"boolean"==typeof r&&i>=n-o&&(r={x:-a,y:-a+(n-i)}),n-=o,(r="boolean"==typeof r?i>=n-o?{x:-a+(n-i),y:a}:{x:a,y:a-(n-i-o)}:r).x*=5,r.y*=5),r}function w(t,e){e=Math.pow(10,g(e)?e:14);return Math.round(t*e)/e}function S(t,e){var i=t[0],t=t[1],e=-d*e,a=Math.cos(e),e=Math.sin(e);return[w(i*a-t*e),w(i*e+t*a)]}function F(t,e,i){t=S([t[0]-e[0],t[1]-e[1]],i);return[t[0]+e[0],t[1]+e[1]]}let P=o()["noop"],A=r().seriesTypes["column"],{extend:X,isArray:T,isNumber:z,isObject:v,merge:Y}=o(),{archimedeanSpiral:B,extendPlayingField:C,getBoundingBoxFromPolygon:W,getPlayingField:N,getPolygon:O,getRandomPosition:D,getRotation:R,getScale:_,getSpiral:E,intersectionTesting:L,isPolygonsColliding:j,rectangularSpiral:H,rotate2DToOrigin:U,rotate2DToPoint:V,squareSpiral:q,updateFieldBoundaries:k}={archimedeanSpiral:function(t,e){let i=e.field,a=i.width*i.width+i.height*i.height,o=.8*t,n=!1;return t<=1e4&&(Math.min(Math.abs((n={x:o*Math.cos(o),y:o*Math.sin(o)}).x),Math.abs(n.y))<a||(n=!1)),n},extendPlayingField:function(t,e){let i,a,o,n,r,l;return l=c(t)&&c(e)?(i=e.bottom-e.top,r=(a=e.right-e.left)*(o=t.ratioX)>i*(n=t.ratioY)?a:i,m(t,{width:t.width+r*o*2,height:t.height+r*n*2})):t},getBoundingBoxFromPolygon:function(t){return t.reduce(function(t,e){var i=e[0],e=e[1];return t.left=Math.min(i,t.left),t.right=Math.max(i,t.right),t.bottom=Math.max(e,t.bottom),t.top=Math.min(e,t.top),t},{left:Number.MAX_VALUE,right:-Number.MAX_VALUE,bottom:-Number.MAX_VALUE,top:Number.MAX_VALUE})},getPlayingField:function(t,e,i){var i=i.reduce(function(t,e){var e=e.dimensions,i=Math.max(e.width,e.height);return t.maxHeight=Math.max(t.maxHeight,e.height),t.maxWidth=Math.max(t.maxWidth,e.width),t.area+=i*i,t},{maxHeight:0,maxWidth:0,area:0}),i=Math.max(i.maxHeight,i.maxWidth,.85*Math.sqrt(i.area)),a=e<t?t/e:1,e=t<e?e/t:1;return{width:i*a,height:i*e,ratioX:a,ratioY:e}},getPolygon:function(t,e,i,a,o){let n=[t,e],r=t-i/2,l=t+i/2,s=e-a/2,h=e+a/2;return[[r,s],[l,s],[l,h],[r,h]].map(function(t){return F(t,n,-o)})},getRandomPosition:function(t){return Math.round(t*(Math.random()+.5)/2)},getRotation:function(t,e,i,a){let o=!1;return o=g(t)&&g(e)&&g(i)&&g(a)&&0<t&&-1<e&&i<a?i+e%t*((a-i)/(t-1||1)):o},getScale:function(t,e,i){var a=2*Math.max(Math.abs(i.top),Math.abs(i.bottom)),i=2*Math.max(Math.abs(i.left),Math.abs(i.right));return Math.min(0<i?1/i*t:1,0<a?1/a*e:1)},getSpiral:function(e,i){let a=[];for(let t=1;t<1e4;t++)a.push(e(t,i));return t=>t<=1e4&&a[t-1]},intersectionTesting:function(t,e){let i=e.placed,n=e.field,a=e.rectangle,o=e.polygon,r=e.spiral,l=t.rect=p({},a),s=1,h={x:0,y:0};for(t.polygon=o,t.rotation=e.rotation;!1!==h&&(function(i,t){function a(t){let e=f(o,t.rect);return e=e&&(i.rotation%90||t.rotation%90)?b(n,t.polygon):e}let o=i.rect,n=i.polygon,e=i.lastCollidedWith,r=!1;return!e||(r=a(e))||delete i.lastCollidedWith,r=r||!!u(t,function(t){var e=a(t);return e&&(i.lastCollidedWith=t),e})}(t,i)||function(t){let e=-n.width/2,i=n.width/2,a=-n.height/2,o=n.height/2;return!(e<t.left&&i>t.right&&a<t.top&&o>t.bottom)}(l));)c(h=r(s))&&(l.left=a.left+h.x,l.right=a.right+h.x,l.top=a.top+h.y,l.bottom=a.bottom+h.y,t.polygon=function(e,i){return o.map(function(t){return[t[0]+e,t[1]+i]})}(h.x,h.y)),s++;return h},isPolygonsColliding:b,rectangularSpiral:function(t,e){let i=M(t,e),a=e.field;return i&&(i.x*=a.ratioX,i.y*=a.ratioY),i},rotate2DToOrigin:S,rotate2DToPoint:F,squareSpiral:M,updateFieldBoundaries:function(t,e){return(!g(t.left)||t.left>e.left)&&(t.left=e.left),(!g(t.right)||t.right<e.right)&&(t.right=e.right),(!g(t.top)||t.top>e.top)&&(t.top=e.top),(!g(t.bottom)||t.bottom<e.bottom)&&(t.bottom=e.bottom),t}};class I extends A{pointAttribs(t,e){let i=o().seriesTypes.column.prototype.pointAttribs.call(this,t,e);return delete i.stroke,delete i["stroke-width"],i}deriveFontSize(t,e,i){t=z(t)?t:0,e=z(e)?e:1;return Math.floor(Math.max(z(i)?i:1,t*e))}drawPoints(){if(!(this.zooming||this.defaultScale&&this.group.scaleX!==this.defaultScale)){let h=this.hasRendered,t=this.xAxis,e=this.yAxis,i=this.chart,d=this.group,p=this.options,g=p.animation,u=p.allowExtendPlayingField,m=i.renderer,c=[],f=this.placementStrategy[p.placementStrategy],x=p.rotation,o=this.points.map(function(t){return t.weight}),y=Math.max.apply(null,o),b=this.points.concat().sort((t,e)=>e.weight-t.weight),n=m.text().add(d),M;for(var r of(this.group.attr({scaleX:1,scaleY:1}),b)){var l=1/y*r.weight,l=X({fontSize:this.deriveFontSize(l,p.maxFontSize,p.minFontSize)+"px"},p.style),l=(n.css(l).attr({x:0,y:0,text:r.name}),n.getBBox(!0));r.dimensions={height:l.height,width:l.width}}M=N(t.len,e.len,b);var w,S=E(this.spirals[p.spiral],{field:M});for(w of b){let t=1/y*w.weight,e=X({fontSize:this.deriveFontSize(t,p.maxFontSize,p.minFontSize)+"px"},p.style),i=f(w,{data:b,field:M,placed:c,rotation:x}),o=X(this.pointAttribs(w,w.selected&&"select"),{align:"center","alignment-baseline":"middle","dominant-baseline":"middle",x:i.x,y:i.y,text:w.name,rotation:z(i.rotation)?i.rotation:void 0}),n=O(i.x,i.y,w.dimensions.width,w.dimensions.height,i.rotation),r=W(n),l=L(w,{rectangle:r,polygon:n,field:M,placed:c,spiral:S,rotation:i.rotation}),s;!l&&u&&(M=C(M,r),l=L(w,{rectangle:r,polygon:n,field:M,placed:c,spiral:S,rotation:i.rotation})),v(l)?(o.x=(o.x||0)+l.x,o.y=(o.y||0)+l.y,r.left+=l.x,r.right+=l.x,r.top+=l.y,r.bottom+=l.y,M=k(M,r),c.push(w),w.isNull=!1,w.isInside=!0):w.isNull=!0,g&&(s={x:o.x,y:o.y},h?(delete o.x,delete o.y):(o.x=0,o.y=0)),a.draw(w,{animatableAttribs:s,attribs:o,css:e,group:d,renderer:m,shapeArgs:void 0,shapeType:"text"})}n=n.destroy(),this.defaultScale=_(t.len,e.len,M),this.field=M,this.group.attr({scaleX:this.defaultScale,scaleY:this.defaultScale})}}hasData(){return v(this)&&!0===this.visible&&T(this.points)&&0<this.points.length}getPlotBox(t){let{chart:e,group:i,zooming:a}=this,{plotSizeX:o=0,plotSizeY:n=0,inverted:r}=e,l=this[r?"yAxis":"xAxis"],s=this[r?"xAxis":"yAxis"],h=l?l.len:e.plotWidth,d=s?s.len:e.plotHeight,p=l?l.left:e.plotLeft,g=s?s.top:e.plotTop,u=this.field,m=0,c=0,f=p+h/2,x=g+d/2,y=f,b=x,M=this.defaultScale||1,w=0,S=0;var v,P,A;return u&&(w=2*Math.max(Math.abs(u.top),Math.abs(u.bottom)),S=2*Math.max(Math.abs(u.left),Math.abs(u.right))),r&&([S,w]=[w,S]),i&&a&&(v=p+Math.max(S*(M=Math.max(a.scale,this.defaultScale||1)),h)/2,P=g+Math.max(w*M,d)/2,A=M-(i.scaleX||1),m=A*((o-S)/2+a.zoomX*o-h/2),c=A*((n-w)/2+a.zoomY*n-d/2),"series"===t&&(a.x=Math.max(0,Math.min(1-a.width,a.x+a.panX/a.scale)),m+=a.panX*o,a.panX=0,a.y=Math.max(0,Math.min(1-a.height,a.y+a.panY/a.scale)),c+=a.panY*n,a.panY=0),z(i.translateX)&&z(i.translateY)&&(y=i.translateX,b=i.translateY),f=y-m,(x=b-c)>P?x=P:x<2*g+d-P&&(x=2*g+d-P),f>v?f=v:f<2*p+h-v&&(f=2*p+h-v)),{translateX:f,translateY:x,scaleX:M,scaleY:M}}}I.defaultOptions=Y(A.defaultOptions,{allowExtendPlayingField:!0,animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,cropThreshold:1/0,minFontSize:1,maxFontSize:25,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"sans-serif",fontWeight:"900",whiteSpace:"nowrap"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.weight}</b><br/>'}}),X(I.prototype,{animate:P,animateDrilldown:P,animateDrillupFrom:P,isCartesian:!1,pointClass:h,setClip:P,placementStrategy:{random:function(t,e){var i=e.field,e=e.rotation;return{x:D(i.width)-i.width/2,y:D(i.height)-i.height/2,rotation:R(e.orientations,t.index,e.from,e.to)}},center:function(t,e){e=e.rotation;return{x:0,y:0,rotation:R(e.orientations,t.index,e.from,e.to)}}},pointArrayMap:["weight"],spirals:{archimedean:B,rectangular:H,square:q},utils:{extendPlayingField:C,getRotation:R,isPolygonsColliding:j,rotate2DToOrigin:U,rotate2DToPoint:V}}),r().registerSeriesType("wordcloud",I);let G=o();export{G as default};
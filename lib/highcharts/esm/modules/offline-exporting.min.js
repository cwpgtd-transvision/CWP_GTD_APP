import*as t from"../highcharts.js";import"./exporting.js";var e,o={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},d:(t,e)=>{for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let a=t.default;var n=o.n(a);let{isSafari:r,win:l,win:{document:i}}=n(),d=n()["error"],s=l.URL||l.webkitURL||l;function c(a){a=a.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(a&&3<a.length&&l.atob&&l.ArrayBuffer&&l.Uint8Array&&l.Blob&&s.createObjectURL){let e=l.atob(a[3]),t=new l.ArrayBuffer(e.length),o=new l.Uint8Array(t);for(let t=0;t<o.length;++t)o[t]=e.charCodeAt(t);return s.createObjectURL(new l.Blob([o],{type:a[1]}))}}let f={dataURLtoBlob:c,downloadURL:function(t,e){let o=l.navigator,a=i.createElement("a");if("string"==typeof t||t instanceof String||!o.msSaveOrOpenBlob){if(t=""+t,1e3<o.userAgent.length)throw Error("Input too long");var n=/Edge\/\d+/.test(o.userAgent);if((r&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||n||2e6<t.length)&&!(t=c(t)||""))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=t,a.download=e,i.body.appendChild(a),a.click(),i.body.removeChild(a);else try{if(!l.open(t,"chart"))throw Error("Failed to open window")}catch{l.location.href=t}}else o.msSaveOrOpenBlob(t,e)},getScript:function(n){return new Promise((t,e)=>{let o=i.getElementsByTagName("head")[0],a=i.createElement("script");a.type="text/javascript",a.src=n,a.onload=()=>{t()},a.onerror=()=>{e(d("Error loading script "+n))},o.appendChild(a)})}},p=t.default.AST;var h=o.n(p);let u=t.default.Chart;var g=o.n(u);let y={exporting:{}},{getOptions:m,setOptions:w}=n(),{downloadURL:b,getScript:v}=f,{composed:F,doc:E,win:x}=n(),{addEvent:S,extend:A,pushUnique:L}=n(),j=(!function(t){async function c(e,t,o,a){e=function(t,e){let o,a,r=E.createElement("div"),n=(h().setElementHTML(r,t),r.getElementsByTagName("text"));return[].forEach.call(n,function(n){for(["fontFamily","fontSize"].forEach(t=>{{var o=n,a=t;let e=o;for(;e&&e!==r;){if(e.style[a]){let t=e.style[a];"fontSize"===a&&/em$/.test(t)&&(t=Math.round(16*parseFloat(t))+"px"),o.style[a]=t;break}e=e.parentNode}return}}),n.style.fontFamily=e?.normal?"HighchartsFont":String(n.style.fontFamily&&n.style.fontFamily.split(" ").splice(-1)),o=n.getElementsByTagName("title"),[].forEach.call(o,function(t){n.removeChild(t)}),a=n.getElementsByClassName("highcharts-text-outline");0<a.length;){let t=a[0];t.parentNode&&t.parentNode.removeChild(t)}}),r.querySelector("svg")}(e,a);if(e){{var l,i=e,d=a;let n,t,r=(t,e)=>{x.jspdf.jsPDF.API.events.push(["initialized",function(){this.addFileToVFS(t,e),this.addFont(t,"HighchartsFont",t),this.getFontList()?.HighchartsFont||this.setFont("HighchartsFont")}])};for(l of(d&&(t=i.textContent||"",!/[^\u0000-\u007F\u200B]+/.test(t))&&(d=void 0),["normal","italic","bold","bolditalic"])){var s=d?.[l];if(s)try{let t=await x.fetch(s);if(!t.ok)throw Error("Failed to fetch font: "+s);let o=await t.blob(),a=new FileReader,e=await new Promise((t,e)=>{a.onloadend=()=>{"string"==typeof a.result?t(a.result.split(",")[1]):e(Error("Failed to read font as base64"))},a.onerror=e,a.readAsDataURL(o)});r(l,e),"normal"===l&&(n=e)}catch(i){}else n&&r(l,n)}}await 0,b(await async function(t,e,o){let a=(Number(t.getAttribute("width"))+2*e)*o,n=(Number(t.getAttribute("height"))+2*e)*o,r=new x.jspdf.jsPDF(a<n?"p":"l","pt",[a,n]),l=([].forEach.call(t.querySelectorAll('*[visibility="hidden"]'),function(t){t.parentNode.removeChild(t)}),t.querySelectorAll("linearGradient"));for(let o=0;o<l.length;o++){let t=l[o].querySelectorAll("stop"),e=0;for(;e<t.length&&"0"===t[e].getAttribute("offset")&&"0"===t[e+1].getAttribute("offset");)t[e].remove(),e++}return[].forEach.call(t.querySelectorAll("tspan"),t=>{"â€‹"===t.textContent&&(t.textContent=" ",t.setAttribute("dx",-5))}),await r.svg(t,{x:0,y:0,width:a,height:n,removeInvalid:!0}),r.output("datauristring")}(e,0,t),o)}}t.compose=function(t){if(S(t,"downloadSVG",async function(t){let{svg:e,exportingOptions:o,exporting:a,preventDefault:r}=t;if("application/pdf"===o?.type){r?.();try{var{type:l,filename:i,scale:d,libURL:s}=n().Exporting.prepareImageOptions(o);"application/pdf"===l&&(x.jspdf?.jsPDF||(await v(s+"jspdf.js"),await v(s+"svg2pdf.js")),await c(e,d,i,o?.pdfFont))}catch(t){await a?.fallbackToServer(o,t)}}}),L(F,"OfflineExporting")){A(g().prototype,{exportChartLocal:async function(t,e){await this.exporting?.exportChart(t,e)}}),w(y);let t=m().exporting?.buttons?.contextButton?.menuItems;t&&t.push("downloadPDF")}},t.downloadSVGLocal=async function(t,e){await n().Exporting.prototype.downloadSVG.call(void 0,t,e)}}(e=e||{}),e),B=(o.d({},{}),n()),U=(B.dataURLtoBlob=B.dataURLtoBlob||f.dataURLtoBlob,B.downloadSVGLocal=j.downloadSVGLocal,B.downloadURL=B.downloadURL||f.downloadURL,j.compose(B.Exporting),n());export{U as default};
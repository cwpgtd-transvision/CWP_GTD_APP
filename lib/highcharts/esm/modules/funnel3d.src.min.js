import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";import*as __WEBPACK_EXTERNAL_MODULE__highcharts_3d_src_js_d1e794f4__ from"../highcharts-3d.src.js";import*as __WEBPACK_EXTERNAL_MODULE__cylinder_src_js_a4a5ba4f__ from"./cylinder.src.js";var __webpack_require__={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},d:(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject);const external_highcharts_src_js_default_Color_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.Color;var external_highcharts_src_js_default_Color_default=__webpack_require__.n(external_highcharts_src_js_default_Color_namespaceObject);const external_highcharts_src_js_default_RendererRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.RendererRegistry;var external_highcharts_src_js_default_RendererRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_RendererRegistry_namespaceObject);const color=external_highcharts_src_js_default_Color_default()["parse"],charts=external_highcharts_src_js_default_default()["charts"],SVGElement3D=external_highcharts_src_js_default_RendererRegistry_default().getRendererType().prototype["Element3D"],merge=external_highcharts_src_js_default_default()["merge"];class SVGElement3DFunnel extends SVGElement3D{constructor(){super(...arguments),this.mainParts=["top","bottom"],this.parts=["top","bottom","frontUpper","backUpper","frontLower","backLower","rightUpper","rightLower"],this.sideGroups=["upperGroup","lowerGroup"],this.sideParts={upperGroup:["frontUpper","backUpper","rightUpper"],lowerGroup:["frontLower","backLower","rightLower"]},this.pathType="funnel3d"}opacitySetter(e){const t=this,r=parseFloat(e),n=t.parts,i=charts[t.renderer.chartIndex],s="group-opacity-"+r+"-"+i.index;if(t.parts=t.mainParts,t.singleSetterForParts("opacity",r),t.parts=n,!i.renderer.filterId){i.renderer.definition({tagName:"filter",attributes:{id:s},children:[{tagName:"feComponentTransfer",children:[{tagName:"feFuncA",attributes:{type:"table",tableValues:"0 "+r}}]}]});for(const o of t.sideGroups)t[o].attr({filter:"url(#"+s+")"});if(t.renderer.styledMode){i.renderer.definition({tagName:"style",textContent:".highcharts-"+s+" {filter:url(#"+s+")}"});for(const a of t.sideGroups)t[a].addClass("highcharts-"+s)}}return t}fillSetter(e){let t=color(e);const r=this,n=t.rgba[3],i={top:color(e).brighten(.1).get(),bottom:color(e).brighten(-.2).get()};if(n<1?(t.rgba[3]=1,t=t.get("rgb"),r.attr({opacity:n})):t=e,(t=t.linearGradient||t.radialGradient||!r.gradientForSides?t:{linearGradient:{x1:0,x2:1,y1:1,y2:1},stops:[[0,color(e).brighten(-.2).get()],[.5,e],[1,color(e).brighten(-.2).get()]]}).linearGradient)for(const c of r.sideGroups){var s=r[c].gradientBox,o=t.linearGradient,a=merge(t,{linearGradient:{x1:s.x+o.x1*s.width,y1:s.y+o.y1*s.height,x2:s.x+o.x2*s.width,y2:s.y+o.y2*s.height}});for(const p of r.sideParts[c])i[p]=a}else if(merge(!0,i,{frontUpper:t,backUpper:t,rightUpper:t,frontLower:t,backLower:t,rightLower:t}),t.radialGradient)for(const u of r.sideGroups){var l=r[u].gradientBox,_=l.x+l.width/2,d=l.y+l.height/2,h=Math.min(l.width,l.height);for(const g of r.sideParts[u])r[g].setRadialReference([_,d,h])}if(r.singleSetterForParts("fill",null,i),r.color=r.fill=e,t.linearGradient)for(const f of[r.frontLower,r.frontUpper]){const x=f.element,m=x&&r.renderer.gradients[x.gradient];m&&"userSpaceOnUse"!==m.attr("gradientUnits")&&m.attr({gradientUnits:"userSpaceOnUse"})}return r}adjustForGradient(){var r,n=this;for(const i of n.sideGroups){let e={x:Number.MAX_VALUE,y:Number.MAX_VALUE},t={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE};for(const s of n.sideParts[i]){const o=n[s];r=o.getBBox(!0),e={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y)},t={x:Math.max(t.x,r.x+r.width),y:Math.max(t.y,r.y+r.height)}}n[i].gradientBox={x:e.x,width:t.x-e.x,y:e.y,height:t.y-e.y}}}zIndexSetter(){return this.finishedOnAdd&&this.adjustForGradient(),this.renderer.Element.prototype.zIndexSetter.apply(this,arguments)}onAdd(){this.adjustForGradient(),this.finishedOnAdd=!0}}const Funnel3D_SVGElement3DFunnel=SVGElement3DFunnel,Funnel3DComposition_charts=external_highcharts_src_js_default_default()["charts"],{error,extend,merge:Funnel3DComposition_merge}=external_highcharts_src_js_default_default();function compose(e){const t=e.prototype;t.funnel3d||(t.Element3D.types.funnel3d=Funnel3D_SVGElement3DFunnel,extend(t,{funnel3d:rendererFunnel3d,funnel3dPath:rendererFunnel3dPath}))}function rendererFunnel3d(e){const t=this,r=t.element3d("funnel3d",e),n=t.styledMode,i={"stroke-width":1,stroke:"none"};r.upperGroup=t.g("funnel3d-upper-group").attr({zIndex:r.frontUpper.zIndex}).add(r);for(const s of[r.frontUpper,r.backUpper,r.rightUpper])n||s.attr(i),s.add(r.upperGroup);r.lowerGroup=t.g("funnel3d-lower-group").attr({zIndex:r.frontLower.zIndex}).add(r);for(const o of[r.frontLower,r.backLower,r.rightLower])n||o.attr(i),o.add(r.lowerGroup);return r.gradientForSides=e.gradientForSides,r}function rendererFunnel3dPath(e){this.getCylinderEnd||error("A required Highcharts module is missing: cylinder.js",!0,Funnel3DComposition_charts[this.chartIndex]);var t=this,r=Funnel3DComposition_charts[t.chartIndex],n=e.alphaCorrection=90-Math.abs(r.options.chart.options3d.alpha%180-90),i=this.cuboidPath.call(t,Funnel3DComposition_merge(e,{depth:e.width,width:(e.width+e.bottom.width)/2})),s=i.isTop,o=!i.isFront,a=!!e.middle,l=t.getCylinderEnd(r,Funnel3DComposition_merge(e,{x:e.x-e.width/2,z:e.z-e.width/2,alphaCorrection:n})),_=e.bottom.width,d=Funnel3DComposition_merge(e,{width:_,x:e.x-_/2,z:e.z-_/2,alphaCorrection:n}),h=t.getCylinderEnd(r,d,!0);let c=_,p=d,u=h,g=h,f;a&&(c=e.middle.width,p=Funnel3DComposition_merge(e,{y:e.y+e.middle.fraction*e.height,width:c,x:e.x-c/2,z:e.z-c/2}),u=t.getCylinderEnd(r,p,!1),g=t.getCylinderEnd(r,p,!1));const x={top:l,bottom:h,frontUpper:t.getCylinderFront(l,u),zIndexes:{group:i.zIndexes.group,top:0!==s?0:3,bottom:1!==s?0:3,frontUpper:o?2:1,backUpper:o?1:2,rightUpper:o?2:1}};return x.backUpper=t.getCylinderBack(l,u),f=Math.min(c,e.width)/Math.max(c,e.width)!=1,x.rightUpper=t.getCylinderFront(t.getCylinderEnd(r,Funnel3DComposition_merge(e,{x:e.x-e.width/2,z:e.z-e.width/2,alphaCorrection:f?-n:0}),!1),t.getCylinderEnd(r,Funnel3DComposition_merge(p,{alphaCorrection:f?-n:0}),!a)),a&&(f=Math.min(c,_)/Math.max(c,_)!=1,Funnel3DComposition_merge(!0,x,{frontLower:t.getCylinderFront(g,h),backLower:t.getCylinderBack(g,h),rightLower:t.getCylinderFront(t.getCylinderEnd(r,Funnel3DComposition_merge(d,{alphaCorrection:f?-n:0}),!0),t.getCylinderEnd(r,Funnel3DComposition_merge(p,{alphaCorrection:f?-n:0}),!1)),zIndexes:{frontLower:o?2:1,backLower:o?1:2,rightLower:o?1:2}})),x}const Funnel3DComposition={compose:compose},Funnel3D_Funnel3DComposition=Funnel3DComposition,Funnel3DSeriesDefaults={center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,gradientForSides:!0,animation:!1,edgeWidth:0,colorByPoint:!0,showInLegend:!1,dataLabels:{align:"right",crop:!1,inside:!1,overflow:"allow"}},Funnel3D_Funnel3DSeriesDefaults=Funnel3DSeriesDefaults,external_highcharts_src_js_default_SeriesRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SeriesRegistry;var external_highcharts_src_js_default_SeriesRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_SeriesRegistry_namespaceObject);const{column:ColumnSeries}=external_highcharts_src_js_default_SeriesRegistry_default()["seriesTypes"],Funnel3DPoint_extend=external_highcharts_src_js_default_default()["extend"];class Funnel3DPoint extends ColumnSeries.prototype.pointClass{}Funnel3DPoint_extend(Funnel3DPoint.prototype,{shapeType:"funnel3d"});const Funnel3D_Funnel3DPoint=Funnel3DPoint,deg2rad=external_highcharts_src_js_default_default()["deg2rad"],pick=external_highcharts_src_js_default_default()["pick"];function rotate3D(e,t,r,n){return{x:n.cosB*e-n.sinB*r,y:-n.sinA*n.sinB*e+n.cosA*t-n.cosB*n.sinA*r,z:n.cosA*n.sinB*e+n.sinA*t+n.cosA*n.cosB*r}}function perspective(e,t,r,n){const i=t.options.chart.options3d,s=pick(n,!!r&&t.inverted),o={x:t.plotWidth/2,y:t.plotHeight/2,z:i.depth/2,vd:pick(i.depth,1)*pick(i.viewDistance,0)},a=t.scale3d||1,l=deg2rad*i.beta*(s?-1:1),_=deg2rad*i.alpha*(s?-1:1),d={cosA:Math.cos(_),cosB:Math.cos(-l),sinA:Math.sin(_),sinB:Math.sin(-l)};return r||(o.x+=t.plotLeft,o.y+=t.plotTop),e.map(function(e){const t=rotate3D((s?e.y:e.x)-o.x,(s?e.x:e.y)-o.y,(e.z||0)-o.z,d),r=perspective3D(t,o,o.vd);return r.x=r.x*a+o.x,r.y=r.y*a+o.y,r.z=t.z*a+o.z,{x:s?r.y:r.x,y:s?r.x:r.y,z:r.z}})}function perspective3D(e,t,r){t=0<r&&r<Number.POSITIVE_INFINITY?r/(e.z+t.z+r):1;return{x:e.x*t,y:e.y*t}}function pointCameraDistance(e,t){const r=t.options.chart.options3d,n=t.plotWidth/2,i=t.plotHeight/2,s=pick(r.depth,1)*pick(r.viewDistance,0)+r.depth,o=Math.sqrt(Math.pow(n-pick(e.plotX,e.x),2)+Math.pow(i-pick(e.plotY,e.y),2)+Math.pow(s-pick(e.plotZ,e.z),2));return o}function shapeArea(e){let t=0,r,n;for(r=0;r<e.length;r++)n=(r+1)%e.length,t+=e[r].x*e[n].y-e[n].x*e[r].y;return t/2}function shapeArea3D(e,t,r){return shapeArea(perspective(e,t,r))}const Math3D={perspective:perspective,perspective3D:perspective3D,pointCameraDistance:pointCameraDistance,shapeArea:shapeArea,shapeArea3D:shapeArea3D},Core_Math3D=Math3D,noop=external_highcharts_src_js_default_default()["noop"],Funnel3DSeries_perspective=Core_Math3D["perspective"],{series:Series,seriesTypes:{column:Funnel3DSeries_ColumnSeries}}=external_highcharts_src_js_default_SeriesRegistry_default(),{extend:Funnel3DSeries_extend,merge:Funnel3DSeries_merge,pick:Funnel3DSeries_pick,relativeLength}=external_highcharts_src_js_default_default();class Funnel3DSeries extends Funnel3DSeries_ColumnSeries{alignDataLabel(e,t,r){const n=this,i=e.dlBoxRaw,s=n.chart.inverted,o=e.plotY>Funnel3DSeries_pick(n.translatedThreshold,n.yAxis.len),a=Funnel3DSeries_pick(r.inside,!!n.options.stacking),l={x:i.x,y:i.y,height:0};r.align=Funnel3DSeries_pick(r.align,!s||a?"center":o?"right":"left"),r.verticalAlign=Funnel3DSeries_pick(r.verticalAlign,s||a?"middle":o?"top":"bottom"),"top"!==r.verticalAlign&&(l.y+=i.bottom/("bottom"===r.verticalAlign?1:2)),l.width=n.getWidthAt(l.y),n.options.reversed&&(l.width=i.fullWidth-l.width),a?l.x-=l.width/2:"left"===r.align?(r.align="right",l.x-=1.5*l.width):"right"===r.align?(r.align="left",l.x+=l.width/2):l.x-=l.width/2,e.dlBox=l,Funnel3DSeries_ColumnSeries.prototype.alignDataLabel.apply(n,arguments)}bindAxes(){Series.prototype.bindAxes.apply(this,arguments),Funnel3DSeries_extend(this.xAxis.options,{gridLineWidth:0,lineWidth:0,title:void 0,tickPositions:[]}),Funnel3DSeries_merge(!0,this.yAxis.options,{gridLineWidth:0,title:void 0,labels:{enabled:!1}})}translate(){Series.prototype.translate.apply(this,arguments);const e=this,t=e.chart,r=e.options,n=r.reversed,i=r.ignoreHiddenPoint,s=t.plotWidth,o=t.plotHeight,a=r.center,l=relativeLength(a[0],s),_=relativeLength(a[1],o),d=relativeLength(r.width,s),h=relativeLength(r.height,o),c=relativeLength(r.neckWidth,s),p=relativeLength(r.neckHeight,o),u=_-h/2+h-p,g=e.points;let f=0,x=0,m,y,D,F,w,b,S,C,j;e.getWidthAt=y=function(e){var t=_-h/2;return e>u||h===p?c:c+(d-c)*(1-(e-t)/(h-p))},e.center=[l,_,h],e.centerX=l;for(const A of g)i&&!1===A.visible||(f+=A.y);for(const v of g)S=null,D=f?v.y/f:0,w=_-h/2+x*h,b=w+D*h,m=y(w),C=b-w,j={gradientForSides:Funnel3DSeries_pick(v.options.gradientForSides,r.gradientForSides),x:l,y:w,height:C,width:m,z:1,top:{width:m}},m=y(b),j.bottom={fraction:D,width:m},w>=u?j.isCylinder=!0:b>u&&(S=b,m=y(u),b=u,j.bottom.width=m,j.middle={fraction:C?(u-w)/C:0,width:m}),n&&(j.y=w=_+h/2-(x+D)*h,j.middle&&(j.middle.fraction=1-(C?j.middle.fraction:0)),m=j.width,j.width=j.bottom.width,j.bottom.width=m),v.shapeArgs=Funnel3DSeries_extend(v.shapeArgs,j),v.percentage=100*D,v.plotX=l,v.plotY=n?_+h/2-(x+D/2)*h:(w+(S||b))/2,F=Funnel3DSeries_perspective([{x:l,y:v.plotY,z:n?-(d-y(v.plotY))/2:-y(v.plotY)/2}],t,!0)[0],v.tooltipPos=[F.x,F.y],v.dlBoxRaw={x:l,width:y(v.plotY),y:w,bottom:j.height||0,fullWidth:d},i&&!1===v.visible||(x+=D)}}Funnel3DSeries.compose=Funnel3D_Funnel3DComposition.compose,Funnel3DSeries.defaultOptions=Funnel3DSeries_merge(Funnel3DSeries_ColumnSeries.defaultOptions,Funnel3D_Funnel3DSeriesDefaults),Funnel3DSeries_extend(Funnel3DSeries.prototype,{pointClass:Funnel3D_Funnel3DPoint,translate3dShapes:noop}),external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("funnel3d",Funnel3DSeries);const Funnel3D_Funnel3DSeries=Funnel3DSeries;var x=e=>{var t={};return __webpack_require__.d(t,e),t},y=e=>()=>e;const external_highcharts_3d_src_js_namespaceObject=x({});var external_cylinder_src_js_x=e=>{var t={};return __webpack_require__.d(t,e),t},external_cylinder_src_js_y=e=>()=>e;const external_cylinder_src_js_namespaceObject=external_cylinder_src_js_x({}),funnel3d_src=(Funnel3D_Funnel3DSeries.compose(external_highcharts_src_js_default_RendererRegistry_default().getRendererType()),external_highcharts_src_js_default_default());export{funnel3d_src as default};
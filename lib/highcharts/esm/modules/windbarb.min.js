import*as t from"../highcharts.js";import*as e from"./datagrouping.js";var o,r={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},d:(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};let i=t.default;var s=r.n(i);let a=e.default.dataGrouping.approximations;var l=r.n(a);let n=t.default.Series.types.column;var p=r.n(n);let h=t.default.Series;var d=r.n(h);let u=s()["composed"],c=p()["prototype"],f=d()["prototype"],{defined:g,pushUnique:b,stableSort:x}=s();var y=o=o||{};function v(t){return f.getPlotBox.call(this.options.onSeries&&this.chart.get(this.options.onSeries)||this,t)}function m(){c.translate.apply(this);let r=this,t=r.options,e=r.chart,i=r.points,o=t.onSeries,s=o&&e.get(o),a=s&&s.options.step,n=s&&s.points,l=e.inverted,p=r.xAxis,h=r.yAxis,d=i.length-1,u,f,b=t.onKey||"y",y=n&&n.length,v=0,m,L,S,k,X;if(s&&s.visible&&y)for(v=(s.pointXOffset||0)+(s.barW||0)/2,k=s.currentDataGrouping,L=n[y-1].x+(k?k.totalRange:0),x(i,(t,e)=>t.x-e.x),b="plot"+b[0].toUpperCase()+b.substr(1);y--&&i[d];)if(m=n[y],(u=i[d]).y=m.y,m.x<=u.x&&void 0!==m[b]){if(u.x<=L&&(u.plotY=m[b],m.x<u.x&&!a&&(S=n[y+1]))&&void 0!==S[b])if(g(u.plotX)&&s.is("spline")){let o=[m.plotX||0,m.plotY||0],r=[S.plotX||0,S.plotY||0],i=m.controlPoints?.high||o,s=S.controlPoints?.low||r,e=(t,e)=>Math.pow(1-t,3)*o[e]+3*(1-t)*(1-t)*t*i[e]+3*(1-t)*t*t*s[e]+t*t*t*r[e],a=0,n=1,l;for(let t=0;t<100;t++){var w=(a+n)/2,O=e(w,0);if(null===O)break;if(Math.abs(O-u.plotX)<.25){l=w;break}O<u.plotX?a=w:n=w}g(l)&&(u.plotY=e(l,1),u.y=h.toValue(u.plotY,!0))}else X=(u.x-m.x)/(S.x-m.x),u.plotY+=X*(S[b]-m[b]),u.y+=X*(S.y-m.y);if(d--,y++,d<0)break}i.forEach((t,e)=>{let o;t.plotX+=v,void 0!==t.plotY&&!l||(0<=t.plotX&&t.plotX<=p.len?l?(t.plotY=p.translate(t.x,0,1,0,1),t.plotX=g(t.y)?h.translate(t.y,0,0,0,1):0):t.plotY=(p.opposite?0:r.yAxis.len)+p.offset:t.shapeArgs={}),(f=i[e-1])&&f.plotX===t.plotX&&(void 0===f.stackIndex&&(f.stackIndex=0),o=f.stackIndex+1),t.stackIndex=o}),this.onSeries=s}y.compose=function(e){if(b(u,"OnSeries")){let t=e.prototype;t.getPlotBox=v,t.translate=m}return e},y.getPlotBox=v,y.translate=m;let L=o,w=t.default.SeriesRegistry;var S=r.n(w);let X=s()["isNumber"];class k extends p().prototype.pointClass{isValid(){return X(this.value)&&0<=this.value}}let M=s()["animObject"],O=S().seriesTypes["column"],{extend:P,merge:A,pick:Y}=s();class G extends O{init(t,e){super.init(t,e)}pointAttribs(t,e){let o=this.options,r=t.color||this.color,i=this.options.lineWidth;return e&&(r=o.states[e].color||r,i=(o.states[e].lineWidth||i)+(o.states[e].lineWidthPlus||0)),{stroke:r,"stroke-width":i}}windArrow(t){let e=t.beaufortLevel,o=this.options.vectorLength/20,r=1.943844*t.value,i,s=-10;if(t.isNull)return[];if(0===e)return this.chart.renderer.symbols.circle(-10*o,-10*o,20*o,20*o);let a=[["M",0,7*o],["L",-1.5*o,7*o],["L",0,10*o],["L",1.5*o,7*o],["L",0,7*o],["L",0,-10*o]];if(0<(i=(r-r%50)/50))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",5*o,s*o+2],["L",0,s*o+4]),r-=50,s+=7;if(0<(i=(r-r%10)/10))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",7*o,s*o]),r-=10,s+=3;if(0<(i=(r-r%5)/5))for(;i--;)a.push(-10===s?["L",0,s*o]:["M",0,s*o],["L",4*o,s*o]),r-=5,s+=3;return a}drawPoints(){let t=this.chart,e=this.yAxis,o=t.inverted,r=this.options.vectorLength/2;for(var i of this.points){var s=i.plotX,a=i.plotY;!1===this.options.clip||t.isInsidePlot(s,0)?(i.graphic||(i.graphic=this.chart.renderer.path().add(this.markerGroup).addClass("highcharts-point highcharts-color-"+Y(i.colorIndex,i.series.colorIndex))),i.graphic.attr({d:this.windArrow(i),translateX:s+this.options.xOffset,translateY:a+this.options.yOffset,rotation:i.direction}),this.chart.styledMode||i.graphic.attr(this.pointAttribs(i))):i.graphic&&(i.graphic=i.graphic.destroy()),i.tooltipPos=[s+this.options.xOffset+(o&&!this.onSeries?r:0),a+this.options.yOffset-(o?0:r+e.pos-t.plotTop)]}}animate(t){t?this.markerGroup.attr({opacity:.01}):this.markerGroup.animate({opacity:1},M(this.options.animation))}markerAttribs(){return{}}getExtremes(){return{}}shouldShowTooltip(t,e,o={}){return o.ignoreX=this.chart.inverted,o.ignoreY=!o.ignoreX,super.shouldShowTooltip(t,e,o)}}G.defaultOptions=A(O.defaultOptions,{dataGrouping:{enabled:!0,approximation:"windbarb",groupPixelWidth:30},lineWidth:2,onSeries:null,states:{hover:{lineWidthPlus:0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> {series.name}: <b>{point.value}</b> ({point.beaufort})<br/>'},vectorLength:20,colorKey:"value",yOffset:-20,xOffset:0}),L.compose(G),P(G.prototype,{beaufortFloor:[0,.3,1.6,3.4,5.5,8,10.8,13.9,17.2,20.8,24.5,28.5,32.7],beaufortName:["Calm","Light air","Light breeze","Gentle breeze","Moderate breeze","Fresh breeze","Strong breeze","Near gale","Gale","Strong gale","Storm","Violent storm","Hurricane"],invertible:!1,parallelArrays:["x","value","direction"],pointArrayMap:["value","direction"],pointClass:k,trackerGroups:["markerGroup"],translate:function(){var e,o=this.beaufortFloor,r=this.beaufortName;for(e of(L.translate.call(this),this.points)){let t=0;for(;t<o.length&&!(o[t]>e.value);t++);e.beaufortLevel=t-1,e.beaufort=r[t-1]}}}),S().registerSeriesType("windbarb",G),l().windbarb||(l().windbarb=(o,r)=>{let i=0,a=0;for(let t=0,e=o.length;t<e;t++)i+=o[t]*Math.cos(r[t]*s().deg2rad),a+=o[t]*Math.sin(r[t]*s().deg2rad);return[o.reduce((t,e)=>t+e,0)/o.length,Math.atan2(a,i)/s().deg2rad]});let I=s();export{I as default};
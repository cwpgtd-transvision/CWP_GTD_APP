import*as __WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__ from"../highcharts.src.js";import*as __WEBPACK_EXTERNAL_MODULE__sankey_src_js_3bb2850a__ from"./sankey.src.js";var __webpack_require__={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},d:(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const external_highcharts_src_js_default_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default;var external_highcharts_src_js_default_default=__webpack_require__.n(external_highcharts_src_js_default_namespaceObject),x=e=>{var t={};return __webpack_require__.d(t,e),t},y=e=>()=>e;const external_sankey_src_js_namespaceObject=x({}),external_highcharts_src_js_default_SeriesRegistry_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SeriesRegistry;var SankeyColumnComposition,external_highcharts_src_js_default_SeriesRegistry_default=__webpack_require__.n(external_highcharts_src_js_default_SeriesRegistry_namespaceObject);const{prototype:{pointClass:SankeyPoint}}=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes["sankey"],{pInt,wrap}=external_highcharts_src_js_default_default();class DependencyWheelPoint extends SankeyPoint{getDataLabelPath(e){const t=this,a=t.series.chart.renderer,n=t.shapeArgs,s=t.angle<0||t.angle>Math.PI,r=n.start||0,i=n.end||0;return t.dataLabelPath?(t.dataLabelPath=t.dataLabelPath.destroy(),delete t.dataLabelPath):wrap(e,"destroy",function(e){return t.dataLabelPath&&(t.dataLabelPath=t.dataLabelPath.destroy()),e.call(this)}),t.dataLabelPath=a.arc({open:!0,longArc:Math.abs(Math.abs(r)-Math.abs(i))<Math.PI?0:1}).attr({x:n.x,y:n.y,r:(n.r||0)+pInt(e.options?.distance||0),start:s?r:i,end:s?i:r,clockwise:+s}).add(a.defs),t.dataLabelPath}isValid(){return!0}}const DependencyWheel_DependencyWheelPoint=DependencyWheelPoint,DependencyWheelSeriesDefaults={center:[null,null],curveFactor:.6,startAngle:0,dataLabels:{textPath:{enabled:!1,attributes:{dy:5}}}},DependencyWheel_DependencyWheelSeriesDefaults=DependencyWheelSeriesDefaults,{defined,getAlignFactor,relativeLength}=external_highcharts_src_js_default_default(),Sankey_SankeyColumnComposition=(!function(e){e.compose=function(e,t){const a=e;return a.sankeyColumn=new n(a,t),a};class n{constructor(e,t){this.points=e,this.series=t}getTranslationFactor(e){const t=this.points,a=t.slice(),n=e.chart,s=e.options.minLinkWidth||0;let r,i=0,o,h=(n.plotSizeY||0)-(e.options.borderWidth||0)-(t.length-1)*e.nodePadding;for(;t.length;){for(i=h/t.sankeyColumn.sum(),r=!1,o=t.length;o--;)t[o].getSum()*i<s&&(t.splice(o,1),h=Math.max(0,h-s),r=!0);if(!r)break}t.length=0;for(const d of a)t.push(d);return i}top(a){const n=this.series,s=n.nodePadding,e=this.points.reduce((e,t)=>{return 0<e&&(e+=s),e+=Math.max(t.getSum()*a,n.options.minLinkWidth||0)},0);return getAlignFactor(n.options.nodeAlignment||"center")*((n.chart.plotSizeY||0)-e)}left(a){const n=this.series,e=n.chart,s=n.options.equalNodes,r=e.inverted?e.plotHeight:e.plotWidth,i=n.nodePadding,t=this.points.reduce((e,t)=>{return 0<e&&(e+=i),e+=s?r/t.series.nodes.length-i:Math.max(t.getSum()*a,n.options.minLinkWidth||0)},0);return((e.plotSizeX||0)-Math.round(t))/2}sum(){return this.points.reduce((e,t)=>e+t.getSum(),0)}offset(t,a){const n=this.points,s=this.series,r=s.nodePadding;let i=0,o;if(s.is("organization")&&t.hangsFrom)return{absoluteTop:t.hangsFrom.nodeY};for(let e=0;e<n.length;e++){var h=n[e].getSum(),d=Math.max(h*a,s.options.minLinkWidth||0),c=t.options[s.chart.inverted?"offsetHorizontal":"offsetVertical"],l=t.options.offset||0;if(o=h?d+r:0,n[e]===t)return{relativeTop:i+(defined(c)?relativeLength(c,d):relativeLength(l,o))};i+=o}}}e.SankeyColumnAdditions=n}(SankeyColumnComposition=SankeyColumnComposition||{}),SankeyColumnComposition),external_highcharts_src_js_default_SVGElement_namespaceObject=__WEBPACK_EXTERNAL_MODULE__highcharts_src_js_8202131d__.default.SVGElement;var external_highcharts_src_js_default_SVGElement_default=__webpack_require__.n(external_highcharts_src_js_default_SVGElement_namespaceObject);const deg2rad=external_highcharts_src_js_default_default()["deg2rad"],{addEvent,merge,uniqueKey,defined:TextPath_defined,extend}=external_highcharts_src_js_default_default();function setTextPath(s,e){e=merge(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e);const r=this.renderer.url,i=this.text||this,t=i.textPath,{attributes:o,enabled:h}=e;return s=s||t&&t.path,t&&t.undo(),s&&h?(e=addEvent(i,"afterModifyTree",t=>{if(s&&h){let e=s.attr("id");e||s.attr("id",e=uniqueKey());const n={x:0,y:0};TextPath_defined(o.dx)&&(n.dx=o.dx,delete o.dx),TextPath_defined(o.dy)&&(n.dy=o.dy,delete o.dy),i.attr(n),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());var a=t.nodes.slice(0);t.nodes.length=0,t.nodes[0]={tagName:"textPath",attributes:extend(o,{"text-anchor":o.textAnchor,href:r+"#"+e}),children:a}}}),i.textPath={path:s,undo:e}):(i.attr({dx:0,dy:0}),delete i.textPath),this.added&&(i.textCache="",this.renderer.buildText(i)),this}function setPolygon(e){const t=e.bBox,s=this.element?.querySelector("textPath");if(s){const _=[],{b:p,h:a}=this.renderer.fontMetrics(this.element),u=a-p,g=new RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),f=s.innerHTML.replace(g,"").split(/<tspan class="highcharts-br"[^>]*>/),y=f.length;var n=(e,t)=>{var{x:t,y:a}=t,e=(s.getRotationOfChar(e)-90)*deg2rad,n=Math.cos(e),e=Math.sin(e);return[[t-u*n,a-u*e],[t+p*n,a+p*e]]};for(let t=0,a=0;a<y;a++){var r=f[a].length;for(let e=0;e<r;e+=5)try{var i=t+e+a,[o,h]=n(i,s.getStartPositionOfChar(i));0===e?(_.push(h),_.push(o)):(0===a&&_.unshift(h),a===y-1&&_.push(o))}catch(e){break}t+=r-1;try{var d=t+a,[c,l]=n(d,s.getEndPositionOfChar(d));_.unshift(l),_.unshift(c)}catch(e){break}}_.length&&_.push(_[0].slice()),t.polygon=_}return t}function drawTextPath(e){const t=e.labelOptions,a=e.point,n=t[a.formatPrefix+"TextPath"]||t.textPath;n&&!t.useHTML&&(this.setTextPath(a.getDataLabelPath?.(this)||a.graphic,n),a.dataLabelPath&&!n.enabled&&(a.dataLabelPath=a.dataLabelPath.destroy()))}function compose(e){addEvent(e,"afterGetBBox",setPolygon),addEvent(e,"beforeAddingDataLabel",drawTextPath);const t=e.prototype;t.setTextPath||(t.setTextPath=setTextPath)}const TextPath={compose:compose},Extensions_TextPath=TextPath,animObject=external_highcharts_src_js_default_default()["animObject"],DependencyWheelSeries_deg2rad=external_highcharts_src_js_default_default()["deg2rad"],{pie:PieSeries,sankey:SankeySeries}=external_highcharts_src_js_default_SeriesRegistry_default().seriesTypes,{extend:DependencyWheelSeries_extend,merge:DependencyWheelSeries_merge,relativeLength:DependencyWheelSeries_relativeLength}=external_highcharts_src_js_default_default();Extensions_TextPath.compose(external_highcharts_src_js_default_SVGElement_default());class DependencyWheelSeries extends SankeySeries{animate(e){var t=this;if(!e){const a=animObject(t.options.animation).duration,n=a/2/t.nodes.length;let e=0;for(const s of t.nodes){const r=s.graphic;r&&(r.attr({opacity:0}),setTimeout(()=>{s.graphic&&s.graphic.animate({opacity:1},{duration:n})},n*e++))}for(const i of t.points){const o=i.graphic;!i.isNode&&o&&o.attr({opacity:0}).animate({opacity:1},t.options.animation)}}}createNode(e){const i=super.createNode(e);return i.getSum=()=>i.linksFrom.concat(i.linksTo).reduce((e,t)=>e+t.weight,0),i.offset=t=>{const a=e=>e.fromNode===i?e.toNode:e.fromNode;let n=0,s=i.linksFrom.concat(i.linksTo),r;s.sort((e,t)=>a(e).index-a(t).index);for(let e=0;e<s.length;e++)if(a(s[e]).index>i.index){s=s.slice(0,e).reverse().concat(s.slice(e).reverse()),r=!0;break}r||s.reverse();for(let e=0;e<s.length;e++){if(s[e]===t)return n;n+=s[e].weight}},i}createNodeColumns(){const e=[Sankey_SankeyColumnComposition.compose([],this)];for(const t of this.nodes)t.column=0,e[0].push(t);return e}getNodePadding(){return this.options.nodePadding/Math.PI}translate(){const i=this.options,o=2*Math.PI/(this.chart.plotHeight+this.getNodePadding()),e=this.getCenter(),h=(i.startAngle-90)*DependencyWheelSeries_deg2rad,t=i.borderRadius,a="object"==typeof t?t.radius:t;super.translate();for(const s of this.nodeColumns[0])if(s.sum){const r=s.shapeArgs,d=e[0],c=e[1],l=e[2]/2,_="auto"===i.nodeWidth?20:i.nodeWidth,p=l-DependencyWheelSeries_relativeLength(_||0,l),u=h+o*(r.y||0),g=h+o*((r.y||0)+(r.height||0));s.angle=u+(g-u)/2,s.shapeType="arc",s.shapeArgs={x:d,y:c,r:l,innerR:p,start:u,end:g,borderRadius:a},s.dlBox={x:d+Math.cos((u+g)/2)*(l+p)/2,y:c+Math.sin((u+g)/2)*(l+p)/2,width:1,height:1};for(const f of s.linksFrom)if(f.linkBase){let s,r;var n=f.linkBase.map((e,t)=>{var e=o*e,a=Math.cos(h+e)*(1+p),n=Math.sin(h+e)*(1+p);return s=i.curveFactor||0,(r=Math.abs(f.linkBase[3-t]*o-e))>Math.PI&&(r=2*Math.PI-r),(r*=p)<p&&(s*=r/p),{x:d+a,y:c+n,cpX:d+(1-s)*a,cpY:c+(1-s)*n}});f.shapeArgs={d:[["M",n[0].x,n[0].y],["A",p,p,0,0,1,n[1].x,n[1].y],["C",n[1].cpX,n[1].cpY,n[2].cpX,n[2].cpY,n[2].x,n[2].y],["A",p,p,0,0,1,n[3].x,n[3].y],["C",n[3].cpX,n[3].cpY,n[0].cpX,n[0].cpY,n[0].x,n[0].y]]}}}}}DependencyWheelSeries.defaultOptions=DependencyWheelSeries_merge(SankeySeries.defaultOptions,DependencyWheel_DependencyWheelSeriesDefaults),DependencyWheelSeries_extend(DependencyWheelSeries.prototype,{orderNodes:!1,getCenter:PieSeries.prototype.getCenter}),DependencyWheelSeries.prototype.pointClass=DependencyWheel_DependencyWheelPoint,external_highcharts_src_js_default_SeriesRegistry_default().registerSeriesType("dependencywheel",DependencyWheelSeries);const DependencyWheel_DependencyWheelSeries=null,dependency_wheel_src=external_highcharts_src_js_default_default();export{dependency_wheel_src as default};